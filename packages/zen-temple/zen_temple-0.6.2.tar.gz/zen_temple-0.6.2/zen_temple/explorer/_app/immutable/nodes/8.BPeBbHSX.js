import"../chunks/CWj6FrbW.js";import{o as Ve}from"../chunks/c6gPyZYp.js";import{p as Ye,s as i,a as X,u as te,b as N,f as M,c as Le,g as e,i as l,d as Me,e as r,t as Oe,n as O,j as qe,r as Ge}from"../chunks/C8SLBV5c.js";import{f as y,a as f}from"../chunks/CkybfRqV.js";import{i as h}from"../chunks/hCS139x6.js";import{F as He,b as ce,S as Je,c as q,e as Ke,t as re,h as Qe,r as We,f as Xe}from"../chunks/DQxlGI9A.js";import{A as ue,T as Ze}from"../chunks/t5k47KUb.js";import{R as xe}from"../chunks/Bog2sjMX.js";import{B as $e}from"../chunks/DHY4M7zv.js";import{D as de}from"../chunks/BS0E_GqS.js";import{g as ae,u as et}from"../chunks/C0O8QyND.js";var tt=y("<!> <!>",1),rt=y("<!> <!> <!>",1),at=y("<!> <!> <!> <!>",1),nt=y("<!> <!>",1),ot=y("<!> <!>",1),lt=y('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),st=y('<div class="text-center">No technologies with this selection.</div>'),it=y('<div class="text-center">No carriers with this selection.</div>'),ct=y('<div class="text-center">No solution selected.</div>'),ut=y('<div class="text-center">No locations with this selection.</div>'),dt=y('<div class="text-center">No data with this selection.</div>'),_t=y('<h1 class="mt-2 mb-4">The Transition Pathway &ndash; Capacity</h1> <!> <div class="mt-4"><!></div>',1);function St(we,Ne){Ye(Ne,!0);let w=i(null);const Se=["capacity","capacity_addition"],Te={capacity:"Capacity",capacity_addition:"Capacity Addition"},ke=["conversion","storage","transport"],_e=["energy","power"],Ie=[{label:"Node",value:"node"},{label:"Technology",value:"technology"}];let G=i(X([])),o=i(null),_=i("capacity"),s=i("conversion"),P=i("energy"),g=i(null),H=i("technology"),Z=i(!1),U=i(X([])),j=i(X([])),L=i(X([])),S=i(!1),C=i(!1),ge=i(X({})),Pe=l(()=>{const t=e(s)=="storage"?e(P):"power";return e(ge)[e(D)[0]+"_"+t]||""}),Ce=l(()=>e(L).map(t=>t.toString())),Fe=l(()=>({responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${Te[e(_)]} [${e(Pe)}]`}}},interaction:{intersect:!1,mode:"nearest",axis:"x"}})),Ae=l(()=>e(o)==null?"":[e(o).solution_name.split(".").pop(),e(o).scenario_name,e(_),e(s),e(g)].join("_")),B=l(()=>{if(e(w)===null||e(o)===null)return[];let t=[];return e(w).data.forEach(a=>{let u=a.technology,T=e(o).detail.reference_carrier[u];!t.includes(T)&&e(ve).includes(a.technology)&&t.push(T)}),t}),ve=l(()=>{if(!e(o)||!e(s))return[];const t={conversion:"set_conversion_technologies",storage:"set_storage_technologies",transport:"set_transport_technologies"}[e(s)];return e(o).detail.system[t]||[]}),D=l(()=>e(o)===null||e(s)===null?[]:e(ve).filter(t=>{var a;return((a=e(o))==null?void 0:a.detail.reference_carrier[t])==e(g)})),J=l(()=>e(w)===null?[]:Ke(e(w).data.filter(t=>e(D).includes(t.technology)).map(t=>t.location)));te(()=>{e(B),Me(()=>{(e(g)==null||!e(B).includes(e(g)))&&r(g,e(B).length>0?e(B)[0]:null,!0)})}),te(()=>{r(j,e(D),!0)}),te(()=>{r(U,e(J),!0)}),Ve(()=>{r(_,ae("variable")||e(_),!0),r(s,ae("technology_type")||e(s),!0),r(P,ae("storage_type")||e(P),!0),r(g,ae("carrier")||e(g),!0)}),te(()=>{e(_),e(s),e(P),e(g),Oe().then(()=>{et({variable:e(_),technology_type:e(s),storage_type:e(P),carrier:e(g)})})});function $(){r(H,"node"),r(Z,!1),r(U,e(J),!0),r(j,e(D),!0),r(L,e(G),!0)}async function Ue(){$(),await fe()}async function je(){$(),await fe()}function pe(){$()}function Be(){$()}async function fe(){var a;if(e(_)===null||e(o)===null){r(w,null);return}r(C,!0),r(w,null);const t=await Qe(e(o).solution_name,e(_),e(o).scenario_name,e(o).detail.system.reference_year,e(o).detail.system.interval_between_years);r(w,t.data,!0),(a=t.unit)!=null&&a.data&&r(ge,Object.fromEntries(t.unit.data.map(u=>[u.technology+"_"+u.capacity_type,u[0]||u.units])),!0),r(C,!1)}let he=l(()=>{if(e(_)==null||e(U).length==0||e(L).length==0||e(j).length==0||e(w)===null)return[];let t={},a={};e(H)=="technology"?(t.location=e(U),a.technology=e(j)):(t.technology=e(j),a.location=e(U)),e(s)=="storage"?a.capacity_type=[e(P)]:a.capacity_type=_e;let u=e(G).filter(T=>!e(L).includes(T));return We(),Xe(e(w).data,t,a,u,e(Z))});var ye=_t(),me=N(M(ye),2);He(me,{children:(t,a)=>{var u=ot(),T=M(u);ce(T,{title:"Solution Selection",children:(R,Q)=>{const m=l(()=>e(C)||e(S));Je(R,{solution_selected:Ue,get disabled(){return e(m)},get selected_solution(){return e(o)},set selected_solution(b){r(o,b,!0)},get loading(){return e(S)},set loading(b){r(S,b,!0)},get years(){return e(G)},set years(b){r(G,b,!0)}})}});var F=N(T,2);{var K=R=>{var Q=nt(),m=M(Q);ce(m,{title:"Variable Selection",children:(z,k)=>{var E=rt(),V=M(E);q(V,{label:"Variable",content:(c,n=O)=>{const d=l(()=>re(Se)),I=l(()=>e(C)||e(S));de(c,{get formId(){return n()},get options(){return e(d)},get disabled(){return e(I)},onUpdate:je,get value(){return e(_)},set value(p){r(_,p,!0)}})}});var Y=N(V,2);{var x=v=>{var c=tt(),n=M(c);q(n,{label:"Technology Type",content:(ee,oe=O)=>{const le=l(()=>re(ke)),se=l(()=>e(C)||e(S));de(ee,{get formId(){return oe()},get options(){return e(le)},get disabled(){return e(se)},onUpdate:pe,get value(){return e(s)},set value(ie){r(s,ie,!0)}})}});var d=N(n,2);{var I=p=>{q(p,{label:"",content:(oe,le=O)=>{const se=l(()=>re(_e)),ie=l(()=>e(C)||e(S));xe(oe,{get formId(){return le()},get options(){return e(se)},onUpdate:pe,get disabled(){return e(ie)},get value(){return e(P)},set value(Ee){r(P,Ee,!0)}})}})};h(d,p=>{e(s)=="storage"&&p(I)})}f(v,c)};h(Y,v=>{e(_)!=null&&v(x)})}var A=N(Y,2);{var W=v=>{q(v,{label:"Carrier",content:(n,d=O)=>{const I=l(()=>re(e(B))),p=l(()=>e(C)||e(S));de(n,{get formId(){return d()},get options(){return e(I)},get disabled(){return e(p)},onUpdate:Be,get value(){return e(g)},set value(ee){r(g,ee,!0)}})}})};h(A,v=>{e(s)!=null&&e(B).length>0&&v(W)})}f(z,E)}});var b=N(m,2);{var ne=z=>{ce(z,{title:"Data Selection",children:(k,E)=>{var V=at(),Y=M(V);q(Y,{label:"Aggregation",content:(d,I=O)=>{xe(d,{get formId(){return I()},get options(){return Ie},get value(){return e(H)},set value(p){r(H,p,!0)}})}});var x=N(Y,2);q(x,{label:"Normalization",content:(d,I=O)=>{Ze(d,{get formId(){return I()},get value(){return e(Z)},set value(p){r(Z,p,!0)}})}});var A=N(x,2);{var W=n=>{ue(n,{label:"Technology",get elements(){return e(D)},get value(){return e(j)},set value(d){r(j,d,!0)}})},v=n=>{ue(n,{label:"Node",get elements(){return e(J)},get value(){return e(U)},set value(d){r(U,d,!0)}})};h(A,n=>{e(H)=="technology"?n(W):n(v,!1)})}var c=N(A,2);ue(c,{label:"Year",get elements(){return e(G)},get value(){return e(L)},set value(n){r(L,n,!0)}}),f(k,V)}})};h(b,z=>{e(w)&&e(s)&&e(g)&&e(D).length>0&&e(J).length>0&&z(ne)})}f(R,Q)};h(F,R=>{!e(S)&&e(o)&&R(K)})}f(t,u)}});var be=N(me,2),De=qe(be);{var Re=t=>{var a=lt();f(t,a)},ze=(t,a)=>{{var u=F=>{var K=st();f(F,K)},T=(F,K)=>{{var R=m=>{var b=it();f(m,b)},Q=(m,b)=>{{var ne=k=>{var E=ct();f(k,E)},z=(k,E)=>{{var V=x=>{var A=ut();f(x,A)},Y=(x,A)=>{{var W=c=>{var n=dt();f(c,n)},v=c=>{$e(c,{type:"bar",get datasets(){return e(he)},get labels(){return e(Ce)},get options(){return e(Fe)},get plot_name(){return e(Ae)}})};h(x,c=>{e(he).length==0?c(W):c(v,!1)},A)}};h(k,x=>{e(J).length==0?x(V):x(Y,!1)},E)}};h(m,k=>{e(o)==null?k(ne):k(z,!1)},b)}};h(F,m=>{e(B).length==0?m(R):m(Q,!1)},K)}};h(t,F=>{e(D).length==0?F(u):F(T,!1)},a)}};h(De,t=>{e(S)||e(C)?t(Re):t(ze,!1)})}Ge(be),f(we,ye),Le()}export{St as component};

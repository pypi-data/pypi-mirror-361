
Crackerjacking[33m...[0m

PDM installed: ✅

[?25l[36m⠋[0m [33m0:00:00[0m [1mResolving dependencies[0m  [2K[36m⠋[0m [33m0:00:00[0m [1mResolve for environment (>=3.13)[0m None[2K[36m⠋[0m [33m0:00:00[0m [1mResolve for environment (>=3.13)[0m None
[?25h[34mINFO:[0m [2mUsing uv is experimental and might break due to uv updates.[0m
[37m⠋[0m [2mResolving dependencies...                                                                                                                                            [0m[2K[37m⠙[0m [2mResolving dependencies...                                                                                                                                            [0m[2K[37m⠋[0m [2mResolving dependencies...                                                                                                                                            [0m[2K[37m⠙[0m [2mResolving dependencies...                                                                                                                                            [0m[2K[37m⠋[0m [2mResolving dependencies...                                                                                                                                            [0m[2K[37m⠙[0m [2mResolving dependencies...                                                                                                                                            [0m[2K[37m⠙[0m [2mstarlette-async-jinja==1.9.13                                                                                                                                        [0m[2K[37m⠙[0m [2mstarlette-async-jinja==1.9.13                                                                                                                                        [0m[2K[37m⠙[0m [2manyio==4.9.0                                                                                                                                                         [0m[2K[37m⠙[0m [2mjinja2==3.1.6                                                                                                                                                        [0m[2K[37m⠙[0m [2mjinja2-async-environment==0.11.8                                                                                                                                     [0m[2K[37m⠙[0m [2mmsgspec==0.19.0                                                                                                                                                      [0m[2K[37m⠙[0m [2mpyyaml==6.0.2                                                                                                                                                        [0m[2K[37m⠙[0m [2mstarlette==0.47.0                                                                                                                                                    [0m[2K[37m⠙[0m [2mcrackerjack==0.20.20                                                                                                                                                 [0m[2K[37m⠙[0m [2midna==3.10                                                                                                                                                           [0m[2K[37m⠙[0m [2msniffio==1.3.1                                                                                                                                                       [0m[2K[37m⠙[0m [2mmarkupsafe==3.0.2                                                                                                                                                    [0m[2K[37m⠙[0m [2mredis==6.2.0                                                                                                                                                         [0m[2K[37m⠙[0m [2mautotyping==24.9.0                                                                                                                                                   [0m[2K[37m⠙[0m [2mkeyring==25.6.0                                                                                                                                                      [0m[2K[37m⠙[0m [2mpdm==2.25.2                                                                                                                                                          [0m[2K[37m⠙[0m [2mpdm-bump==0.9.12                                                                                                                                                     [0m[2K[37m⠙[0m [2mpre-commit==4.2.0                                                                                                                                                    [0m[2K[2mResolved [1m87 packages[0m [2min 51ms[0m[0m
[?25l[2K[36m⠹[0m [33m0:00:00[0m [1mResolve for environment (>=3.13)[0m None[2K[36m⠴[0m [33m0:00:00[0m [1mResolve for environment (>=3.13)[0m None[2K  [33m0:00:00[0m [1m🔒 Lock successful.[0m  [2KChanges are written to [32mpdm.lock[0m.
  [33m0:00:00[0m [1m🔒 Lock successful.[0m  [2K  [33m0:00:00[0m [1m🔒 Lock successful.[0m  
[?25hLock file updated: ✅

Skipping pre-commit hooks


Running tests[33m...[0m

============================= test session starts ==============================
created: [1;36m2[0m/[1;36m2[0m workers
[1;36m2[0m workers [1m[[0m[1;36m41[0m items[1m][0m

scheduling tests via LoadScheduling

tests/test_json_response.py::test_json_response_with_complex_types 
tests/test_e2e.py::test_template_rendering 
 PASSED tests/test_json_response.py::test_json_response_with_complex_types 
tests/test_json_response.py::test_json_response_with_custom_status_and_headers 
 PASSED tests/test_json_response.py::test_json_response_with_custom_status_and_headers 
tests/test_responses.py::test_json_response_render 
 PASSED tests/test_responses.py::test_json_response_render 
tests/test_responses.py::test_template_response_init 
 PASSED tests/test_responses.py::test_template_response_init 
tests/test_responses.py::test_template_response_call_with_debug_extension 
 PASSED tests/test_responses.py::test_template_response_call_with_debug_extension 
tests/test_responses.py::test_async_jinja2_templates_init 
 PASSED tests/test_responses.py::test_async_jinja2_templates_init 
tests/test_responses.py::test_async_jinja2_templates_init_with_options 
 PASSED tests/test_responses.py::test_async_jinja2_templates_init_with_options 
tests/test_responses.py::test_async_jinja2_templates_create_env 
 PASSED tests/test_responses.py::test_async_jinja2_templates_create_env 
tests/test_responses.py::test_async_jinja2_templates_render_block 
 PASSED tests/test_responses.py::test_async_jinja2_templates_render_block 
tests/test_responses.py::test_async_jinja2_templates_generate_render_partial 
 PASSED tests/test_responses.py::test_async_jinja2_templates_generate_render_partial 
tests/test_responses.py::test_async_jinja2_templates_renderer 
 PASSED tests/test_responses.py::test_async_jinja2_templates_renderer 
tests/test_responses.py::test_async_jinja2_templates_render_fragment 
 PASSED tests/test_responses.py::test_async_jinja2_templates_render_fragment 
tests/test_responses.py::test_async_jinja2_templates_render_fragment_with_context 
 PASSED tests/test_responses.py::test_async_jinja2_templates_render_fragment_with_context 
tests/test_responses.py::test_async_jinja2_templates_render_fragment_block_not_found 
 PASSED tests/test_responses.py::test_async_jinja2_templates_render_fragment_block_not_found 
tests/test_responses.py::test_async_jinja2_templates_get_template 
 PASSED tests/test_responses.py::test_async_jinja2_templates_get_template 
tests/test_responses.py::test_async_jinja2_templates_get_template_not_found 
 PASSED tests/test_responses.py::test_async_jinja2_templates_get_template_not_found 
tests/test_responses.py::test_async_jinja2_templates_template_response 
 PASSED tests/test_responses.py::test_async_jinja2_templates_template_response 
tests/test_responses.py::test_async_jinja2_templates_template_response_kwargs 
 PASSED tests/test_responses.py::test_async_jinja2_templates_template_response_kwargs 
tests/test_responses.py::test_async_jinja2_templates_template_response_context_processors 
 PASSED tests/test_responses.py::test_async_jinja2_templates_template_response_context_processors 
tests/test_responses.py::test_async_jinja2_templates_template_response_other_args 
 PASSED tests/test_responses.py::test_async_jinja2_templates_template_response_other_args 
tests/test_responses.py::test_render_template_alias 
 PASSED tests/test_responses.py::test_render_template_alias 
tests/test_responses.py::test_render_block_error_handling 
 PASSED tests/test_responses.py::test_render_block_error_handling 
tests/test_responses.py::test_template_response_with_none_context 
 PASSED tests/test_responses.py::test_template_response_with_none_context 
tests/test_responses.py::test_async_jinja2_templates_renderer_error_handling 
 PASSED tests/test_responses.py::test_async_jinja2_templates_renderer_error_handling 
tests/test_responses.py::test_async_jinja2_templates_render_fragment_exception_handling 
 PASSED tests/test_responses.py::test_async_jinja2_templates_render_fragment_exception_handling 
tests/test_responses.py::test_async_jinja2_templates_template_response_error_handling 
 PASSED tests/test_responses.py::test_async_jinja2_templates_template_response_error_handling 
tests/test_responses.py::test_async_jinja2_templates_render_block_no_markup 
 PASSED tests/test_responses.py::test_async_jinja2_templates_render_block_no_markup 
tests/test_responses.py::test_json_response_render_parametrized 
 PASSED tests/test_responses.py::test_json_response_render_parametrized 
tests/test_responses.py::test_json_response_render_parametrized[1m[[0mdata1-[1m{[0m[32m"nested"[0m:[1m{[0m[32m"key"[0m:[1m[[0m[32m"value1"[0m,[32m"value2"[0m[1m][0m[1m}[0m[1m}[0m[1m][0m 
 PASSED tests/test_responses.py::test_json_response_render_parametrized[1m[[0mdata1-[1m{[0m[32m"nested"[0m:[1m{[0m[32m"key"[0m:[1m[[0m[32m"value1"[0m,[32m"value2"[0m[1m][0m[1m}[0m[1m}[0m[1m][0m 
tests/test_responses.py::test_json_response_render_parametrized[1m[[0mdata2-[1m[[0m[1m][0m[1m][0m 
 PASSED tests/test_responses.py::test_json_response_render_parametrized[1m[[0mdata2-[1m[[0m[1m][0m[1m][0m 
tests/test_responses.py::test_json_response_render_parametrized 
 PASSED tests/test_responses.py::test_json_response_render_parametrized 
tests/test_responses.py::test_json_response_render_parametrized[1m[[0m[3;35mNone[0m-null[1m][0m 
 PASSED tests/test_responses.py::test_json_response_render_parametrized[1m[[0m[3;35mNone[0m-null[1m][0m 
tests/test_responses.py::test_json_response_render_parametrized[1m[[0m[1;36m123[0m-[1;36m123[0m[1m][0m 
 PASSED tests/test_responses.py::test_json_response_render_parametrized[1m[[0m[1;36m123[0m-[1;36m123[0m[1m][0m 
tests/test_responses.py::test_json_response_render_parametrized 
 PASSED tests/test_responses.py::test_json_response_render_parametrized 
tests/test_responses.py::test_json_response_render_parametrized[1m[[0m[3;92mTrue[0m-true[1m][0m 
 PASSED tests/test_responses.py::test_json_response_render_parametrized[1m[[0m[3;92mTrue[0m-true[1m][0m 
tests/test_responses.py::test_async_jinja2_templates_render_fragment_handle_exception 
 PASSED tests/test_responses.py::test_async_jinja2_templates_render_fragment_handle_exception 
 FAILED tests/test_e2e.py::test_template_rendering 

=================================== FAILURES ===================================
___________________________ test_template_rendering ____________________________
 darwin -- Python [1;36m3.13[0m.[1;36m5[0m [35m/Users/les/Projects/starlette-async-jinja/.venv/bin/[0m[95mpython3[0m
starlette_async_jinja/responses.py:[1;36m154[0m: in get_template_async
    template = await [1;35mself.env.get_template_async[0m[1m([0mname[1m)[0m
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/jinja2_async_environment/environment.py:[1;36m108[0m: in get_template_async
    return await [1;35mself._load_template_async[0m[1m([0mname, globals[1m)[0m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/jinja2_async_environment/environment.py:[1;36m174[0m: in _load_template_async
    return await [1;35mself._get_template_async[0m[1m([0mname, globals[1m)[0m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/jinja2_async_environment/environment.py:[1;36m201[0m: in _get_template_async
    template = await [1;35mself.loader.load_async[0m[1m([0mself, name, [1;35mself.make_globals[0m[1m([0mglobals[1m)[0m[1m)[0m
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/jinja2_async_environment/loaders.py:[1;36m76[0m: in load_async
    source, path, uptodate = await [1;35mself.get_source_async[0m[1m([0mname[1m)[0m
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/jinja2_async_environment/loaders.py:[1;36m126[0m: in get_source_async
    raise [1;35mTemplateNotFound[0m[1m([0mtemplate_path.name[1m)[0m
E   jinja2.exceptions.TemplateNotFound: test.html

During handling of the above exception, another exception occurred:
starlette_async_jinja/responses.py:[1;36m192[0m: in TemplateResponse
    template = await [1;35mself.get_template_async[0m[1m([0mname[1m)[0m
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
starlette_async_jinja/responses.py:[1;36m157[0m: in get_template_async
    raise [1;35mRuntimeError[0m[1m([0mf"Error loading template [32m'[0m[32m{[0m[32mname[0m[32m}[0m[32m'[0m"[1m)[0m
E   RuntimeError: Error loading template [32m'test.html'[0m

During handling of the above exception, another exception occurred:
tests/test_e2e.py:[1;36m8[0m: in test_template_rendering
    response = [1;35mclient.get[0m[1m([0m[32m"/"[0m[1m)[0m
               ^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/testclient.py:[1;36m474[0m: in get
    return [1;35msuper[0m[1m([0m[1m)[0m[1;35m.get[0m[1m([0m
.venv/lib/python3.[1;36m13[0m/site-packages/httpx/_client.py:[1;36m1053[0m: in get
    return [1;35mself.request[0m[1m([0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/testclient.py:[1;36m446[0m: in request
    return [1;35msuper[0m[1m([0m[1m)[0m[1;35m.request[0m[1m([0m
.venv/lib/python3.[1;36m13[0m/site-packages/httpx/_client.py:[1;36m825[0m: in request
    return [1;35mself.send[0m[1m([0mrequest, [33mauth[0m=[35mauth[0m, [33mfollow_redirects[0m=[35mfollow_redirects[0m[1m)[0m
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/httpx/_client.py:[1;36m914[0m: in send
    response = [1;35mself._send_handling_auth[0m[1m([0m
.venv/lib/python3.[1;36m13[0m/site-packages/httpx/_client.py:[1;36m942[0m: in _send_handling_auth
    response = [1;35mself._send_handling_redirects[0m[1m([0m
.venv/lib/python3.[1;36m13[0m/site-packages/httpx/_client.py:[1;36m979[0m: in _send_handling_redirects
    response = [1;35mself._send_single_request[0m[1m([0mrequest[1m)[0m
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/httpx/_client.py:[1;36m1014[0m: in _send_single_request
    response = [1;35mtransport.handle_request[0m[1m([0mrequest[1m)[0m
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/testclient.py:[1;36m349[0m: in handle_request
    raise exc
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/testclient.py:[1;36m346[0m: in handle_request
    [1;35mportal.call[0m[1m([0mself.app, scope, receive, send[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/anyio/from_thread.py:[1;36m290[0m: in call
    return [1;35mcast[0m[1m([0mT_Retval, [1;35mself.start_task_soon[0m[1m([0mfunc, *args[1m)[0m[1;35m.result[0m[1m([0m[1m)[0m[1m)[0m
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[35m/usr/local/Cellar/[0m[95mpython[0m@[1;36m3.13[0m/[1;36m3.13[0m.[1;36m5[0m/Frameworks/Python.framework/Versions/[1;36m3.13[0m/lib/python3.[1;36m13[0m/concurrent/futures/_base.py:[1;36m456[0m: in result
    return [1;35mself.__get_result[0m[1m([0m[1m)[0m
           ^^^^^^^^^^^^^^^^^^^
[35m/usr/local/Cellar/[0m[95mpython[0m@[1;36m3.13[0m/[1;36m3.13[0m.[1;36m5[0m/Frameworks/Python.framework/Versions/[1;36m3.13[0m/lib/python3.[1;36m13[0m/concurrent/futures/_base.py:[1;36m401[0m: in __get_result
    raise self._exception
.venv/lib/python3.[1;36m13[0m/site-packages/anyio/from_thread.py:[1;36m221[0m: in _call_func
    retval = await retval_or_awaitable
             ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/applications.py:[1;36m113[0m: in __call__
    await [1;35mself.middleware_stack[0m[1m([0mscope, receive, send[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/middleware/errors.py:[1;36m187[0m: in __call__
    raise exc
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/middleware/errors.py:[1;36m165[0m: in __call__
    await [1;35mself.app[0m[1m([0mscope, receive, _send[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/middleware/exceptions.py:[1;36m63[0m: in __call__
    await [1;35mwrap_app_handling_exceptions[0m[1m([0mself.app, conn[1m)[0m[1m([0mscope, receive, send[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/_exception_handler.py:[1;36m53[0m: in wrapped_app
    raise exc
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/_exception_handler.py:[1;36m42[0m: in wrapped_app
    await [1;35mapp[0m[1m([0mscope, receive, sender[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/routing.py:[1;36m716[0m: in __call__
    await [1;35mself.middleware_stack[0m[1m([0mscope, receive, send[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/routing.py:[1;36m736[0m: in app
    await [1;35mroute.handle[0m[1m([0mscope, receive, send[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/routing.py:[1;36m290[0m: in handle
    await [1;35mself.app[0m[1m([0mscope, receive, send[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/routing.py:[1;36m78[0m: in app
    await [1;35mwrap_app_handling_exceptions[0m[1m([0mapp, request[1m)[0m[1m([0mscope, receive, send[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/_exception_handler.py:[1;36m53[0m: in wrapped_app
    raise exc
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/_exception_handler.py:[1;36m42[0m: in wrapped_app
    await [1;35mapp[0m[1m([0mscope, receive, sender[1m)[0m
.venv/lib/python3.[1;36m13[0m/site-packages/starlette/routing.py:[1;36m75[0m: in app
    response = await [1;35mf[0m[1m([0mrequest[1m)[0m
               ^^^^^^^^^^^^^^^^
tests/conftest.py:[1;36m96[0m: in homepage
    return await [1;35mtemplates.TemplateResponse[0m[1m([0m
starlette_async_jinja/responses.py:[1;36m205[0m: in TemplateResponse
    raise [1;35mRuntimeError[0m[1m([0mf"Error creating template response for [32m'[0m[32m{[0m[32mname[0m[32m}[0m[32m'[0m: [1m{[0me[1m}[0m"[1m)[0m
E   RuntimeError: Error creating template response for [32m'test.html'[0m: Error loading template [32m'test.html'[0m
============================== slowest durations ===============================
[1;36m0.[0m10s call     tests/test_json_response.py::test_json_response_with_complex_types
[1;36m0.[0m09s call     tests/test_e2e.py::test_template_rendering
[1;36m0.[0m01s call     tests/test_json_response.py::test_json_response_with_custom_status_and_headers
[1;36m0.[0m01s setup    tests/test_responses.py::test_render_template_alias
[1;36m0.[0m01s setup    tests/test_e2e.py::test_template_rendering
[1;36m0.[0m01s setup    tests/test_responses.py::test_async_jinja2_templates_template_response_context_processors
[1;36m0.[0m01s setup    tests/test_responses.py::test_template_response_with_none_context
[1;36m0.[0m01s setup    tests/test_responses.py::test_async_jinja2_templates_template_response
[1;36m0.[0m01s setup    tests/test_responses.py::test_async_jinja2_templates_template_response_other_args
[1;36m0.[0m01s setup    tests/test_responses.py::test_async_jinja2_templates_template_response_kwargs

[1m([0m[1;36m101[0m durations < [1;36m0.[0m005s hidden.  Use -vv to show these durations.[1m)[0m
=========================== short test summary info ============================
FAILED tests/test_e2e.py::test_template_rendering - RuntimeError: Error creat[33m...[0m
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after [1;36m1[0m failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!! xdist.dsession.Interrupted: stopping after [1;36m1[0m failures !!!!!!!!!!!!!
========================= [1;36m1[0m failed, [1;36m36[0m passed in [1;36m2.[0m64s =========================

[35m/Users/les/Projects/starlette-async-jinja/.venv/lib/python3.13/site-packages/pytest_benchmark/[0m[95mlogger.py[0m:[1;36m39[0m: PytestBenchmarkWarning: Benchmarks are automatically 
disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.
  [1;35mwarner[0m[1m([0m[1;35mPytestBenchmarkWarning[0m[1m([0mtext[1m)[0m[1m)[0m



❌ Tests failed. Please fix errors.


"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["24708"],{55815:function(t,e,a){a.d(e,{Eu:function(){return s},hZ:function(){return o},o9:function(){return c}});a(24819),a(54480);var n=a(28105),i=a(45657),r=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function s(t){return r[t%r.length]}function o(t,e){var a=e.getPropertyValue("--graph-color-".concat(t+1))||s(t);return(0,i.Rq)(a)}var c=(0,n.Z)(function(t){return r.map(function(e,a){return o(a,t)})},function(t,e){return t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")})},9924:function(t,e,a){a.d(e,{t:function(){return c}});var n=a(61943),i=a(54521),r=a(4490),s=(a(40777),a(87622),a(2394),a(13571),a(81738),a(22960),a(21700),a(87799),a(96389),a(24533),a(54480),a(64510),a(67398),function(){return(0,r.Z)(function t(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.localStorage;(0,i.Z)(this,t),this._storage={},this._listeners={},this.storage=a,this.storage===window.localStorage&&window.addEventListener("storage",function(t){t.key&&e.hasKey(t.key)&&(e._storage[t.key]=t.newValue?JSON.parse(t.newValue):t.newValue,e._listeners[t.key]&&e._listeners[t.key].forEach(function(a){return a(t.oldValue?JSON.parse(t.oldValue):t.oldValue,e._storage[t.key])}))})},[{key:"addFromStorage",value:function(t){if(!this._storage[t]){var e=this.storage.getItem(t);e&&(this._storage[t]=JSON.parse(e))}}},{key:"subscribeChanges",value:function(t,e){var a=this;return this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e],function(){a.unsubscribeChanges(t,e)}}},{key:"unsubscribeChanges",value:function(t,e){if(t in this._listeners){var a=this._listeners[t].indexOf(e);-1!==a&&this._listeners[t].splice(a,1)}}},{key:"hasKey",value:function(t){return t in this._storage}},{key:"getValue",value:function(t){return this._storage[t]}},{key:"setValue",value:function(t,e){var a=this._storage[t];this._storage[t]=e;try{void 0===e?this.storage.removeItem(t):this.storage.setItem(t,JSON.stringify(e))}catch(n){}finally{this._listeners[t]&&this._listeners[t].forEach(function(t){return t(a,e)})}}}])}()),o={};function c(t){return function(e,a){if("object"===(0,n.Z)(a))throw new Error("This decorator does not support this compilation type.");var i,r=t.storage||"localStorage";r&&r in o?i=o[r]:(i=new s(window[r]),o[r]=i);var c=t.key||String(a);i.addFromStorage(c);var u=!1!==t.subscribe?function(t){return i.subscribeChanges(c,function(e,n){t.requestUpdate(a,e)})}:void 0,d=function(){return i.hasKey(c)?t.deserializer?t.deserializer(i.getValue(c)):i.getValue(c):void 0},l=function(e,n){var r;t.state&&(r=d()),i.setValue(c,t.serializer?t.serializer(n):n),t.state&&e.requestUpdate(a,r)},h=e.performUpdate;if(e.performUpdate=function(){this.__initialized=!0,h.call(this)},t.subscribe){var f=e.connectedCallback,p=e.disconnectedCallback;e.connectedCallback=function(){f.call(this);this.__unbsubLocalStorage||(this.__unbsubLocalStorage=null==u?void 0:u(this))},e.disconnectedCallback=function(){var t;p.call(this);var e=this;null===(t=e.__unbsubLocalStorage)||void 0===t||t.call(e),e.__unbsubLocalStorage=void 0}}var _,v=Object.getOwnPropertyDescriptor(e,a);if(void 0===v)_={get:function(){return d()},set:function(t){(this.__initialized||void 0===d())&&l(this,t)},configurable:!0,enumerable:!0};else{var b=v.set;_=Object.assign(Object.assign({},v),{},{get:function(){return d()},set:function(t){(this.__initialized||void 0===d())&&l(this,t),null==b||b.call(this,t)}})}Object.defineProperty(e,a,_)}}},84447:function(t,e,a){a(26847),a(87799),a(27530);var n=a(73742),i=a(27885),r=a(67522),s=a(23533),o=a(7046),c=a(59048),u=a(7616);let d,l,h,f,p=t=>t;class _ extends i.g{renderOutline(){return this.filled?(0,c.dy)(d||(d=p`<span class="filled"></span>`)):super.renderOutline()}getContainerClasses(){return Object.assign(Object.assign({},super.getContainerClasses()),{},{active:this.active})}renderPrimaryContent(){return(0,c.dy)(l||(l=p` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}renderTrailingIcon(){return(0,c.dy)(h||(h=p`<slot name="trailing-icon"></slot>`))}constructor(...t){super(...t),this.filled=!1,this.active=!1}}_.styles=[s.W,o.W,r.W,(0,c.iv)(f||(f=p`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,n.__decorate)([(0,u.Cb)({type:Boolean,reflect:!0})],_.prototype,"filled",void 0),(0,n.__decorate)([(0,u.Cb)({type:Boolean})],_.prototype,"active",void 0),_=(0,n.__decorate)([(0,u.Mo)("ha-assist-chip")],_)},6291:function(t,e,a){a.d(e,{f:function(){return l}});var n=a(75706),i=a(54521),r=a(4490),s=a(20129),o=a(53389),c=a(85297),u=(a(39710),a(26847),a(81738),a(72489),a(54480),a(1455),a(56389),a(27530),a(73742)),d=a(7616),l=function(t){var e=function(t){function e(){return(0,i.Z)(this,e),(0,s.Z)(this,e,arguments)}return(0,c.Z)(e,t),(0,r.Z)(e,[{key:"connectedCallback",value:function(){(0,o.Z)(e,"connectedCallback",this,3)([]),this._checkSubscribed()}},{key:"disconnectedCallback",value:function(){if((0,o.Z)(e,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then(function(t){return t()}):t()}this.__unsubs=void 0}}},{key:"updated",value:function(t){if((0,o.Z)(e,"updated",this,3)([t]),t.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var a,i=(0,n.Z)(t.keys());try{for(i.s();!(a=i.n()).done;){var r=a.value;if(this.hassSubscribeRequiredHostProps.includes(r))return void this._checkSubscribed()}}catch(s){i.e(s)}finally{i.f()}}}},{key:"hassSubscribe",value:function(){return[]}},{key:"_checkSubscribed",value:function(){var t,e=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some(function(t){return void 0===e[t]})||(this.__unsubs=this.hassSubscribe())}}])}(t);return(0,u.__decorate)([(0,d.Cb)({attribute:!1})],e.prototype,"hass",void 0),e}},94412:function(t,e,a){a.d(e,{H:function(){return r}});a(20655);var n=a(45657),i=a(66169);function r(t,e,a,r,s,o){var c=t.getPropertyValue(s+"-"+o).trim(),u=c.length>0?c:t.getPropertyValue(s).trim(),d=(0,n.Rq)(u);return 0===c.length&&o&&(d=(0,n.CO)((0,n.p3)(e?(0,i.C)((0,n.Rw)((0,n.wK)(d)),o):(0,i.W)((0,n.Rw)((0,n.wK)(d)),o)))),r?d+=a?"32":"7F":a&&(d+="7F"),d}},99153:function(t,e,a){a.a(t,async function(t,n){try{a.r(e),a.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return B}});var i,r,s,o=a(75706),c=a(42385),u=a(54982),d=a(54521),l=a(4490),h=a(20129),f=a(85297),p=(a(12212),a(25518),a(70021),a(87622),a(24819),a(2394),a(44438),a(18574),a(81738),a(94814),a(29981),a(22960),a(6989),a(93190),a(96821),a(87799),a(24533),a(54480),a(64455),a(6202),a(67398),a(73742)),_=a(26062),v=a(66386),b=a(59048),g=a(7616),m=a(31733),y=a(28105),k=a(55815),S=a(94412),C=(a(31138),a(37008)),w=a(6640),Z=a(7214),D=a(6291),O=a(93647),x=a(94969),E=a(9924),z=a(28598),V=t([C,z,w,x]);[C,z,w,x]=V.then?(await V)():V;var B=function(t){function e(){var t;(0,d.Z)(this,e);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(t=(0,h.Z)(this,e,[].concat(n)))._chartData=[],t._start=(0,_.I)(),t._end=(0,v.p)(),t._hiddenStats=[],t.hassSubscribeRequiredHostProps=["_config"],t._formatTotal=function(e){return t.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.total_consumed",{num:(0,z.uf)(e,t.hass.locale),unit:"kWh"})},t._createOptions=(0,y.Z)(function(e,a,n,i,r,s,o){var c=(0,x.J)(e,a,n,i,r,s,o,t._formatTotal);return Object.assign(Object.assign({},c),{},{legend:{show:!0,type:"custom",data:t._legendData,selected:t._hiddenStats.reduce(function(t,e){return t[e]=!1,t},{})},grid:{top:15,bottom:0,left:1,right:1,containLabel:!0}})}),t}return(0,f.Z)(e,t),(0,l.Z)(e,[{key:"hassSubscribe",value:function(){var t,e=this;return[(0,w.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe(function(t){e._data=t})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(t){this._config=t}},{key:"shouldUpdate",value:function(t){return(0,O.SN)(this,t)||t.size>1||!t.has("hass")}},{key:"willUpdate",value:function(t){(t.has("_config")||t.has("_data"))&&this._processStatistics()}},{key:"render",value:function(){return this.hass&&this._config?(0,b.dy)(i||(i=(0,u.Z)([" <ha-card> ",' <div class="content ','"> <ha-chart-base .hass="','" .data="','" .options="','" @dataset-hidden="','" @dataset-unhidden="','"></ha-chart-base> </div> </ha-card> '])),this._config.title?(0,b.dy)(r||(r=(0,u.Z)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,m.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,"kWh",this._compareStart,this._compareEnd),this._datasetHidden,this._datasetUnhidden):b.Ld}},{key:"_datasetHidden",value:function(t){this._hiddenStats=[].concat((0,c.Z)(this._hiddenStats),[t.detail.name])}},{key:"_datasetUnhidden",value:function(t){this._hiddenStats=this._hiddenStats.filter(function(e){return e!==t.detail.name})}},{key:"_processStatistics",value:function(){if(this._data){var t=this._data;this._start=t.start,this._end=t.end||(0,v.p)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare;var e=t.stats,a=t.statsCompare,n=getComputedStyle(this),i=t.prefs.device_consumption,r={};i.forEach(function(t){t.included_in_stat&&(r[t.included_in_stat]=r[t.included_in_stat]||[],r[t.included_in_stat].push(t.stat_consumption))});var s={};t.prefs.device_consumption.forEach(function(t){var a=t.stat_consumption in e&&(0,Z.Kj)(e[t.stat_consumption])||0;s[t.stat_consumption]=a});var o={};t.prefs.device_consumption.forEach(function(t){o[t.stat_consumption]=(r[t.stat_consumption]||[]).reduce(function(t,e){return t-s[e]},s[t.stat_consumption])});var u=t.prefs.device_consumption.map(function(t){return t.stat_consumption});u.sort(function(t,e){return o[e]-o[t]});var d=[],l=(0,w.EH)(t),h=l.summedData,f=l.compareSummedData,p="from_grid"in h||"solar"in h||"from_battery"in h,_=p?(0,w.E4)(h,f):{consumption:void 0,compareConsumption:void 0},b=_.consumption,g=_.compareConsumption;if(a){var m=this._processDataSet(n,a,t.statsMetadata,t.prefs.device_consumption,u,r,!0);if(d.push.apply(d,(0,c.Z)(m)),p){var y=this._processUntracked(n,m,g,!0);d.push(y)}}d.push({id:"compare-placeholder",type:"bar",stack:t.statsCompare?"devicesCompare":"devices",data:[]});var k=this._processDataSet(n,e,t.statsMetadata,t.prefs.device_consumption,u,r);if(d.push.apply(d,(0,c.Z)(k)),this._legendData=k.map(function(t){var e;return{name:t.name,itemStyle:{color:t.color,borderColor:null===(e=t.itemStyle)||void 0===e?void 0:e.borderColor}}}),p){var S,C=this._processUntracked(n,k,b,!1);d.push(C),this._legendData.push({name:C.name,itemStyle:{color:C.color,borderColor:null===(S=C.itemStyle)||void 0===S?void 0:S.borderColor}})}(0,x.Zx)(d),this._chartData=d}}},{key:"_processUntracked",value:function(t,e,a,n){var i={};e.forEach(function(t){t.data.forEach(function(t){i[t[n?2:0]]=(i[t[n?2:0]]||0)+t[1]})});var r=(0,x.kT)(this._start,this._compareStart),s=[];Object.keys(a.used_total).sort(function(t,e){return Number(t)-Number(e)}).forEach(function(t){var e=Number(t),o=[e,a.used_total[t]-(i[t]||0)];n&&(o[2]=o[0],o[0]=r(new Date(e)).getTime()),s.push(o)});var o=Date.now();return{type:"bar",cursor:"default",id:n?"compare-untracked-".concat(o):"untracked-".concat(o),name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),itemStyle:{borderColor:(0,S.H)(t,this.hass.themes.darkMode,!1,n,"--history-unknown-color")},barMaxWidth:50,color:(0,S.H)(t,this.hass.themes.darkMode,!0,n,"--history-unknown-color"),data:s,stack:n?"devicesCompare":"devices"}}},{key:"_processDataSet",value:function(t,e,a,n,i,r){var s=this,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=[],d=(0,x.kT)(this._start,this._compareStart);return n.forEach(function(n,l){var h,f=i.indexOf(n.stat_consumption);if(null!==(h=s._config)&&void 0!==h&&h.max_devices&&f>=s._config.max_devices)console.warn("Max devices exceeded for ".concat(n.name," (").concat(f," >= ").concat(s._config.max_devices,")"));else{var p=(0,k.hZ)(l,t),_=null,v=[];if(n.stat_consumption in e){var b,g=e[n.stat_consumption],m=(0,o.Z)(g);try{var y=function(){var t=b.value;if(null===t.change||void 0===t.change||0===t.change)return 0;if(_===t.start)return 0;var a=0;(r[n.stat_consumption]||[]).forEach(function(n){var i,r=e[n];a+=(null==r||null===(i=r.find(function(e){return e.start===t.start}))||void 0===i?void 0:i.change)||0});var i=[t.start,t.change-a];c&&(i[2]=i[0],i[0]=d(new Date(t.start)).getTime()),v.push(i),_=t.start};for(m.s();!(b=m.n()).done;)y()}catch(C){m.e(C)}finally{m.f()}}var S=(n.name||(0,Z.Kd)(s.hass,n.stat_consumption,a[n.stat_consumption]))+(n.stat_consumption in r?" (".concat(s.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked"),")"):"");u.push({type:"bar",cursor:"default",id:c?"compare-".concat(n.stat_consumption,"-").concat(f):"".concat(n.stat_consumption,"-").concat(f),name:S,itemStyle:{borderColor:c?p+"7F":p},barMaxWidth:50,color:c?p+"32":p+"7F",data:v,stack:c?"devicesCompare":"devices"})}}),i.map(function(t){return u.find(function(e){return s._getStatIdFromId(e.id)===t})}).filter(Boolean)}},{key:"_getStatIdFromId",value:function(t){return t.replace(/^compare-/,"").replace(/-\d+$/,"")}}])}((0,D.f)(b.oi));B.styles=(0,b.iv)(s||(s=(0,u.Z)([".card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}"]))),(0,p.__decorate)([(0,g.Cb)({attribute:!1})],B.prototype,"hass",void 0),(0,p.__decorate)([(0,g.SB)()],B.prototype,"_config",void 0),(0,p.__decorate)([(0,g.SB)()],B.prototype,"_chartData",void 0),(0,p.__decorate)([(0,g.SB)()],B.prototype,"_data",void 0),(0,p.__decorate)([(0,g.SB)()],B.prototype,"_legendData",void 0),(0,p.__decorate)([(0,g.SB)()],B.prototype,"_start",void 0),(0,p.__decorate)([(0,g.SB)()],B.prototype,"_end",void 0),(0,p.__decorate)([(0,g.SB)()],B.prototype,"_compareStart",void 0),(0,p.__decorate)([(0,g.SB)()],B.prototype,"_compareEnd",void 0),(0,p.__decorate)([(0,g.SB)(),(0,E.t)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],B.prototype,"_hiddenStats",void 0),B=(0,p.__decorate)([(0,g.Mo)("hui-energy-devices-detail-graph-card")],B),n()}catch(P){n(P)}})},19627:function(t,e,a){a.d(e,{X:function(){return s}});var n=a(40246),i=a(87191),r=a(29426);function s(t,e,a){var s=(0,r._)(t,e)/i.yJ;return(0,n.u)(null==a?void 0:a.roundingMethod)(s)}},66386:function(t,e,a){a.d(e,{p:function(){return i}});var n=a(56858);function i(t){return(0,n.i)(Date.now(),t)}},26062:function(t,e,a){a.d(e,{I:function(){return i}});var n=a(46021);function i(t){return(0,n.b)(Date.now(),t)}}}]);
//# sourceMappingURL=24708.c9939c4fb4606ef1.js.map
(()=>{"use strict";var e,t,n,r={7040:(e,t,n)=>{var r=n(750),a=n(641),o=n(953),i=n(33),l=n(136),u=n(296),c=n(467),s=n(4756),p=n.n(s),f=(n(2696),n(6935)),d=n.n(f),v=n(7659),m=n.n(v);const h=n.p+"5a6cdb62371f4bc880e3e24e76589b1f.css";var b={};b.insert=m().bind(null,"head"),d()(h,b);var _=n(3481),g=n.n(_),y=n(8061),k=n(6902),C=n(5979),F=n(5467),A=n(4365),R=n(7546),w={key:0};const E={__name:"TextWithBr",props:{text:{type:String,required:!0}},setup:function(e){var t=e,n=(0,a.EW)(function(){return t.text.split("\n")});return function(e,t){return(0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.value,function(e,t,r){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.eW)((0,i.v_)(e)+" ",1),r<n.value.length?((0,a.uX)(),(0,a.CE)("br",w)):(0,a.Q3)("v-if",!0)],64)}),256)}}};var L={key:0},x={style:{width:"100%",height:"70vh"},class:"toggle"},S={key:0},O={class:"contacts"},X={key:0},j=["href"],P={key:1},T={key:0},W={key:1},I={class:"contacts"},K={key:0},q=["href"],U={key:1},Q=["href"],B={key:2},M=["href"],N={class:"users"},$={key:0,class:"user_avatar photo"},D=["src","alt"],G={key:1,class:"user_avatar"};const Y={__name:"CompanyMap",props:{companiesUrl:{type:String,required:!0},extraPlacesUrl:{type:String,required:!0}},setup:function(e){return(0,c.A)(p().mark(function t(){var n,r,l,s,f,d,v,m,h,b,_,w,Y,z,H;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v=(0,o.KR)(!0),m=(0,o.KR)({}),h=(0,o.KR)(new(g().Bounds)),b=(0,F.i)(),_=(0,o.KR)(),w=(0,o.KR)(),Y=(0,o.KR)(),z=e,H=function(e){var t=e.getBounds();h.value.isValid()?h.value.extend(t):h.value=t},n=(0,a.E)(function(){return b.loadConst("config")}),r=(0,u.A)(n,2),f=r[0],d=r[1],t.next=1,f;case 1:return f=t.sent,d(),m.value=f,l=(0,a.E)(function(){return Promise.allSettled([A.A.get(z.companiesUrl),A.A.get(z.extraPlacesUrl)]).then(function(e){var t=(0,u.A)(e,2),n=t[0],r=t[1];"fulfilled"==n.status&&n.value&&(_.value=n.value),"fulfilled"==r.status&&r.value&&(w.value=r.value),v.value=!1})}),s=(0,u.A)(l,2),f=s[0],d=s[1],t.next=2,f;case 2:return d(),(0,a.nT)((0,c.A)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,A.A.get(z.companiesUrl);case 1:_.value=e.sent;case 2:case"end":return e.stop()}},e)}))),t.abrupt("return",function(e,t){return(0,a.uX)(),(0,a.CE)(a.FK,null,[v.value?((0,a.uX)(),(0,a.CE)("div",L,"Chargement…")):(0,a.Q3)("v-if",!0),(0,a.Lk)("div",x,[(0,a.bF)((0,o.R1)(y.Do),{ref:"map",center:[47.21297,-1.55104],zoom:18,bounds:h.value},{default:(0,a.k6)(function(){return[(0,a.bF)((0,o.R1)(y.qh),{position:"topright",collapsed:!1}),(0,a.bF)((0,o.R1)(y.a),{url:m.value.leaflet_layer_url,attribution:'© Contributeur·ices <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a>'},null,8,["url"]),(0,a.bF)((0,o.R1)(y.qR),{name:"Lieux ressources",key:"places","layer-type":"overlay",onReady:H},{default:(0,a.k6)(function(){return[w.value?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(w.value.features,function(e){return(0,a.uX)(),(0,a.Wv)((0,o.R1)(y.li),{"lat-lng":(0,o.R1)(g()).GeoJSON.coordsToLatLng(e.geometry.coordinates)},{default:(0,a.k6)(function(){return[(0,a.bF)((0,o.R1)(y.up),null,{default:(0,a.k6)(function(){return[(0,a.bF)(C.A,{name:"location-star","css-class":"map_location favourite",alt:e.properties.name},null,8,["alt"])]}),_:2},1024),(0,a.bF)((0,o.R1)(y.nA),null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",null,[(0,a.Lk)("p",null,[(0,a.Lk)("strong",null,(0,i.v_)(e.properties.name),1)]),e.properties.description?((0,a.uX)(),(0,a.CE)("p",S,[(0,a.bF)(E,{text:e.properties.description},null,8,["text"])])):(0,a.Q3)("v-if",!0),(0,a.Lk)("ul",O,[e.properties.website?((0,a.uX)(),(0,a.CE)("li",X,[(0,a.Lk)("a",{href:e.properties.website},[(0,a.bF)(C.A,{name:"globe",alt:"Site web",title:"Site web"}),(0,a.eW)(" "+(0,i.v_)(e.properties.website),1)],8,j)])):(0,a.Q3)("v-if",!0),e.properties.contact?((0,a.uX)(),(0,a.CE)("li",P,[(0,a.bF)(C.A,{name:"user",alt:""}),(0,a.eW)(" Contact : "+(0,i.v_)(e.properties.contact),1)])):(0,a.Q3)("v-if",!0)])])]}),_:2},1024)]}),_:2},1032,["lat-lng"])}),256)):(0,a.Q3)("v-if",!0)]}),_:1}),(0,a.bF)((0,o.R1)(k._),{name:"Enseignes et entrepreneur·euses",key:"companies","layer-type":"overlay",onReady:H},{default:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_.value.features,function(e){return(0,a.uX)(),(0,a.Wv)((0,o.R1)(y.li),{"lat-lng":(0,o.R1)(g()).GeoJSON.coordsToLatLng(e.geometry.coordinates),onPopupopen:function(t){return Y.value=e.properties.id}},{default:(0,a.k6)(function(){return[(0,a.bF)((0,o.R1)(y.up),null,{default:(0,a.k6)(function(){return[(0,a.bF)(C.A,{name:"location-dot","css-class":"map_location",alt:e.properties.name},null,8,["alt"])]}),_:2},1024),(0,a.bF)((0,o.R1)(y.nA),null,{default:(0,a.k6)(function(){return[(0,a.Lk)("div",null,[(0,a.Lk)("p",null,[(0,a.Lk)("strong",null,(0,i.v_)(e.properties.name),1)]),e.properties.goal?((0,a.uX)(),(0,a.CE)("p",T,[(0,a.Lk)("em",null,(0,i.v_)(e.properties.goal),1)])):(0,a.Q3)("v-if",!0),e.properties.activities_labels.length>0?((0,a.uX)(),(0,a.CE)("p",W,(0,i.v_)(e.properties.activities_labels.join(", ")),1)):(0,a.Q3)("v-if",!0),(0,a.Lk)("ul",I,[e.properties.phone?((0,a.uX)(),(0,a.CE)("li",K,[(0,a.Lk)("a",{href:"tel:".concat(e.properties.phone)},[(0,a.bF)(C.A,{name:"phone",alt:"Téléphone",title:"Téléphone"}),(0,a.eW)(" "+(0,i.v_)(e.properties.phone),1)],8,q)])):(0,a.Q3)("v-if",!0),e.properties.mobile?((0,a.uX)(),(0,a.CE)("li",U,[(0,a.Lk)("a",{href:"tel:".concat(e.properties.mobile)},[(0,a.bF)(C.A,{name:"mobile-alt",title:"Téléphone portable",alt:"Téléphone portable"}),(0,a.eW)(" "+(0,i.v_)(e.properties.mobile),1)],8,Q)])):(0,a.Q3)("v-if",!0),e.properties.email?((0,a.uX)(),(0,a.CE)("li",B,[(0,a.Lk)("a",{href:"mailto:".concat(e.properties.email)},[(0,a.bF)(C.A,{name:"envelope",title:"E-mail",alt:"E-mail"}),(0,a.eW)(" "+(0,i.v_)(e.properties.email),1)],8,M)])):(0,a.Q3)("v-if",!0)]),(0,a.Lk)("ul",N,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.properties.users_gallery,function(t){return(0,a.uX)(),(0,a.CE)("li",null,[(0,a.Q3)("\n                         Renders only if the API gives us a logo\n                         + lazy-loading of logos to avoid mass-loading them on page startup.\n                    "),t.logo_url&&Y.value===e.properties.id?((0,a.uX)(),(0,a.CE)("span",$,[(0,a.Lk)("img",{src:t.logo_url,alt:t.fullname,width:"48",height:"48"},null,8,D)])):((0,a.uX)(),(0,a.CE)("span",G,[(0,a.bF)(R.A,{name:"user"})])),(0,a.Lk)("span",null,(0,i.v_)(t.fullname),1)])}),256))])])]}),_:2},1024)]}),_:2},1032,["lat-lng","onPopupopen"])}),256))]}),_:1})]}),_:1},8,["bounds"])])],64)});case 3:case"end":return t.stop()}},t)}))()}};var z={class:"nav nav-tabs",role:"tablist"},H={class:"tab-content content"},J={id:"list-container",class:"tab-pane fade in active",role:"tabpanel"},V=["href"];const Z={__name:"TabHeader",props:{href:{type:String,default:"#"},active:{type:Boolean,default:!1}},setup:function(e){return function(t,n){return(0,a.uX)(),(0,a.CE)("li",{role:"presentation",class:(0,i.C4)(e.active?"active":"")},[(0,a.Lk)("a",{href:e.href,role:"tab"},[(0,a.RG)(t.$slots,"default")],8,V)],2)}}},ee=(0,a.pM)({components:{IconSpan:C.A,TabHeader:Z,Icon:R.A}}),te=(0,n(6262).A)(ee,[["render",function(e,t,n,r,o,i){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("ul",z,[(0,a.RG)(e.$slots,"headers")]),(0,a.Lk)("div",H,[(0,a.Lk)("div",J,[(0,a.RG)(e.$slots,"panels")])])],64)}]]);var ne=n(5220);const re={__name:"App",setup:function(e){var t=(0,l.Dn)(),n=((0,ne.rd)(),(0,ne.lq)()),r="/api/v1/companies.geojson?"+["id","name","phone","email","mobile","goal","activities_labels","logo_id","users_gallery"].map(function(e){return"fields=".concat(e)}).join("&"),u=(0,o.KR)(r);return(0,a.wB)(function(){return n.query},function(e){var t=new URLSearchParams(e).toString();u.value="".concat(r,"&").concat(t)}),function(e,n){var r=(0,a.g2)("RouterView");return(0,a.uX)(),(0,a.CE)(a.FK,null,[((0,a.uX)(),(0,a.Wv)(a.tY,null,{fallback:(0,a.k6)(function(){return n[0]||(n[0]=[(0,a.eW)("Chargement…")])}),default:(0,a.k6)(function(){return[(0,a.bF)(r,{name:"CompanyURLSearchFilters"},{default:(0,a.k6)(function(e){var t=e.Component;return[((0,a.uX)(),(0,a.Wv)((0,a.$y)(t)))]}),_:1})]}),_:1})),((0,a.uX)(),(0,a.Wv)(a.tY,null,{fallback:(0,a.k6)(function(){return n[2]||(n[2]=[(0,a.eW)(" Chargement...")])}),default:(0,a.k6)(function(){return[(0,a.bF)(te,null,{headers:(0,a.k6)(function(){return[(0,a.bF)(Z,{href:(0,o.R1)(t).tab_url},{default:(0,a.k6)(function(){return[(0,a.bF)(C.A,{name:"list",alt:""}),(0,a.eW)(" "+(0,i.v_)((0,o.R1)(t).tab_title),1)]}),_:1},8,["href"]),(0,a.bF)(Z,{active:""},{default:(0,a.k6)(function(){return[(0,a.bF)(C.A,{name:"map-location-dot",alt:""}),n[1]||(n[1]=(0,a.eW)(" Carte des enseignes "))]}),_:1,__:[1]})]}),panels:(0,a.k6)(function(){return[(0,a.bF)(Y,{companiesUrl:u.value,extraPlacesUrl:"/public/cae_places.geojson"},null,8,["companiesUrl"])]}),_:1})]}),_:1}))],64)}}},ae=re;var oe=n(320),ie=n(4142),le=n(4456),ue={class:"collapsible search_filters expanded"},ce={class:"collapse_title"},se=["id","aria-expanded","title","aria-label"],pe=["id","aria-labelledby","hidden"];const fe={__name:"CollapsibleSearchFilters",props:{title:{required:!0,type:String},initialCollapsedState:{type:Boolean,default:!1},initialFilters:{type:Object,default:{}}},emits:["applyFilters"],setup:function(e,t){var n=t.emit,l=e,u=(0,o.KR)(l.initialCollapsedState),c=(0,r.NF)("accordionPanel"),s=(0,r.NF)("accordionTitle"),p=function(){return u.value=!u.value},f=(0,a.EW)(function(){return u.value?"Afficher les champs de recherche":"Masquer les champs de recherche"}),d=n,v=Object.assign({},l.initialFilters),m=function(e){return v[e.target.name]=e.target.value},h=function(e){e.preventDefault(),d("applyFilters",v)};return(0,a.wB)(function(){return l.initialFilters},function(){return Object.assign(v,l.initialFilters)}),function(t,n){return(0,a.uX)(),(0,a.CE)("div",ue,[(0,a.Lk)("h2",ce,[(0,a.Lk)("a",{href:"#",id:(0,o.R1)(s),"aria-expanded":!u.value,accesskey:"R",title:f.value,"aria-label":f.value,onClick:p},[(0,a.bF)(C.A,{name:"search",alt:""}),(0,a.eW)(" "+(0,i.v_)(e.title)+" ",1),(0,a.bF)(R.A,{class:"arrow",name:"chevron-down"})],8,se)]),(0,a.Lk)("div",{class:"collapse_content",id:(0,o.R1)(c),"aria-labelledby":(0,o.R1)(s),hidden:u.value},[(0,a.Lk)("div",null,[(0,a.Lk)("form",{id:"search_form",class:"form-search form-inline",onChange:m,onSubmit:h},[(0,a.RG)(t.$slots,"default"),(0,a.Lk)("div",null,[(0,a.bF)(le.A,{css:"btn-primary",icon:"search",buttonType:"submit",title:"Lancer la recherche avec ces critères",label:"Lancer la recherche avec ces critères"})])],32)])],8,pe)])}}};var de=n(810),ve=n(3454),me=n(4590),he=n(9596),be=(0,ve.A)("company"),_e=((0,ve.A)("companyList"),["id","goal","name","activities","email","phone","mobile","address","zip_code","city","country","latitude","longitude","logo","logo_id","cgv","header","header_id","decimal_to_display","internal","code_compta","general_customer_account","general_expense_account","third_party_customer_account","general_supplier_account","third_party_supplier_account","internalgeneral_customer_account","internalthird_party_customer_account","internalgeneral_supplier_account","internalthird_party_supplier_account","contribution","internalcontribution","insurance","internalinsurance","RIB","IBAN","antenne_id","follower_id","smtp_configuration","use_margin_rate_in_catalog","margin_rate"]);(0,de.nY)("company",{state:function(){return{loading:!0,error:!1,collection:[],collectionMetaData:{},companyId:null,item:{}}},actions:{setCurrentCompanyId:function(e){this.companyId=e},loadCompanies:function(e){var t=this;return(0,c.A)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,n.abrupt("return",he.A.companies.getCompanies(e).then(function(n){var r;return e.pageOptions&&2==n.length?(t.collectionMetaData=n[0],r=n[1]):r=n,t.loading=!1,t.error="",t.collection=r,r}).catch(t.handleError));case 1:case"end":return n.stop()}},n)}))()},loadCompany:function(){var e=arguments,t=this;return(0,c.A)(p().mark(function n(){var r,a;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(a=e.length>1&&void 0!==e[1]?e[1]:null)&&(a=_e),r=(r=e.length>0&&void 0!==e[0]?e[0]:null)||t.companyId){n.next=1;break}throw Error("no Id provided");case 1:return t.loading=!0,n.abrupt("return",he.A.companies.load(r,a).then(function(e){return t.loading=!1,t.error=!1,t.item=e,e}).catch(t.handleError));case 2:case"end":return n.stop()}},n)}))()},handleError:function(e){var t=this;return(0,c.A)(p().mark(function n(){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!1,t.error=e,n.abrupt("return",Promise.reject(e));case 1:case"end":return n.stop()}},n)}))()},saveCompany:function(e){var t=this;return(0,c.A)(p().mark(function n(){var r;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.companyId||e.id)){n.next=1;break}return n.abrupt("return",he.A.companies.update(e,r));case 1:return n.abrupt("return",t.createCompany(e));case 2:case"end":return n.stop()}},n)}))()},createCompany:function(e){return(0,c.A)(p().mark(function t(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.id){t.next=1;break}throw Error("Company already exists (has an id)");case 1:return t.abrupt("return",he.A.companies.create(e));case 2:case"end":return t.stop()}},t)}))()}},getters:(0,me.Q)("company")});var ge=[{path:"/companies_map",components:{CompanyURLSearchFilters:{__name:"CompanyUrlSearchFilters",setup:function(e){return(0,c.A)(p().mark(function e(){var t,n,r,i,l,c,s,f,d;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,ne.rd)(),c=(0,ne.lq)(),s=be(),f=function(e){l.push({path:"/companies_map",query:e})},s.setUrl("/api/v1/companies.geojson?form_config=1"),t=(0,a.E)(function(){return s.loadConfig()}),n=(0,u.A)(t,2),r=n[0],i=n[1],e.next=1,r;case 1:return i(),d=s.getOptions("activities"),e.abrupt("return",function(e,t){return(0,a.uX)(),(0,a.Wv)(fe,{title:"Recherche",onApplyFilters:f,initialFilters:(0,o.R1)(c).query},{default:(0,a.k6)(function(){return[(0,a.bF)(oe.A,{label:"Nom, enseigne, activité",name:"search",value:(0,o.R1)(c).query.search},null,8,["value"]),(0,a.bF)(ie.A,{label:"Type d'activité",name:"activity_id",options:(0,o.R1)(d),value:(0,o.R1)(c).query.activity_id,"add-default":"","default-option":{id:"",label:"- Tous les types d'activité -"}},null,8,["options","value"]),(0,a.bF)(oe.A,{label:"Code postal",name:"postcode",value:(0,o.R1)(c).query.postcode},null,8,["value"])]}),_:1},8,["initialFilters"])});case 2:case"end":return e.stop()}},e)}))()}}}}];(0,r.Yk)(ae,"vue-app",ge)}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=r,e=[],o.O=(t,n,r,a)=>{if(!n){var i=1/0;for(s=0;s<e.length;s++){for(var[n,r,a]=e[s],l=!0,u=0;u<n.length;u++)(!1&a||i>=a)&&Object.keys(o.O).every(e=>o.O[e](n[u]))?n.splice(u--,1):(l=!1,a<i&&(i=a));if(l){e.splice(s--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[n,r,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var a=Object.create(null);o.r(a);var i={};t=t||[null,n({}),n([]),n(n)];for(var l=2&r&&e;"object"==typeof l&&!~t.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach(t=>i[t]=()=>e[t]);return i.default=()=>e,o.d(a,i),a},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.e=()=>Promise.resolve(),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.j=503,(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={503:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[i,l,u]=n,c=0;if(i.some(t=>0!==e[t])){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(u)var s=u(o)}for(t&&t(n);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(s)},n=self.webpackChunkenDI=self.webpackChunkenDI||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),o.nc=void 0;var i=o.O(void 0,[534],()=>o(7040));i=o.O(i)})();
"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["12697"],{55815:function(t,e,n){n.d(e,{Eu:function(){return o},hZ:function(){return s},o9:function(){return c}});n(24819),n(54480);var i=n(28105),a=n(45657),r=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(t){return r[t%r.length]}function s(t,e){var n=e.getPropertyValue("--graph-color-".concat(t+1))||o(t);return(0,a.Rq)(n)}var c=(0,i.Z)(function(t){return r.map(function(e,n){return s(n,t)})},function(t,e){return t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")})},84447:function(t,e,n){n(26847),n(87799),n(27530);var i=n(73742),a=n(27885),r=n(67522),o=n(23533),s=n(7046),c=n(59048),u=n(7616);let d,l,h,f,v=t=>t;class p extends a.g{renderOutline(){return this.filled?(0,c.dy)(d||(d=v`<span class="filled"></span>`)):super.renderOutline()}getContainerClasses(){return Object.assign(Object.assign({},super.getContainerClasses()),{},{active:this.active})}renderPrimaryContent(){return(0,c.dy)(l||(l=v` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}renderTrailingIcon(){return(0,c.dy)(h||(h=v`<slot name="trailing-icon"></slot>`))}constructor(...t){super(...t),this.filled=!1,this.active=!1}}p.styles=[o.W,s.W,r.W,(0,c.iv)(f||(f=v`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,i.__decorate)([(0,u.Cb)({type:Boolean,reflect:!0})],p.prototype,"filled",void 0),(0,i.__decorate)([(0,u.Cb)({type:Boolean})],p.prototype,"active",void 0),p=(0,i.__decorate)([(0,u.Mo)("ha-assist-chip")],p)},7214:function(t,e,n){n.d(e,{Cj:function(){return f},F7:function(){return r},Hs:function(){return C},Kd:function(){return x},Kj:function(){return p},Nw:function(){return g},PA:function(){return o},Py:function(){return u},Qm:function(){return Z},Z0:function(){return b},_Y:function(){return l},_m:function(){return s},dL:function(){return d},dO:function(){return k},hN:function(){return v},h_:function(){return h},j2:function(){return S},q6:function(){return _},uR:function(){return c}});var i=n(75706),a=(n(39710),n(81738),n(72489),n(54480),n(56389),n(15459)),r=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({}),o=99387==n.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,s=function(t){return t.sendMessagePromise({type:"recorder/info"})},c=function(t,e){return t.callWS({type:"recorder/list_statistic_ids",statistic_type:e})},u=function(t,e){return t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e})},d=function(t,e,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"hour",r=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==n?void 0:n.toISOString(),statistic_ids:i,period:a,units:r,types:o})},l=function(t,e,n,i){return t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:i,fixed_period:n.fixed_period?{start_time:n.fixed_period.start instanceof Date?n.fixed_period.start.toISOString():n.fixed_period.start,end_time:n.fixed_period.end instanceof Date?n.fixed_period.end.toISOString():n.fixed_period.end}:void 0,calendar:n.calendar,rolling_window:n.rolling_window})},h=function(t){return t.callWS({type:"recorder/validate_statistics"})},f=function(t,e,n){return t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:n})},v=function(t,e){return t.callWS({type:"recorder/clear_statistics",statistic_ids:e})},p=function(t){var e=null;if(!t)return null;var n,a=(0,i.Z)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;null!==r.change&&void 0!==r.change&&(null===e?e=r.change:e+=r.change)}}catch(o){a.e(o)}finally{a.f()}return e},_=function(t,e){var n,a=null,r=(0,i.Z)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o in t){var s=p(t[o]);null!==s&&(null===a?a=s:a+=s)}}}catch(c){r.e(c)}finally{r.f()}return a},g=function(t,e){return t.some(function(t){return void 0!==t[e]&&null!==t[e]})},m=["mean","min","max"],y=["sum","state","change"],b=function(t,e){return!(!m.includes(e)||0===t.mean_type)||!(!y.includes(e)||!t.has_sum)},S=function(t,e,n,i,a){var r=new Date(n).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:r,adjustment:i,adjustment_unit_of_measurement:a})},x=function(t,e,n){var i=t.states[e];return i?(0,a.C)(i):(null==n?void 0:n.name)||e},k=function(t,e,n){var i,a;e&&(i=null===(a=t.states[e])||void 0===a?void 0:a.attributes.unit_of_measurement);return void 0===i?null==n?void 0:n.statistics_unit_of_measurement:i},C=function(t){return t.includes(":")},Z=function(t){return t.callWS({type:"recorder/update_statistics_issues"})}},6291:function(t,e,n){n.d(e,{f:function(){return l}});var i=n(75706),a=n(54521),r=n(4490),o=n(20129),s=n(53389),c=n(85297),u=(n(39710),n(26847),n(81738),n(72489),n(54480),n(1455),n(56389),n(27530),n(73742)),d=n(7616),l=function(t){var e=function(t){function e(){return(0,a.Z)(this,e),(0,o.Z)(this,e,arguments)}return(0,c.Z)(e,t),(0,r.Z)(e,[{key:"connectedCallback",value:function(){(0,s.Z)(e,"connectedCallback",this,3)([]),this._checkSubscribed()}},{key:"disconnectedCallback",value:function(){if((0,s.Z)(e,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){var t=this.__unsubs.pop();t instanceof Promise?t.then(function(t){return t()}):t()}this.__unsubs=void 0}}},{key:"updated",value:function(t){if((0,s.Z)(e,"updated",this,3)([t]),t.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var n,a=(0,i.Z)(t.keys());try{for(a.s();!(n=a.n()).done;){var r=n.value;if(this.hassSubscribeRequiredHostProps.includes(r))return void this._checkSubscribed()}}catch(o){a.e(o)}finally{a.f()}}}},{key:"hassSubscribe",value:function(){return[]}},{key:"_checkSubscribed",value:function(){var t,e=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some(function(t){return void 0===e[t]})||(this.__unsubs=this.hassSubscribe())}}])}(t);return(0,u.__decorate)([(0,d.Cb)({attribute:!1})],e.prototype,"hass",void 0),e}},68669:function(t,e,n){n.a(t,async function(t,i){try{n.r(e),n.d(e,{HuiEnergyDevicesGraphCard:function(){return M}});var a,r,o,s=n(29694),c=n(75778),u=n(54982),d=n(42385),l=n(54521),h=n(4490),f=n(67063),v=n(20129),p=n(85297),_=(n(12212),n(70021),n(24819),n(2394),n(18574),n(81738),n(29981),n(22960),n(6989),n(54480),n(67398),n(73742)),g=n(59048),m=n(7616),y=n(31733),b=n(28105),S=n(55815),x=n(28598),k=n(37008),C=n(6640),Z=n(7214),w=n(6291),R=n(93647),W=(n(31138),n(39884)),I=n(3901),D=t([k,C,x]);[k,C,x]=D.then?(await D)():D;var M=function(t){function e(){var t;(0,l.Z)(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=(0,v.Z)(this,e,[].concat(i)))._chartData=[],t.hassSubscribeRequiredHostProps=["_config"],t._createOptions=(0,b.Z)(function(e){var n,i,a=window.matchMedia("all and (max-width: 450px), all and (max-height: 500px)").matches;return{xAxis:{type:"value",name:"kWh"},yAxis:{type:"category",inverse:!0,triggerEvent:!0,data:null===(n=e[0])||void 0===n||null===(n=n.data)||void 0===n?void 0:n.map(function(t){return t.value[1]}),axisLabel:{formatter:t._getDeviceName.bind((0,f.Z)(t)),overflow:"truncate",fontSize:12,margin:5,width:Math.min(a?100:200,Math.max.apply(Math,(0,d.Z)((null===(i=e[0])||void 0===i||null===(i=i.data)||void 0===i?void 0:i.map(function(e){return(0,I.U)(t._getDeviceName(e.value[1]),12)+5}))||[])))}},grid:{top:5,left:5,right:40,bottom:0,containLabel:!0},tooltip:{show:!0,formatter:t._renderTooltip.bind((0,f.Z)(t))}}}),t}return(0,p.Z)(e,t),(0,h.Z)(e,[{key:"hassSubscribe",value:function(){var t,e=this;return[(0,C.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe(function(t){e._data=t,e._getStatistics(t)})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(t){this._config=t}},{key:"shouldUpdate",value:function(t){return(0,R.SN)(this,t)||t.size>1||!t.has("hass")}},{key:"render",value:function(){var t;return this.hass&&this._config?(0,g.dy)(a||(a=(0,u.Z)([" <ha-card> ",' <div class="content ','"> <ha-chart-base .hass="','" .data="','" .options="','" .height="','" @chart-click="','"></ha-chart-base> </div> </ha-card> '])),this._config.title?(0,g.dy)(r||(r=(0,u.Z)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,y.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._chartData),"".concat(28*((null===(t=this._chartData[0])||void 0===t||null===(t=t.data)||void 0===t?void 0:t.length)||0)+50,"px"),this._handleChartClick):g.Ld}},{key:"_renderTooltip",value:function(t){var e='<h4 style="text-align: center; margin: 0;">'.concat(this._getDeviceName(t.value[1]),"</h4>"),n="".concat((0,x.uf)(t.value[0],this.hass.locale,(0,x.l4)(void 0,this.hass.entities[t.value[1]]))," kWh");return"".concat(e).concat(t.marker," ").concat(t.seriesName,": ").concat(n)}},{key:"_getDeviceName",value:function(t){var e,n;return(null===(e=this._data)||void 0===e||null===(e=e.prefs.device_consumption.find(function(e){return e.stat_consumption===t}))||void 0===e?void 0:e.name)||(0,Z.Kd)(this.hass,t,null===(n=this._data)||void 0===n?void 0:n.statsMetadata[t])}},{key:"_getStatistics",value:(n=(0,c.Z)((0,s.Z)().m(function t(e){var n,i,a,r,o,c,u;return(0,s.Z)().w(function(t){for(;;)switch(t.n){case 0:return i=e.stats,a=e.statsCompare,r=[],o=[],c=[{type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:r,barWidth:a?10:20,cursor:"default"}],a&&c.push({type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.previous_energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:o,barWidth:10,cursor:"default"}),u=getComputedStyle(this),e.prefs.device_consumption.forEach(function(t,e){var n=t.stat_consumption in i&&(0,Z.Kj)(i[t.stat_consumption])||0,s=(0,S.hZ)(e,u);if(r.push({id:e,value:[n,t.stat_consumption],itemStyle:{color:s+"7F",borderColor:s}}),a){var c=t.stat_consumption in a&&(0,Z.Kj)(a[t.stat_consumption])||0;o.push({id:e,value:[c,t.stat_consumption],itemStyle:{color:s+"32",borderColor:s+"7F"}})}}),r.sort(function(t,e){return e.value[0]-t.value[0]}),r.length=Math.min((null===(n=this._config)||void 0===n?void 0:n.max_devices)||1/0,r.length),this._chartData=c,t.n=1,this.updateComplete;case 1:return t.a(2)}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"_handleChartClick",value:function(t){"axisLabel"===t.detail.targetType&&t.detail.value&&!(0,Z.Hs)(t.detail.value)&&(0,W.B)(this,"hass-more-info",{entityId:t.detail.value})}}]);var n}((0,w.f)(g.oi));M.styles=(0,g.iv)(o||(o=(0,u.Z)([".card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}ha-chart-base{--chart-max-height:none}"]))),(0,_.__decorate)([(0,m.Cb)({attribute:!1})],M.prototype,"hass",void 0),(0,_.__decorate)([(0,m.SB)()],M.prototype,"_config",void 0),(0,_.__decorate)([(0,m.SB)()],M.prototype,"_chartData",void 0),(0,_.__decorate)([(0,m.SB)()],M.prototype,"_data",void 0),M=(0,_.__decorate)([(0,m.Mo)("hui-energy-devices-graph-card")],M),i()}catch(O){i(O)}})},3901:function(t,e,n){n.d(e,{U:function(){return a}});var i;n(12212);function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Roboto, Noto, sans-serif";i||(i=document.createElement("canvas"));var a=i.getContext("2d");if(!a)return 0;a.font="".concat(e,"px ").concat(n);var r=a.measureText(t);return Math.ceil(Math.max(r.actualBoundingBoxRight+r.actualBoundingBoxLeft,r.width))}},19627:function(t,e,n){n.d(e,{X:function(){return o}});var i=n(40246),a=n(87191),r=n(29426);function o(t,e,n){var o=(0,r._)(t,e)/a.yJ;return(0,i.u)(null==n?void 0:n.roundingMethod)(o)}}}]);
//# sourceMappingURL=12697.30ab0e01f1bfbe51.js.map
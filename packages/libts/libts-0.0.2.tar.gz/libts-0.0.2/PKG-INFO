Metadata-Version: 2.4
Name: libts
Version: 0.0.2
Summary: 一个用于验证 RFC3161 时间戳签名的库
Home-page: https://github.com/Brassinolide/libts-py
Author: Brassinolide
Author-email: contact@crackme.net
Classifier: Programming Language :: Python :: 3
Classifier: Operating System :: Microsoft :: Windows
Classifier: Operating System :: POSIX :: Linux
Description-Content-Type: text/markdown
License-File: LICENSE
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license-file
Dynamic: summary

# libts

一个用于验证 RFC3161 时间戳签名的库

```shell
pip install libts
```

## example

以下为示例代码

```python
from libts import libts_ctx

ctx = libts_ctx()
ctx.load_system_ca()
code = ctx.ts_verify("example.txt", "example.txt.tsr")
print(ctx.format_return_code(code))
print(ctx.get_last_gentime_utc_formatted())
print(ctx.get_last_gentime_bj_formatted())
```

如果验证成功，则应该显示

```plaintext
> python test.py

验证成功
2025-07-08 11:50:24
2025-07-08 19:50:24
```

否则，会显示出详细错误信息，以下错误信息提示文件的哈希值和tsr中记录的哈希值不匹配

验证失败同样能获取时间戳，二者并不冲突

```plaintext
> python test-corrupted.py

验证失败 error:17800067:time stamp routines::message imprint mismatch
2025-07-08 11:50:24
2025-07-08 19:50:24
```

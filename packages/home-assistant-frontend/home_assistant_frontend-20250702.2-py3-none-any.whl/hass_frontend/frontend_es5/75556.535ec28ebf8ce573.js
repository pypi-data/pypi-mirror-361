"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["75556"],{25842:function(t,e,i){i.d(e,{F:function(){return s}});var a=i(29694),o=i(75778),s=(i(40777),i(26847),i(24819),i(81738),i(6989),i(54480),i(1455),i(48694),i(27530),function(){var t=(0,o.Z)((0,a.Z)().m(function t(e){var o,s,n,l,c;return(0,a.Z)().w(function(t){for(;;)switch(t.n){case 0:if(e.parentNode){t.n=1;break}throw new Error("Cannot setup Leaflet map on disconnected element");case 1:return t.n=2,Promise.resolve().then(i.t.bind(i,25975,23));case 2:return(o=t.v.default).Icon.Default.imagePath="/static/images/leaflet/images/",t.n=3,i.e("90150").then(i.t.bind(i,63295,23));case 3:return s=o.map(e),(n=document.createElement("link")).setAttribute("href","/static/images/leaflet/leaflet.css"),n.setAttribute("rel","stylesheet"),e.parentNode.appendChild(n),(l=document.createElement("link")).setAttribute("href","/static/images/leaflet/MarkerCluster.css"),l.setAttribute("rel","stylesheet"),e.parentNode.appendChild(l),s.setView([52.3731339,4.8903147],13),c=r(o).addTo(s),t.a(2,[s,o,c])}},t)}));return function(e){return t.apply(this,arguments)}}()),r=function(t){return t.tileLayer("https://basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}".concat(t.Browser.retina?"@2x.png":".png"),{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>, &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",minZoom:0,maxZoom:20})}},278:function(t,e,i){i.d(e,{k:function(){return c}});var a=i(54521),o=i(4490),s=i(20129),r=i(85297),n=i(53389),l=i(25975),c=function(t){function e(t,i,o){var r;return(0,a.Z)(this,e),(r=(0,s.Z)(this,e,[t,o])).decorationLayer=i,r}return(0,r.Z)(e,t),(0,o.Z)(e,[{key:"onAdd",value:function(t){var i;return(0,n.Z)(e,"onAdd",this,3)([t]),null===(i=this.decorationLayer)||void 0===i||i.addTo(t),this}},{key:"onRemove",value:function(t){var i;return null===(i=this.decorationLayer)||void 0===i||i.remove(),(0,n.Z)(e,"onRemove",this,3)([t])}}])}(l.Marker)},7113:function(t,e,i){i.a(t,async function(t,e){try{var a,o,s,r,n,l=i(54982),c=i(54521),h=i(4490),d=i(20129),p=i(85297),u=(i(12212),i(73742)),m=i(59048),f=i(7616),y=i(20480),v=i(39884),_=i(73048),b=t([_]);_=(b.then?(await b)():b)[0];var g=function(t){function e(){var t;(0,c.Z)(this,e);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(t=(0,d.Z)(this,e,[].concat(a))).showIcon=!1,t}return(0,p.Z)(e,t),(0,h.Z)(e,[{key:"render",value:function(){var t;return(0,m.dy)(a||(a=(0,l.Z)([' <div class="marker ','" style="','" @click="','"> '," </div> "])),this.entityPicture?"picture":"",(0,y.V)({"border-color":this.entityColor}),this._badgeTap,this.entityPicture?(0,m.dy)(o||(o=(0,l.Z)(['<div class="entity-picture" style="','"></div>'])),(0,y.V)({"background-image":"url(".concat(this.entityPicture,")")})):this.showIcon&&this.entityId?(0,m.dy)(s||(s=(0,l.Z)(['<ha-state-icon .hass="','" .stateObj="','"></ha-state-icon>'])),this.hass,null===(t=this.hass)||void 0===t?void 0:t.states[this.entityId]):this.entityUnit?(0,m.dy)(r||(r=(0,l.Z)([" ",' <span class="unit" style="display:','">',"</span> "])),this.entityName,this.entityUnit?"initial":"none",this.entityUnit):this.entityName)}},{key:"_badgeTap",value:function(t){t.stopPropagation(),this.entityId&&(0,v.B)(this,"hass-more-info",{entityId:this.entityId})}}])}(m.oi);g.styles=(0,m.iv)(n||(n=(0,l.Z)([".marker{display:flex;justify-content:center;text-align:center;align-items:center;box-sizing:border-box;width:48px;height:48px;font-size:var(--ha-marker-font-size, var(--ha-font-size-xl));border-radius:var(--ha-marker-border-radius,50%);border:1px solid var(--ha-marker-color,var(--primary-color));color:var(--primary-text-color);background-color:var(--card-background-color)}.marker.picture{overflow:hidden}.entity-picture{background-size:cover;height:100%;width:100%}.unit{margin-left:2px}"]))),(0,u.__decorate)([(0,f.Cb)({attribute:!1})],g.prototype,"hass",void 0),(0,u.__decorate)([(0,f.Cb)({attribute:"entity-id",reflect:!0})],g.prototype,"entityId",void 0),(0,u.__decorate)([(0,f.Cb)({attribute:"entity-name"})],g.prototype,"entityName",void 0),(0,u.__decorate)([(0,f.Cb)({attribute:"entity-unit"})],g.prototype,"entityUnit",void 0),(0,u.__decorate)([(0,f.Cb)({attribute:"entity-picture"})],g.prototype,"entityPicture",void 0),(0,u.__decorate)([(0,f.Cb)({attribute:"entity-color"})],g.prototype,"entityColor",void 0),(0,u.__decorate)([(0,f.Cb)({attribute:"show-icon",type:Boolean})],g.prototype,"showIcon",void 0),customElements.define("ha-entity-marker",g),e()}catch(k){e(k)}})},42031:function(t,e,i){i.a(t,async function(t,e){try{var a=i(83788),o=(i(26847),i(2394),i(81738),i(22960),i(6989),i(1455),i(27530),i(73742)),s=i(63359),r=i(59048),n=i(7616),l=i(39884),c=i(74266),h=i(45691),d=i(25842),p=i(6219),u=i(15459),m=i(14370),f=(i(48017),i(7113)),y=i(278),v=t([a,f,c,h]);[a,f,c,h]=v.then?(await v)():v;let _,b=t=>t;const g=t=>"string"==typeof t?t:t.entity_id;class k extends r.fl{connectedCallback(){super.connectedCallback(),this._loadMap(),this._attachObserver()}disconnectedCallback(){super.disconnectedCallback(),this.leafletMap&&(this.leafletMap.remove(),this.leafletMap=void 0,this.Leaflet=void 0),this._loaded=!1,this._resizeObserver&&this._resizeObserver.unobserve(this)}update(t){var e,i;if(super.update(t),!this._loaded)return;let a=!1;const o=t.get("hass");if(t.has("_loaded")||t.has("entities"))this._drawEntities(),a=!0;else if(this._loaded&&o&&this.entities)for(const s of this.entities)if(o.states[g(s)]!==this.hass.states[g(s)]){this._drawEntities(),a=!0;break}t.has("clusterMarkers")&&this._drawEntities(),(t.has("_loaded")||t.has("paths"))&&this._drawPaths(),(t.has("_loaded")||t.has("layers"))&&(this._drawLayers(t.get("layers")),a=!0),(t.has("_loaded")||this.autoFit&&a)&&this.fitMap(),t.has("zoom")&&this.leafletMap.setZoom(this.zoom),(t.has("themeMode")||t.has("hass")&&(!o||(null===(e=o.themes)||void 0===e?void 0:e.darkMode)!==(null===(i=this.hass.themes)||void 0===i?void 0:i.darkMode)))&&this._updateMapStyle()}get _darkMode(){return"dark"===this.themeMode||"auto"===this.themeMode&&Boolean(this.hass.themes.darkMode)}_updateMapStyle(){const t=this.renderRoot.querySelector("#map");t.classList.toggle("clickable",this.clickable),t.classList.toggle("dark",this._darkMode),t.classList.toggle("forced-dark","dark"===this.themeMode),t.classList.toggle("forced-light","light"===this.themeMode)}async _loadMap(){if(this._loading)return;let t=this.shadowRoot.getElementById("map");t||(t=document.createElement("div"),t.id="map",this.shadowRoot.append(t)),this._loading=!0;try{[this.leafletMap,this.Leaflet]=await(0,d.F)(t),this._updateMapStyle(),this.leafletMap.on("click",t=>{0===this._clickCount&&setTimeout(()=>{1===this._clickCount&&(0,l.B)(this,"map-clicked",{location:[t.latlng.lat,t.latlng.lng]}),this._clickCount=0},250),this._clickCount++}),this._loaded=!0}finally{this._loading=!1}}fitMap(t){var e,i,a,o;if(!this.leafletMap||!this.Leaflet||!this.hass)return;if(!(this._mapFocusItems.length||this._mapFocusZones.length||null!==(e=this.layers)&&void 0!==e&&e.length))return void this.leafletMap.setView(new this.Leaflet.LatLng(this.hass.config.latitude,this.hass.config.longitude),(null==t?void 0:t.zoom)||this.zoom);let s=this.Leaflet.latLngBounds(this._mapFocusItems?this._mapFocusItems.map(t=>t.getLatLng()):[]);null===(i=this._mapFocusZones)||void 0===i||i.forEach(t=>{s.extend("getBounds"in t?t.getBounds():t.getLatLng())}),null===(a=this.layers)||void 0===a||a.forEach(t=>{s.extend("getBounds"in t?t.getBounds():t.getLatLng())}),s=s.pad(null!==(o=null==t?void 0:t.pad)&&void 0!==o?o:.5),this.leafletMap.fitBounds(s,{maxZoom:(null==t?void 0:t.zoom)||this.zoom})}fitBounds(t,e){var i;if(!this.leafletMap||!this.Leaflet||!this.hass)return;const a=this.Leaflet.latLngBounds(t).pad(null!==(i=null==e?void 0:e.pad)&&void 0!==i?i:.5);this.leafletMap.fitBounds(a,{maxZoom:(null==e?void 0:e.zoom)||this.zoom})}_drawLayers(t){if(t&&t.forEach(t=>t.remove()),!this.layers)return;const e=this.leafletMap;this.layers.forEach(t=>{e.addLayer(t)})}_computePathTooltip(t,e){let i;return i=t.fullDatetime?(0,c.o0)(e.timestamp,this.hass.locale,this.hass.config):(0,s.z)(e.timestamp)?(0,h.Vu)(e.timestamp,this.hass.locale,this.hass.config):(0,h.xO)(e.timestamp,this.hass.locale,this.hass.config),`${t.name}<br>${i}`}_drawPaths(){const t=this.hass,e=this.leafletMap,i=this.Leaflet;if(!t||!e||!i)return;if(this._mapPaths.length&&(this._mapPaths.forEach(t=>t.remove()),this._mapPaths=[]),!this.paths)return;const a=getComputedStyle(this).getPropertyValue("--dark-primary-color");this.paths.forEach(t=>{let o,s;t.gradualOpacity&&(o=t.gradualOpacity/(t.points.length-2),s=1-t.gradualOpacity);for(let e=0;e<t.points.length-1;e++){const r=t.gradualOpacity?s+e*o:void 0;this._mapPaths.push(i.circleMarker(t.points[e].point,{radius:m.T?8:3,color:t.color||a,opacity:r,fillOpacity:r,interactive:!0}).bindTooltip(this._computePathTooltip(t,t.points[e]),{direction:"top"})),this._mapPaths.push(i.polyline([t.points[e].point,t.points[e+1].point],{color:t.color||a,opacity:r,interactive:!1}))}const r=t.points.length-1;if(r>=0){const e=t.gradualOpacity?s+r*o:void 0;this._mapPaths.push(i.circleMarker(t.points[r].point,{radius:m.T?8:3,color:t.color||a,opacity:e,fillOpacity:e,interactive:!0}).bindTooltip(this._computePathTooltip(t,t.points[r]),{direction:"top"}))}this._mapPaths.forEach(t=>e.addLayer(t))})}_drawEntities(){const t=this.hass,e=this.leafletMap,i=this.Leaflet;if(!t||!e||!i)return;if(this._mapItems.length&&(this._mapItems.forEach(t=>t.remove()),this._mapItems=[],this._mapFocusItems=[]),this._mapZones.length&&(this._mapZones.forEach(t=>t.remove()),this._mapZones=[],this._mapFocusZones=[]),this._mapCluster&&(this._mapCluster.remove(),this._mapCluster=void 0),!this.entities)return;const a=getComputedStyle(this),o=a.getPropertyValue("--accent-color"),s=a.getPropertyValue("--secondary-text-color"),r=a.getPropertyValue("--dark-primary-color"),n=this._darkMode?"dark":"light";for(const l of this.entities){const e=t.states[g(l)];if(!e)continue;const a="string"!=typeof l?l.name:void 0,c=null!=a?a:(0,u.C)(e),{latitude:h,longitude:d,passive:m,icon:f,radius:v,entity_picture:_,gps_accuracy:b}=e.attributes;if(!h||!d)continue;if("zone"===(0,p.N)(e)){if(m&&!this.renderPassive)continue;let t="";if(f){const e=document.createElement("ha-icon");e.setAttribute("icon",f),t=e.outerHTML}else{const e=document.createElement("span");e.innerHTML=c,t=e.outerHTML}const e=i.circle([h,d],{interactive:!1,color:m?s:o,radius:v}),a=new y.k([h,d],e,{icon:i.divIcon({html:t,iconSize:[24,24],className:n}),interactive:this.interactiveZones,title:c});this._mapZones.push(a),!this.fitZones||"string"!=typeof l&&!1===l.focus||this._mapFocusZones.push(e);continue}const k="string"!=typeof l&&"state"===l.label_mode?this.hass.formatEntityState(e):"string"!=typeof l&&"attribute"===l.label_mode&&void 0!==l.attribute?this.hass.formatEntityAttributeValue(e,l.attribute):null!=a?a:c.split(" ").map(t=>t[0]).join("").substr(0,3),C=document.createElement("ha-entity-marker");C.hass=this.hass,C.showIcon="string"!=typeof l&&"icon"===l.label_mode,C.entityId=g(l),C.entityName=k,C.entityUnit="string"!=typeof l&&l.unit&&"attribute"===l.label_mode?l.unit:"",C.entityPicture=!_||"string"!=typeof l&&l.label_mode?"":this.hass.hassUrl(_),"string"!=typeof l&&(C.entityColor=l.color);const M=new y.k([h,d],void 0,{icon:i.divIcon({html:C,iconSize:[48,48],className:""}),title:c});"string"!=typeof l&&!1===l.focus||this._mapFocusItems.push(M),b&&(M.decorationLayer=i.circle([h,d],{interactive:!1,color:r,radius:b})),this._mapItems.push(M)}this.clusterMarkers?(this._mapCluster=i.markerClusterGroup({showCoverageOnHover:!1,removeOutsideVisibleBounds:!1,maxClusterRadius:40}),this._mapCluster.addLayers(this._mapItems),e.addLayer(this._mapCluster)):this._mapItems.forEach(t=>e.addLayer(t)),this._mapZones.forEach(t=>e.addLayer(t))}async _attachObserver(){this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>{var t;null===(t=this.leafletMap)||void 0===t||t.invalidateSize({debounceMoveend:!0})})),this._resizeObserver.observe(this)}constructor(...t){super(...t),this.clickable=!1,this.autoFit=!1,this.renderPassive=!1,this.interactiveZones=!1,this.fitZones=!1,this.themeMode="auto",this.zoom=14,this.clusterMarkers=!0,this._loaded=!1,this._mapItems=[],this._mapFocusItems=[],this._mapZones=[],this._mapFocusZones=[],this._mapPaths=[],this._clickCount=0,this._loading=!1}}k.styles=(0,r.iv)(_||(_=b`:host{display:block;height:300px}#map{height:100%}#map.clickable{cursor:pointer}#map.dark{background:#090909}#map.forced-dark{color:#fff;--map-filter:invert(0.9) hue-rotate(170deg) brightness(1.5) contrast(1.2) saturate(0.3)}#map.forced-light{background:#fff;color:#000;--map-filter:invert(0)}#map.clickable:active,#map:active{cursor:grabbing;cursor:-moz-grabbing;cursor:-webkit-grabbing}.leaflet-tile-pane{filter:var(--map-filter)}.dark .leaflet-bar a{background-color:#1c1c1c;color:#fff}.dark .leaflet-bar a:hover{background-color:#313131}.leaflet-marker-draggable{cursor:move!important}.leaflet-edit-resize{border-radius:50%;cursor:nesw-resize!important}.named-icon{display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;color:var(--primary-text-color)}.leaflet-pane{z-index:0!important}.leaflet-bottom,.leaflet-control,.leaflet-top{z-index:1!important}.leaflet-tooltip{padding:8px;font-size:var(--ha-font-size-s);background:rgba(80,80,80,.9)!important;color:#fff!important;border-radius:4px;box-shadow:none!important;text-align:center}.marker-cluster div{background-clip:padding-box;background-color:var(--primary-color);border:3px solid rgba(var(--rgb-primary-color),.2);width:32px;height:32px;border-radius:20px;text-align:center;color:var(--text-primary-color);font-size:var(--ha-font-size-m)}.marker-cluster span{line-height:var(--ha-line-height-expanded)}`)),(0,o.__decorate)([(0,n.Cb)({attribute:!1})],k.prototype,"hass",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:!1})],k.prototype,"entities",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:!1})],k.prototype,"paths",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:!1})],k.prototype,"layers",void 0),(0,o.__decorate)([(0,n.Cb)({type:Boolean})],k.prototype,"clickable",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:"auto-fit",type:Boolean})],k.prototype,"autoFit",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:"render-passive",type:Boolean})],k.prototype,"renderPassive",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:"interactive-zones",type:Boolean})],k.prototype,"interactiveZones",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:"fit-zones",type:Boolean})],k.prototype,"fitZones",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:"theme-mode",type:String})],k.prototype,"themeMode",void 0),(0,o.__decorate)([(0,n.Cb)({type:Number})],k.prototype,"zoom",void 0),(0,o.__decorate)([(0,n.Cb)({attribute:"cluster-markers",type:Boolean})],k.prototype,"clusterMarkers",void 0),(0,o.__decorate)([(0,n.SB)()],k.prototype,"_loaded",void 0),k=(0,o.__decorate)([(0,n.Mo)("ha-map")],k),e()}catch(_){e(_)}})}}]);
//# sourceMappingURL=75556.535ec28ebf8ce573.js.map
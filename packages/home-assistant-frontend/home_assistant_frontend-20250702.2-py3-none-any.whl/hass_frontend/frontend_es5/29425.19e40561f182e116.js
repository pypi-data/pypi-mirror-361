"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["29425"],{87578:function(t,e,n){n.d(e,{x:function(){return i}});var i=function(t,e){return t.substring(0,e.length)===e}},16037:function(t,e,n){n.d(e,{V:function(){return r}});var i=n(53049),r=function(t,e){return function(t){switch(t){case"de":case"lb":return!0;default:return!1}}(e)?(0,i.f)(t):t.toLocaleLowerCase(e)}},32483:function(t,e,n){n.d(e,{U:function(){return h}});n(26847),n(7175),n(54480),n(48694),n(27530);var i=n(55815),r=n(45657),o=n(66169),a=n(44272),s=n(87409),c=n(16230),l=n(17332),d={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};var u=0,_=new Map;function h(t,e,n){return function(t,e,n){var i;if(!n||t===c.nZ)return(0,l.g)("--history-unavailable-color",e);if(t===c.lz)return(0,l.g)("--history-unknown-color",e);var u=(0,s.tD)(n,t);if(u){var _=(0,l.g)(u,e);if(_){var h=(0,a.M)(n.entity_id),v=null===(i=d[h])||void 0===i?void 0:i[t];return v?(0,r.uO)((0,o.C)((0,r.Rw)((0,r.wK)(_)),v)):_}}}(t,e,n)||function(t,e){if(_.has(t))return _.get(t);var n=(0,i.hZ)(u,e);return u++,_.set(t,n),n}(t,e)}},43563:function(t,e,n){n.d(e,{MY:function(){return b},Yc:function(){return y},hb:function(){return p},jV:function(){return _},o1:function(){return m},ri:function(){return f},sS:function(){return v}});var i,r=n(29694),o=n(75778),a=(n(12212),n(24533),n(54480),n(1455),n(64455),n(56303),n(6202),n(44261),n(40141)),s=n(44272),c=n(6219),l=n(16037),d=n(16230),u="ui.components.logbook.messages",_=["counter","proximity","sensor","zone"],h={triggered_by_numeric_state_of:"numeric state of",triggered_by_state_of:"state of",triggered_by_event:"event",triggered_by_time_pattern:"time pattern",triggered_by_time:"time",triggered_by_homeassistant_stopping:"Home Assistant stopping",triggered_by_homeassistant_starting:"Home Assistant starting"},v=99387==n.j?(i=(0,o.Z)((0,r.Z)().m(function t(e,n,i){return(0,r.Z)().w(function(t){for(;;)if(0===t.n)return t.a(2,g(e,n,void 0,void 0,i))},t)})),function(t,e,n){return i.apply(this,arguments)}):null,g=function(t,e,n,i,r,o){if((i||o)&&(!i||0===i.length)&&(!o||0===o.length))return Promise.resolve([]);var a={type:"logbook/get_events",start_time:e};return n&&(a.end_time=n),null!=i&&i.length&&(a.entity_ids=i),null!=o&&o.length&&(a.device_ids=o),r&&(a.context_id=r),t.callWS(a)},y=function(t,e,n,i,r,o,a){if((o||a)&&(!o||0===o.length)&&(!a||0===a.length))return Promise.reject("No entities or devices");var s={type:"logbook/event_stream",start_time:n,end_time:i};return null!=o&&o.length&&(s.entity_ids=o),null!=a&&a.length&&(s.device_ids=a),t.connection.subscribeMessage(function(t){return e(t,r)},s)},m=function(t,e){return{entity_id:t.entity_id,state:e,attributes:{device_class:null==t?void 0:t.attributes.device_class,source_type:null==t?void 0:t.attributes.source_type,has_date:null==t?void 0:t.attributes.has_date,has_time:null==t?void 0:t.attributes.has_time,entity_picture_local:a.iY.has((0,s.M)(t.entity_id))||null==t?void 0:t.attributes.entity_picture_local,entity_picture:a.iY.has((0,s.M)(t.entity_id))||null==t?void 0:t.attributes.entity_picture}}},p=function(t,e){for(var n=0,i=Object.keys(h);n<i.length;n++){var r=i[n],o=h[r];if(e.startsWith(o))return e.replace(o,"".concat(t("ui.components.logbook.".concat(r))))}return e},f=function(t,e,n,i,r){switch(r){case"device_tracker":case"person":return"not_home"===n?e("".concat(u,".was_away")):"home"===n?e("".concat(u,".was_at_home")):e("".concat(u,".was_at_state"),{state:n});case"sun":return e("".concat(u,"above_horizon"===n?".rose":".set"));case"binary_sensor":var o=n===a.uo,s=n===a.lC,c=i.attributes.device_class;if(c&&(o||s))return e("".concat(u,".").concat(o?"detected_device_classes":"cleared_device_classes",".").concat(c),{device_class:(0,l.V)(e("component.binary_sensor.entity_component.".concat(c,".name"))||c,t.language)})||e("".concat(u,".").concat(o?"detected_device_class":"cleared_device_class"),{device_class:(0,l.V)(e("component.binary_sensor.entity_component.".concat(c,".name"))||c,t.language)});break;case"cover":switch(n){case"open":return e("".concat(u,".was_opened"));case"opening":return e("".concat(u,".is_opening"));case"closing":return e("".concat(u,".is_closing"));case"closed":return e("".concat(u,".was_closed"))}break;case"event":return e("".concat(u,".detected_event_no_type"));case"lock":switch(n){case"unlocked":return e("".concat(u,".was_unlocked"));case"locking":return e("".concat(u,".is_locking"));case"unlocking":return e("".concat(u,".is_unlocking"));case"opening":return e("".concat(u,".is_opening"));case"open":return e("".concat(u,".is_opened"));case"locked":return e("".concat(u,".was_locked"));case"jammed":return e("".concat(u,".is_jammed"))}}return n===a.uo?e("".concat(u,".turned_on")):n===a.lC?e("".concat(u,".turned_off")):n===d.lz?e("".concat(u,".became_unknown")):n===d.nZ?e("".concat(u,".became_unavailable")):t.localize("".concat(u,".changed_to_state"),{state:i?t.formatEntityState(i,n):n})},b=function(t){return"sensor"!==(0,c.N)(t)||void 0===t.attributes.unit_of_measurement&&void 0===t.attributes.state_class}},59715:function(t,e,n){n.d(e,{U_:function(){return s},Zm:function(){return l},lj:function(){return a},mA:function(){return o},nV:function(){return c}});n(40777),n(70021),n(6988),n(81738),n(29981),n(96821),n(24533),n(54480);if(99387==n.j)var i=n(87578);var r=n(10142),o=function(t,e,n,i){return t.callWS({type:"trace/get",domain:e,item_id:n,run_id:i})},a=function(t,e,n){return t.callWS({type:"trace/list",domain:e,item_id:n})},s=function(t,e,n){return t.callWS({type:"trace/contexts",domain:e,item_id:n})},c=function(t,e){for(var n=e.split("/").reverse(),i=t;n.length;){var o=n.pop(),a=Number(o);if(isNaN(a)){var s=i[o];if(!s&&"sequence"===o)continue;s||"trigger"!==o||(s=i.triggers),s||"condition"!==o||(s=i.conditions),s||"action"!==o||(s=i.actions),i="trigger"===o?(0,r.Kc)(s):s}else if(Array.isArray(i))i=i[a];else if(0!==a)throw new Error("If config is not an array, can only return index 0")}return i},l=function(t){return"trigger"===t||(0,i.x)(t,"trigger/")}},63583:function(t,e,n){n.a(t,async function(t,e){try{var i,r,o,a,s,c,l,d,u,_,h,v,g,y,m,p,f,b,x=n(54982),k=n(54521),w=n(4490),z=n(20129),C=n(85297),Z=(n(12212),n(39710),n(87622),n(26847),n(24819),n(2394),n(13571),n(81738),n(6989),n(54480),n(64455),n(26086),n(56389),n(6202),n(27530),n(73742)),I=n(59048),M=n(7616),S=n(31733),E=n(20480),j=n(37528),N=n(40142),P=n(45691),B=n(89868),L=n(39884),T=n(44272),U=n(67050),W=n(32483),D=n(23476),O=(n(5786),n(19262)),V=n(43563),A=n(95814),Y=n(54643),$=n(35580),H=n(96222),K=t([D,O,N,P]);[D,O,N,P]=K.then?(await K)():K;var q=["script","automation"],F=function(t){function e(){var t;(0,k.Z)(this,e);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(t=(0,z.Z)(this,e,[].concat(c))).userIdToName={},t.traceContexts={},t.entries=[],t.narrow=!1,t.virtualize=!1,t.showIndicator=!1,t.noIcon=!1,t.noName=!1,t.relativeTime=!1,t._renderLogbookItem=function(e,n){var c;if(!e||void 0===n)return I.Ld;var l=t.entries[n-1],d=[],u=e.entity_id?t.hass.states[e.entity_id]:void 0,_=u?(0,V.o1)(u,e.state):void 0,h=e.entity_id?(0,T.M)(e.entity_id):e.domain,v=_||e.icon||e.state||!h||!(0,j.p)(t.hass,h)?void 0:(0,$.X1)({domain:h,type:"icon",useFallback:!0,darkOptimized:null===(c=t.hass.themes)||void 0===c?void 0:c.darkMode}),g=q.includes(e.domain)&&e.context_id&&e.context_id in t.traceContexts?t.traceContexts[e.context_id]:void 0,y=void 0!==g;return(0,I.dy)(i||(i=(0,x.Z)([' <div class="entry-container ','" .traceLink="','" @click="','"> ',' <div class="entry ','"> <div class="icon-message"> '," ",' <div class="message-relative_time"> <div class="message"> '," "," ",' </div> <div class="secondary"> <span>','</span> - <ha-relative-time .hass="','" .datetime="','" capitalize></ha-relative-time> '," "," </div> </div> </div> "," </div> </div> "])),(0,S.$)({clickable:y}),g?"/config/".concat(g.domain,"/trace/").concat(g.item_id,"?run_id=").concat(g.run_id):void 0,t._handleClick,0===n||null!=e&&e.when&&null!=l&&l.when&&new Date(1e3*e.when).toDateString()!==new Date(1e3*l.when).toDateString()?(0,I.dy)(r||(r=(0,x.Z)([' <h4 class="date"> '," </h4> "])),(0,N.p6)(new Date(1e3*e.when),t.hass.locale,t.hass.config)):I.Ld,(0,S.$)({"no-entity":!e.entity_id}),t.noIcon?"":(0,I.dy)(o||(o=(0,x.Z)([' <state-badge .hass="','" .overrideIcon="','" .overrideImage="','" .stateObj="','" .stateColor="','"></state-badge> '])),t.hass,e.icon,v,e.icon?void 0:_,!1),t.showIndicator?t._renderIndicator(e):"",t.noName?"":t._renderEntity(e.entity_id,e.name,y),t._renderMessage(e,d,h,_,y),t._renderContextMessage(e,d,y),(0,P.Vu)(new Date(1e3*e.when),t.hass.locale,t.hass.config),t.hass,1e3*e.when,e.context_user_id?(0,I.dy)(a||(a=(0,x.Z)(["",""])),t._renderUser(e)):"",y?"- ".concat(t.hass.localize("ui.components.logbook.show_trace")):"",y?(0,I.dy)(s||(s=(0,x.Z)(["<ha-icon-next></ha-icon-next>"]))):"")},t}return(0,C.Z)(e,t),(0,w.Z)(e,[{key:"willUpdate",value:function(t){(!this.hasUpdated&&this.virtualize||t.has("virtualize")&&this.virtualize)&&(this.hass.loadBackendTranslation("services"),this.hass.loadBackendTranslation("title"),(0,Y.o)())}},{key:"shouldUpdate",value:function(t){var e=t.get("hass"),n=void 0===e||e.locale!==this.hass.locale;return t.has("entries")||t.has("traceContexts")||n}},{key:"render",value:function(){var t,e=this;return null!==(t=this.entries)&&void 0!==t&&t.length?(0,I.dy)(l||(l=(0,x.Z)([' <div class="container ha-scrollbar ','" @scroll="','"> '," </div> "])),(0,S.$)({narrow:this.narrow,"no-name":this.noName,"no-icon":this.noIcon}),this._saveScrollPos,this.virtualize?(0,I.dy)(d||(d=(0,x.Z)(['<lit-virtualizer @visibilityChanged="','" scroller class="ha-scrollbar" .items="','" .renderItem="','"> </lit-virtualizer>'])),this._visibilityChanged,this.entries,this._renderLogbookItem):this.entries.map(function(t,n){return e._renderLogbookItem(t,n)})):(0,I.dy)(c||(c=(0,x.Z)([' <div class="container no-entries"> '," </div> "])),this.hass.localize("ui.components.logbook.entries_not_found"))}},{key:"_saveScrollPos",value:function(t){this._savedScrollPos=t.target.scrollTop}},{key:"_visibilityChanged",value:function(t){(0,L.B)(this,"hass-logbook-live",{enable:0===t.first})}},{key:"_renderIndicator",value:function(t){var e=this.hass.states[t.entity_id],n=getComputedStyle(this),i={backgroundColor:void 0!==t.state?(0,W.U)(t.state,n,e):void 0};return(0,I.dy)(u||(u=(0,x.Z)([' <div class="indicator" style="','"></div> '])),(0,E.V)(i))}},{key:"_renderMessage",value:function(t,e,n,i,r){if(t.entity_id&&t.state)return i?(0,V.ri)(this.hass,this.hass.localize,t.state,i,n):t.state;var o=function(t){return t.context_event_type||t.context_state||t.context_message}(t),a=t.message;if(q.includes(n)&&t.source){if(o)return"";a=(0,V.hb)(this.hass.localize,t.source)}return a?this._formatMessageWithPossibleEntity(o?function(t,e){return e?t.replace(e," "):t}(a,t.context_entity_id):a,e,void 0,r):""}},{key:"_renderUser",value:function(t){var e=t.context_user_id&&this.userIdToName[t.context_user_id];return e?"- ".concat(e):""}},{key:"_renderUnseenContextSourceEntity",value:function(t,e,n){return!t.context_entity_id||e.includes(t.context_entity_id)?"":(0,I.dy)(_||(_=(0,x.Z)([" (",")"])),this._renderEntity(t.context_entity_id,t.context_entity_id_name,n))}},{key:"_renderContextMessage",value:function(t,e,n){if(t.context_state){var i=t.context_entity_id&&t.context_entity_id in this.hass.states?(0,V.o1)(this.hass.states[t.context_entity_id],t.context_state):void 0;return(0,I.dy)(h||(h=(0,x.Z)([""," "," ",""])),this.hass.localize("ui.components.logbook.triggered_by_state_of"),this._renderEntity(t.context_entity_id,t.context_entity_id_name,n),i?(0,V.ri)(this.hass,this.hass.localize,t.context_state,i,(0,T.M)(t.context_entity_id)):t.context_state)}var r;if("call_service"===t.context_event_type)return(0,I.dy)(v||(v=(0,x.Z)([""," ",""])),this.hass.localize("ui.components.logbook.triggered_by_action"),t.context_domain&&t.context_service?"".concat((0,H.Lh)(this.hass.localize,t.context_domain),":\n      ").concat(this.hass.localize("component.".concat(t.context_domain,".services.").concat(t.context_service,".name"))||(null===(r=this.hass.services[t.context_domain])||void 0===r||null===(r=r[t.context_service])||void 0===r?void 0:r.name)||t.context_service):"");if(!t.context_message||e.includes(t.context_entity_id))return"";if("automation_triggered"===t.context_event_type||"script_started"===t.context_event_type){var o=t.context_source?t.context_source:t.context_message.replace("triggered by ",""),a=(0,V.hb)(this.hass.localize,o);return(0,I.dy)(g||(g=(0,x.Z)([""," "," ",""])),this.hass.localize("automation_triggered"===t.context_event_type?"ui.components.logbook.triggered_by_automation":"ui.components.logbook.triggered_by_script"),this._renderEntity(t.context_entity_id,t.context_entity_id_name,n),t.context_message?this._formatMessageWithPossibleEntity(a,e,void 0,n):"")}return(0,I.dy)(y||(y=(0,x.Z)([" "," "," "," ",""])),this.hass.localize("ui.components.logbook.triggered_by"),t.context_name,this._formatMessageWithPossibleEntity(t.context_message,e,t.context_entity_id,n),this._renderUnseenContextSourceEntity(t,e,n))}},{key:"_renderEntity",value:function(t,e,n){var i=t&&t in this.hass.states,r=e||i&&this.hass.states[t].attributes.friendly_name||t;return i?n?r:(0,I.dy)(m||(m=(0,x.Z)(['<button class="link" @click="','" .entityId="','"> '," </button>"])),this._entityClicked,t,r):r}},{key:"_formatMessageWithPossibleEntity",value:function(t,e,n,i){if(-1!==t.indexOf("."))for(var r=t.split(" "),o=0,a=r.length;o<a;o++)if(r[o]in this.hass.states){var s=r[o];if(e.includes(s))return"";e.push(s);var c=r.splice(o);return c.shift(),(0,I.dy)(p||(p=(0,x.Z)([""," "," ",""])),r.join(" "),this._renderEntity(s,this.hass.states[s].attributes.friendly_name,i),c.join(" "))}if(n&&n in this.hass.states){var l=this.hass.states[n].attributes.friendly_name;if(l&&t.endsWith(l))return e.includes(n)?"":(e.push(n),t=t.substring(0,t.length-l.length),(0,I.dy)(f||(f=(0,x.Z)([""," ",""])),t,this._renderEntity(n,l,i)))}return t}},{key:"_entityClicked",value:function(t){var e=t.currentTarget.entityId;e&&(t.preventDefault(),t.stopPropagation(),(0,L.B)(this,"hass-more-info",{entityId:e}))}},{key:"_handleClick",value:function(t){var e=t.currentTarget;e.traceLink&&((0,U.c)(e.traceLink),(0,L.B)(this,"closed"))}}],[{key:"styles",get:function(){return[A.Qx,A.$c,A.k1,(0,I.iv)(b||(b=(0,x.Z)([":host([virtualize]){display:block;height:100%}.entry-container{width:100%}.entry{position:relative;display:flex;width:100%;line-height:var(--ha-line-height-expanded);padding:8px 16px;box-sizing:border-box;border-top:1px solid var(--divider-color);justify-content:space-between;align-items:center}.indicator{background-color:var(--disabled-color);height:8px;width:8px;border-radius:4px;flex-shrink:0;margin-right:12px;margin-inline-start:initial;margin-inline-end:12px;direction:var(--direction)}ha-icon-next{color:var(--secondary-text-color)}.clickable{cursor:pointer}:not(.clickable) .entry.no-entity,:not(.clickable) .no-name .entry{cursor:default}.entry:hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.narrow:not(.no-icon) .time{margin-left:32px;margin-inline-start:32px;margin-inline-end:initial;direction:var(--direction)}.message-relative_time{display:flex;flex-direction:column}.secondary{font-size:var(--ha-font-size-s);line-height:var(--ha-line-height-normal)}.secondary a{color:var(--secondary-text-color)}.date{margin:8px 0;padding:0 16px}.icon-message{display:flex;align-items:center}.no-entries{text-align:center;color:var(--secondary-text-color)}state-badge{margin-right:16px;margin-inline-start:initial;flex-shrink:0;color:var(--state-icon-color);margin-inline-end:16px;direction:var(--direction)}.message{color:var(--primary-text-color)}.no-name .message:first-letter{text-transform:capitalize}a{color:var(--primary-color);text-decoration:none}button.link{color:var(--state-icon-color);text-decoration:none}.container{max-height:var(--logbook-max-height)}.container,lit-virtualizer{height:100%}lit-virtualizer{contain:size layout!important}.narrow .entry{line-height:var(--ha-line-height-normal)}.narrow .icon-message state-badge{margin-left:0;margin-inline-start:0;margin-right:8px;margin-inline-end:8px;direction:var(--direction)}"])))]}}])}(I.oi);(0,Z.__decorate)([(0,M.Cb)({attribute:!1})],F.prototype,"hass",void 0),(0,Z.__decorate)([(0,M.Cb)({attribute:!1})],F.prototype,"userIdToName",void 0),(0,Z.__decorate)([(0,M.Cb)({attribute:!1})],F.prototype,"traceContexts",void 0),(0,Z.__decorate)([(0,M.Cb)({attribute:!1})],F.prototype,"entries",void 0),(0,Z.__decorate)([(0,M.Cb)({type:Boolean,attribute:"narrow"})],F.prototype,"narrow",void 0),(0,Z.__decorate)([(0,M.Cb)({type:Boolean,attribute:"virtualize",reflect:!0})],F.prototype,"virtualize",void 0),(0,Z.__decorate)([(0,M.Cb)({type:Boolean,attribute:"show-indicator"})],F.prototype,"showIndicator",void 0),(0,Z.__decorate)([(0,M.Cb)({type:Boolean,attribute:"no-icon"})],F.prototype,"noIcon",void 0),(0,Z.__decorate)([(0,M.Cb)({type:Boolean,attribute:"no-name"})],F.prototype,"noName",void 0),(0,Z.__decorate)([(0,M.Cb)({type:Boolean,attribute:"relative-time"})],F.prototype,"relativeTime",void 0),(0,Z.__decorate)([(0,B.i)(".container")],F.prototype,"_savedScrollPos",void 0),(0,Z.__decorate)([(0,M.hO)({passive:!0})],F.prototype,"_saveScrollPos",null),(0,Z.__decorate)([(0,M.hO)({passive:!0})],F.prototype,"_visibilityChanged",null),F=(0,Z.__decorate)([(0,M.Mo)("ha-logbook-renderer")],F),e()}catch(Q){e(Q)}})}}]);
//# sourceMappingURL=29425.19e40561f182e116.js.map
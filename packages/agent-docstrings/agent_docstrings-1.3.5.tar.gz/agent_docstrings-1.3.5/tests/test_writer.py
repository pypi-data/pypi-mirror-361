"""
    --- AUTO-GENERATED DOCSTRING ---
    Table of content is automatically generated by Agent Docstrings v1.3.0
    
    Classes/Functions:
        - test_process_file_inserts_header(source_processor) -> None (line 17)
    --- END AUTO-GENERATED DOCSTRING ---
"""
from __future__ import annotations

from pathlib import Path
from textwrap import dedent

from agent_docstrings.core import process_file


def test_process_file_inserts_header(source_processor) -> None:
    """Ensures :pyfunc:`process_file` adds a header to a Python source file."""
    file_content = dedent(
        """
        class Greeter:
            def hello(self, name):
                print(f"Hello, {name}!")
        """
    ).lstrip()

    new_content, _, _ = source_processor("greet.py", file_content)

    assert new_content.startswith('"""')  # * The generated docstring should be at the top.
    assert "Greeter" in new_content
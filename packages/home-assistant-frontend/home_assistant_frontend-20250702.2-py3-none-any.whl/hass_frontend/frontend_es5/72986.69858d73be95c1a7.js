"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["72986"],{55815:function(e,t,r){r.d(t,{Eu:function(){return i},hZ:function(){return s},o9:function(){return c}});r(24819),r(54480);var a=r(28105),n=r(45657),o=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function i(e){return o[e%o.length]}function s(e,t){var r=t.getPropertyValue("--graph-color-".concat(e+1))||i(e);return(0,n.Rq)(r)}var c=(0,a.Z)(function(e){return o.map(function(t,r){return s(r,e)})},function(e,t){return e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1")})},84447:function(e,t,r){r(26847),r(87799),r(27530);var a=r(73742),n=r(27885),o=r(67522),i=r(23533),s=r(7046),c=r(59048),u=r(7616);let d,l,h,f,p=e=>e;class _ extends n.g{renderOutline(){return this.filled?(0,c.dy)(d||(d=p`<span class="filled"></span>`)):super.renderOutline()}getContainerClasses(){return Object.assign(Object.assign({},super.getContainerClasses()),{},{active:this.active})}renderPrimaryContent(){return(0,c.dy)(l||(l=p` <span class="leading icon" aria-hidden="true"> ${0} </span> <span class="label">${0}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${0} </span> `),this.renderLeadingIcon(),this.label,this.renderTrailingIcon())}renderTrailingIcon(){return(0,c.dy)(h||(h=p`<slot name="trailing-icon"></slot>`))}constructor(...e){super(...e),this.filled=!1,this.active=!1}}_.styles=[i.W,s.W,o.W,(0,c.iv)(f||(f=p`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:var(--ha-font-family-body)}`))],(0,a.__decorate)([(0,u.Cb)({type:Boolean,reflect:!0})],_.prototype,"filled",void 0),(0,a.__decorate)([(0,u.Cb)({type:Boolean})],_.prototype,"active",void 0),_=(0,a.__decorate)([(0,u.Mo)("ha-assist-chip")],_)},6291:function(e,t,r){r.d(t,{f:function(){return l}});var a=r(75706),n=r(54521),o=r(4490),i=r(20129),s=r(53389),c=r(85297),u=(r(39710),r(26847),r(81738),r(72489),r(54480),r(1455),r(56389),r(27530),r(73742)),d=r(7616),l=function(e){var t=function(e){function t(){return(0,n.Z)(this,t),(0,i.Z)(this,t,arguments)}return(0,c.Z)(t,e),(0,o.Z)(t,[{key:"connectedCallback",value:function(){(0,s.Z)(t,"connectedCallback",this,3)([]),this._checkSubscribed()}},{key:"disconnectedCallback",value:function(){if((0,s.Z)(t,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){var e=this.__unsubs.pop();e instanceof Promise?e.then(function(e){return e()}):e()}this.__unsubs=void 0}}},{key:"updated",value:function(e){if((0,s.Z)(t,"updated",this,3)([e]),e.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps){var r,n=(0,a.Z)(e.keys());try{for(n.s();!(r=n.n()).done;){var o=r.value;if(this.hassSubscribeRequiredHostProps.includes(o))return void this._checkSubscribed()}}catch(i){n.e(i)}finally{n.f()}}}},{key:"hassSubscribe",value:function(){return[]}},{key:"_checkSubscribed",value:function(){var e,t=this;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(e=this.hassSubscribeRequiredHostProps)&&void 0!==e&&e.some(function(e){return void 0===t[e]})||(this.__unsubs=this.hassSubscribe())}}])}(e);return(0,u.__decorate)([(0,d.Cb)({attribute:!1})],t.prototype,"hass",void 0),t}},94412:function(e,t,r){r.d(t,{H:function(){return o}});r(20655);var a=r(45657),n=r(66169);function o(e,t,r,o,i,s){var c=e.getPropertyValue(i+"-"+s).trim(),u=c.length>0?c:e.getPropertyValue(i).trim(),d=(0,a.Rq)(u);return 0===c.length&&s&&(d=(0,a.CO)((0,a.p3)(t?(0,n.C)((0,a.Rw)((0,a.wK)(d)),s):(0,n.W)((0,a.Rw)((0,a.wK)(d)),s)))),o?d+=r?"32":"7F":r&&(d+="7F"),d}},49639:function(e,t,r){r.a(e,async function(e,a){try{r.r(t),r.d(t,{HuiEnergyUsageGraphCard:function(){return M}});var n,o,i,s,c=r(10354),u=r(29694),d=r(42385),l=r(75706),h=r(75778),f=r(54982),p=r(54521),_=r(4490),g=r(20129),y=r(85297),v=(r(12212),r(39710),r(2394),r(18574),r(81738),r(22960),r(72489),r(87799),r(48454),r(24533),r(54480),r(69920),r(67398),r(73742)),b=r(26062),m=r(66386),k=r(63359),Z=r(59048),S=r(7616),C=r(31733),x=r(28105),O=r(94412),w=r(28598),j=r(37008),z=(r(31138),r(6640)),E=r(7214),D=r(6291),P=r(93647),B=r(94969),H=e([j,w,z,B]);[j,w,z,B]=H.then?(await H)():H;var I={to_grid:"--energy-grid-return-color",to_battery:"--energy-battery-in-color",from_grid:"--energy-grid-consumption-color",used_grid:"--energy-grid-consumption-color",used_solar:"--energy-solar-color",used_battery:"--energy-battery-out-color"},M=function(e){function t(){var e;(0,p.Z)(this,t);for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=(0,g.Z)(this,t,[].concat(a)))._chartData=[],e._start=(0,b.I)(),e._end=(0,m.p)(),e.hassSubscribeRequiredHostProps=["_config"],e._formatTotal=function(t){return t>0?e.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.total_consumed",{num:(0,w.uf)(t,e.hass.locale)}):e.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.total_returned",{num:(0,w.uf)(-t,e.hass.locale)})},e._createOptions=(0,x.Z)(function(t,r,a,n,o,i){var s=(0,B.J)(t,r,a,n,"kWh",o,i,e._formatTotal);return Object.assign(Object.assign({},s),{},{tooltip:Object.assign(Object.assign({},s.tooltip),{},{formatter:function(e){var t,r;return Array.isArray(e)?(e.sort(function(e,t){var r,a,n=null===(r=e.value)||void 0===r?void 0:r[1],o=null===(a=t.value)||void 0===a?void 0:a[1];return n>0&&o<0?-1:o>0&&n<0?1:n>0?t.componentIndex-e.componentIndex:e.componentIndex-t.componentIndex}),null===(t=s.tooltip)||void 0===t||null===(r=t.formatter)||void 0===r?void 0:r.call(t,e)):""}})})}),e}return(0,y.Z)(t,e),(0,_.Z)(t,[{key:"hassSubscribe",value:function(){var e,t=this;return[(0,z.UB)(this.hass,{key:null===(e=this._config)||void 0===e?void 0:e.collection_key}).subscribe(function(e){return t._getStatistics(e)})]}},{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(e){this._config=e}},{key:"shouldUpdate",value:function(e){return(0,P.SN)(this,e)||e.size>1||!e.has("hass")}},{key:"render",value:function(){return this.hass&&this._config?(0,Z.dy)(n||(n=(0,f.Z)([" <ha-card> ",' <div class="content ','"> <ha-chart-base .hass="','" .data="','" .options="','" chart-type="bar"></ha-chart-base> '," </div> </ha-card> "])),this._config.title?(0,Z.dy)(o||(o=(0,f.Z)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,C.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,this._compareStart,this._compareEnd),this._chartData.some(function(e){return e.data.length})?"":(0,Z.dy)(i||(i=(0,f.Z)(['<div class="no-data"> '," </div>"])),(0,k.z)(this._start)?this.hass.localize("ui.panel.lovelace.cards.energy.no_data"):this.hass.localize("ui.panel.lovelace.cards.energy.no_data_period"))):Z.Ld}},{key:"_getStatistics",value:(r=(0,h.Z)((0,u.Z)().m(function e(t){var r,a,n,o,i,s,c,h,f,p,_,g,y,v,b,k,Z,S,C,x,O;return(0,u.Z)().w(function(e){for(;;)switch(e.n){case 0:r=[],a={},n=(0,l.Z)(t.prefs.energy_sources),e.p=1,n.s();case 2:if((o=n.n()).done){e.n=7;break}if("solar"!==(i=o.value).type){e.n=3;break}return a.solar?a.solar.push(i.stat_energy_from):a.solar=[i.stat_energy_from],e.a(3,6);case 3:if("battery"!==i.type){e.n=4;break}return a.to_battery?(a.to_battery.push(i.stat_energy_to),a.from_battery.push(i.stat_energy_from)):(a.to_battery=[i.stat_energy_to],a.from_battery=[i.stat_energy_from]),e.a(3,6);case 4:if("grid"===i.type){e.n=5;break}return e.a(3,6);case 5:s=(0,l.Z)(i.flow_from);try{for(s.s();!(c=s.n()).done;)h=c.value,a.from_grid?a.from_grid.push(h.stat_energy_from):a.from_grid=[h.stat_energy_from]}catch(u){s.e(u)}finally{s.f()}f=(0,l.Z)(i.flow_to);try{for(f.s();!(p=f.n()).done;)_=p.value,a.to_grid?a.to_grid.push(_.stat_energy_to):a.to_grid=[_.stat_energy_to]}catch(u){f.e(u)}finally{f.f()}case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,O=e.v,n.e(O);case 9:return e.p=9,n.f(),e.f(9);case 10:g=getComputedStyle(this),y={},Object.keys(I).forEach(function(e){y[e]={},"used_grid"!==e&&"used_solar"!==e&&"used_battery"!==e&&a[e]&&Object.values(a[e]).forEach(function(t,r){y[e][t]=r})}),v={used_grid:this.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.combined_from_grid"),used_solar:this.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.consumed_solar"),used_battery:this.hass.localize("ui.panel.lovelace.cards.energy.energy_usage_graph.consumed_battery")},this._start=t.start,this._end=t.end||(0,m.p)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,b=(0,z.EH)(t),k=b.summedData,Z=b.compareSummedData,S=(0,z.E4)(k,Z),C=S.consumption,x=S.compareConsumption,t.statsCompare&&r.push.apply(r,(0,d.Z)(this._processDataSet(t.statsCompare,t.statsMetadata,Z,x,a,y,g,v,!0))),r.push({id:"compare-placeholder",type:"bar",stack:t.statsCompare?"compare":"usage",data:[],order:0}),r.push.apply(r,(0,d.Z)(this._processDataSet(t.stats,t.statsMetadata,k,C,a,y,g,v,!1))),r.sort(function(e,t){return e.order-t.order}),(0,B.Zx)(r),this._chartData=r;case 11:return e.a(2)}},e,this,[[1,8,9,10]])})),function(e){return r.apply(this,arguments)})},{key:"_processDataSet",value:function(e,t,r,a,n,o,i,s){var u=this,d=arguments.length>8&&void 0!==arguments[8]&&arguments[8],h=[],f={};if(Object.entries(n).forEach(function(t){var r=(0,c.Z)(t,2),a=r[0],n=r[1];if(["to_grid","from_grid","to_battery"].includes(a)){var o={};n.forEach(function(t){var r=e[t];if(r){var a={};r.forEach(function(e){if(null!==e.change&&void 0!==e.change){var t=e.change;e.start in a||(a[e.start]=t)}}),o[t]=a}}),f[a]=o}}),f.used_solar={used_solar:a.used_solar},f.used_battery={used_battery:a.used_battery},f.from_grid&&r.to_battery){for(var p={},_=function(){var e=(0,c.Z)(y[g],2),t=e[0];if(!e[1])return 1;for(var r,n=0,o=0,i=Object.entries(f.from_grid);o<i.length;o++){var s=(0,c.Z)(i[o],2),u=s[0];if(s[1][t]&&(r=u,n++),n>1)break}1===n?f.from_grid[r][t]=a.used_grid[t]:(Object.values(f.from_grid).forEach(function(e){delete e[t]}),p[t]=a.used_grid[t])},g=0,y=Object.entries(a.grid_to_battery);g<y.length;g++)_();f.used_grid={used_grid:p}}var v=r.timestamps,b=(0,B.kT)(this._start,this._compareStart);return Object.entries(f).forEach(function(e,r){var a=(0,c.Z)(e,2),n=a[0],p=a[1];Object.entries(p).forEach(function(e){var a,p,_,g=(0,c.Z)(e,2),y=g[0],m=g[1],k=[],Z=(0,l.Z)(v);try{for(Z.s();!(_=Z.n()).done;){var S=_.value,C=m[S]||0,x=[new Date(S),C&&["to_grid","to_battery"].includes(n)?-1*C:C];d&&(x[2]=x[0],x[0]=b(x[0])),k.push(x)}}catch(w){Z.e(w)}finally{Z.f()}h.push({id:"".concat(d?"compare-":"").concat(y,"-").concat(n),type:"bar",cursor:"default",name:n in s?s[n]:(0,E.Kd)(u.hass,y,t[y]),order:"used_solar"===n?1:"to_battery"===n?Object.keys(f).length:r+2,barMaxWidth:50,itemStyle:{borderColor:(0,O.H)(i,u.hass.themes.darkMode,!1,d,I[n],null===(a=o[n])||void 0===a?void 0:a[y])},color:(0,O.H)(i,u.hass.themes.darkMode,!0,d,I[n],null===(p=o[n])||void 0===p?void 0:p[y]),stack:d?"compare":"usage",data:k})})}),h}}]);var r}((0,D.f)(Z.oi));M.styles=(0,Z.iv)(s||(s=(0,f.Z)(["ha-card{height:100%}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.no-data{position:absolute;height:100%;top:0;left:0;right:0;display:flex;justify-content:center;align-items:center;padding:20%;margin-left:32px;margin-inline-start:32px;margin-inline-end:initial;box-sizing:border-box}"]))),(0,v.__decorate)([(0,S.Cb)({attribute:!1})],M.prototype,"hass",void 0),(0,v.__decorate)([(0,S.SB)()],M.prototype,"_config",void 0),(0,v.__decorate)([(0,S.SB)()],M.prototype,"_chartData",void 0),(0,v.__decorate)([(0,S.SB)()],M.prototype,"_start",void 0),(0,v.__decorate)([(0,S.SB)()],M.prototype,"_end",void 0),(0,v.__decorate)([(0,S.SB)()],M.prototype,"_compareStart",void 0),(0,v.__decorate)([(0,S.SB)()],M.prototype,"_compareEnd",void 0),M=(0,v.__decorate)([(0,S.Mo)("hui-energy-usage-graph-card")],M),a()}catch(R){a(R)}})},93859:function(e,t,r){r.d(t,{y:function(){return n}});var a=r(70323);function n(e){return(0,a.L)(e,Date.now())}},19627:function(e,t,r){r.d(t,{X:function(){return i}});var a=r(40246),n=r(87191),o=r(29426);function i(e,t,r){var i=(0,o._)(e,t)/n.yJ;return(0,a.u)(null==r?void 0:r.roundingMethod)(i)}},66386:function(e,t,r){r.d(t,{p:function(){return n}});var a=r(56858);function n(e){return(0,a.i)(Date.now(),e)}},31007:function(e,t,r){r.d(t,{K:function(){return i}});var a=r(10354),n=r(69875),o=r(46021);function i(e,t,r){var i=(0,n.d)(null==r?void 0:r.in,e,t),s=(0,a.Z)(i,2),c=s[0],u=s[1];return+(0,o.b)(c)===+(0,o.b)(u)}},63359:function(e,t,r){r.d(t,{z:function(){return i}});var a=r(70323),n=r(93859),o=r(31007);function i(e,t){return(0,o.K)((0,a.L)((null==t?void 0:t.in)||e,e),(0,n.y)((null==t?void 0:t.in)||e))}},26062:function(e,t,r){r.d(t,{I:function(){return n}});var a=r(46021);function n(e){return(0,a.b)(Date.now(),e)}}}]);
//# sourceMappingURL=72986.69858d73be95c1a7.js.map
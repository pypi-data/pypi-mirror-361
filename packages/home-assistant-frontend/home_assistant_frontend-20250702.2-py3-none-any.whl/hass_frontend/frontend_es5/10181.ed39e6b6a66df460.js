"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["10181"],{55815:function(t,e,n){n.d(e,{Eu:function(){return o},hZ:function(){return a},o9:function(){return c}});n(24819),n(54480);var i=n(28105),r=n(45657),s=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function o(t){return s[t%s.length]}function a(t,e){var n=e.getPropertyValue("--graph-color-".concat(t+1))||o(t);return(0,r.Rq)(n)}var c=(0,i.Z)(function(t){return s.map(function(e,n){return a(n,t)})},function(t,e){return t[0].getPropertyValue("--graph-color-1")===e[0].getPropertyValue("--graph-color-1")})},10388:function(t,e,n){n.a(t,async function(t,i){try{n.d(e,{c:function(){return y},computeStateDisplay:function(){return _}});n(39710),n(87799),n(56389);var r=n(16230),s=n(38763),o=n(93836),a=n(40142),c=n(74266),u=n(45691),d=n(28598),h=n(27417),f=n(44272),l=t([o,d,a,u,c]);[o,d,a,u,c]=l.then?(await l)():l;const _=(t,e,n,i,r,s,o)=>{const a=null==s?void 0:s[e.entity_id];return y(t,n,i,r,a,e.entity_id,e.attributes,void 0!==o?o:e.state)},y=(t,e,n,i,l,_,y,v)=>{if(v===r.lz||v===r.nZ)return t(`state.default.${v}`);const g=(0,f.M)(_),m="counter"===g||"number"===g||"input_number"===g;if((0,d.sJ)(y,"sensor"===g?n:[])||m){if("duration"===y.device_class&&y.unit_of_measurement&&o.a_.includes(y.unit_of_measurement))try{return(0,o.LU)(e,v,y.unit_of_measurement,null==l?void 0:l.display_precision)}catch(p){}if("monetary"===y.device_class)try{return(0,d.uf)(v,e,Object.assign({style:"currency",currency:y.unit_of_measurement,minimumFractionDigits:2},(0,d.l4)({state:v,attributes:y},l)))}catch(p){}const n=(0,d.uf)(v,e,(0,d.l4)({state:v,attributes:y},l)),i=(null==l?void 0:l.translation_key)&&t(`component.${l.platform}.entity.${g}.${l.translation_key}.unit_of_measurement`)||y.unit_of_measurement;return i?`${n}${(0,h.L)(i,e)}${i}`:n}if(["date","input_datetime","time"].includes(g))try{const t=v.split(" ");if(2===t.length)return(0,c.o0)(new Date(t.join("T")),Object.assign(Object.assign({},e),{},{time_zone:s.c_.local}),i);if(1===t.length){if(v.includes("-"))return(0,a.p6)(new Date(`${v}T00:00`),Object.assign(Object.assign({},e),{},{time_zone:s.c_.local}),i);if(v.includes(":")){const t=new Date;return(0,u.mr)(new Date(`${t.toISOString().split("T")[0]}T${v}`),Object.assign(Object.assign({},e),{},{time_zone:s.c_.local}),i)}}return v}catch(b){return v}if(["button","conversation","event","image","input_button","notify","scene","stt","tag","tts","wake_word","datetime"].includes(g)||"sensor"===g&&"timestamp"===y.device_class)try{return(0,c.o0)(new Date(v),e,i)}catch(p){return v}return(null==l?void 0:l.translation_key)&&t(`component.${l.platform}.entity.${g}.${l.translation_key}.state.${v}`)||y.device_class&&t(`component.${g}.entity_component.${y.device_class}.state.${v}`)||t(`component.${g}.entity_component._.state.${v}`)||v};i()}catch(_){i(_)}})},32483:function(t,e,n){n.d(e,{U:function(){return l}});n(26847),n(7175),n(54480),n(48694),n(27530);var i=n(55815),r=n(45657),s=n(66169),o=n(44272),a=n(87409),c=n(16230),u=n(17332),d={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};var h=0,f=new Map;function l(t,e,n){return function(t,e,n){var i;if(!n||t===c.nZ)return(0,u.g)("--history-unavailable-color",e);if(t===c.lz)return(0,u.g)("--history-unknown-color",e);var h=(0,a.tD)(n,t);if(h){var f=(0,u.g)(h,e);if(f){var l=(0,o.M)(n.entity_id),_=null===(i=d[l])||void 0===i?void 0:i[t];return _?(0,r.uO)((0,s.C)((0,r.Rw)((0,r.wK)(f)),_)):f}}}(t,e,n)||function(t,e){if(f.has(t))return f.get(t);var n=(0,i.hZ)(h,e);return h++,f.set(t,n),n}(t,e)}},7214:function(t,e,n){n.d(e,{Cj:function(){return l},F7:function(){return s},Hs:function(){return k},Kd:function(){return S},Kj:function(){return y},Nw:function(){return g},PA:function(){return o},Py:function(){return u},Qm:function(){return Z},Z0:function(){return b},_Y:function(){return h},_m:function(){return a},dL:function(){return d},dO:function(){return x},hN:function(){return _},h_:function(){return f},j2:function(){return w},q6:function(){return v},uR:function(){return c}});var i=n(75706),r=(n(39710),n(81738),n(72489),n(54480),n(56389),n(15459)),s=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({}),o=99387==n.j?["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"]:null,a=function(t){return t.sendMessagePromise({type:"recorder/info"})},c=function(t,e){return t.callWS({type:"recorder/list_statistic_ids",statistic_type:e})},u=function(t,e){return t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e})},d=function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"hour",s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==n?void 0:n.toISOString(),statistic_ids:i,period:r,units:s,types:o})},h=function(t,e,n,i){return t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:i,fixed_period:n.fixed_period?{start_time:n.fixed_period.start instanceof Date?n.fixed_period.start.toISOString():n.fixed_period.start,end_time:n.fixed_period.end instanceof Date?n.fixed_period.end.toISOString():n.fixed_period.end}:void 0,calendar:n.calendar,rolling_window:n.rolling_window})},f=function(t){return t.callWS({type:"recorder/validate_statistics"})},l=function(t,e,n){return t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:n})},_=function(t,e){return t.callWS({type:"recorder/clear_statistics",statistic_ids:e})},y=function(t){var e=null;if(!t)return null;var n,r=(0,i.Z)(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;null!==s.change&&void 0!==s.change&&(null===e?e=s.change:e+=s.change)}}catch(o){r.e(o)}finally{r.f()}return e},v=function(t,e){var n,r=null,s=(0,i.Z)(e);try{for(s.s();!(n=s.n()).done;){var o=n.value;if(o in t){var a=y(t[o]);null!==a&&(null===r?r=a:r+=a)}}}catch(c){s.e(c)}finally{s.f()}return r},g=function(t,e){return t.some(function(t){return void 0!==t[e]&&null!==t[e]})},m=["mean","min","max"],p=["sum","state","change"],b=function(t,e){return!(!m.includes(e)||0===t.mean_type)||!(!p.includes(e)||!t.has_sum)},w=function(t,e,n,i,r){var s=new Date(n).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:s,adjustment:i,adjustment_unit_of_measurement:r})},S=function(t,e,n){var i=t.states[e];return i?(0,r.C)(i):(null==n?void 0:n.name)||e},x=function(t,e,n){var i,r;e&&(i=null===(r=t.states[e])||void 0===r?void 0:r.attributes.unit_of_measurement);return void 0===i?null==n?void 0:n.statistics_unit_of_measurement:i},k=function(t){return t.includes(":")},Z=function(t){return t.callWS({type:"recorder/update_statistics_issues"})}},69782:function(t,e,n){n.a(t,async function(t,i){try{n.r(e),n.d(e,{DEFAULT_HOURS_TO_SHOW:function(){return T},HuiHistoryGraphCard:function(){return j}});var r,s,o,a,c,u=n(54982),d=n(29694),h=n(75778),f=n(54521),l=n(4490),_=n(20129),y=n(85297),v=n(53389),g=(n(40777),n(12212),n(26847),n(2394),n(81738),n(22960),n(87799),n(54480),n(1455),n(48694),n(67398),n(27530),n(73742)),m=n(59048),p=n(7616),b=n(31733),w=n(37528),S=n(96778),x=(n(12942),n(31138),n(5786),n(89166)),k=n(92523),Z=n(93647),I=n(55577),O=n(64637),H=n(7214),C=t([S,x]);[S,x]=C.then?(await C)():C;var T=24,j=function(t){function e(){var t;(0,f.Z)(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=(0,_.Z)(this,e,[].concat(i)))._names={},t._entityIds=[],t._hoursToShow=T,t}return(0,y.Z)(e,t),(0,l.Z)(e,[{key:"getCardSize",value:function(){var t,e;return null!==(t=this._config)&&void 0!==t&&t.title?2:0+2*((null===(e=this._entityIds)||void 0===e?void 0:e.length)||1)}},{key:"getGridOptions",value:function(){return{columns:12,min_columns:6,min_rows:2}}},{key:"setConfig",value:function(t){var e=this;if(!t.entities||!Array.isArray(t.entities))throw new Error("Entities need to be an array");if(!t.entities.length)throw new Error("You must include at least one entity");var n=t.entities?(0,I.A)(t.entities):[];this._entityIds=[],n.forEach(function(t){e._entityIds.push(t.entity),t.name&&(e._names[t.entity]=t.name)}),this._hoursToShow=t.hours_to_show||T,this._config=t}},{key:"connectedCallback",value:function(){(0,v.Z)(e,"connectedCallback",this,3)([]),this.hasUpdated&&this._subscribeHistory()}},{key:"disconnectedCallback",value:function(){(0,v.Z)(e,"disconnectedCallback",this,3)([]),this._unsubscribeHistory()}},{key:"_subscribeHistory",value:(g=(0,h.Z)((0,d.Z)().m(function t(){var e,n,i=this;return(0,d.Z)().w(function(t){for(;;)switch(t.n){case 0:if((0,w.p)(this.hass,"history")&&!this._subscribed){t.n=1;break}return t.a(2);case 1:return t.n=2,(0,k.ib)(this.hass);case 2:return e=t.v,n=e.numeric_device_classes,this._subscribed=(0,x.xS)(this.hass,function(t){var e;i._subscribed&&(i._stateHistory=(0,x.Nu)(i.hass,t,i._entityIds,i.hass.localize,n,null===(e=i._config)||void 0===e?void 0:e.split_device_classes),i._mergeHistory())},this._hoursToShow,this._entityIds).catch(function(t){i._subscribed=void 0,i._error=t}),t.n=3,this._fetchStatistics(n);case 3:this._setRedrawTimer();case 4:return t.a(2)}},t,this)})),function(){return g.apply(this,arguments)})},{key:"_mergeHistory",value:function(){var t;this._stateHistory&&(this._history=(0,x.V3)(this._stateHistory,this._statisticsHistory,null===(t=this._config)||void 0===t?void 0:t.split_device_classes))}},{key:"_fetchStatistics",value:(c=(0,h.Z)((0,d.Z)().m(function t(e){var n,i,r,s;return(0,d.Z)().w(function(t){for(;;)switch(t.n){case 0:return i=new Date,(r=new Date).setHours(r.getHours()-this._hoursToShow),t.n=1,(0,H.dL)(this.hass,r,i,this._entityIds,"hour",void 0,["mean","state"]);case 1:s=t.v,this._statisticsHistory=(0,x.YA)(this.hass,s,this._entityIds,e,null===(n=this._config)||void 0===n?void 0:n.split_device_classes),this._mergeHistory();case 2:return t.a(2)}},t,this)})),function(t){return c.apply(this,arguments)})},{key:"_redrawGraph",value:function(){this._history&&(this._history=Object.assign({},this._history))}},{key:"_setRedrawTimer",value:function(){var t=this;clearInterval(this._interval),this._interval=window.setInterval(function(){return t._redrawGraph()},6e4)}},{key:"_unsubscribeHistory",value:function(){clearInterval(this._interval),this._subscribed&&(this._subscribed.then(function(t){return null==t?void 0:t()}),this._subscribed=void 0)}},{key:"shouldUpdate",value:function(t){return(0,Z.Wh)(this,t)||t.size>1||!t.has("hass")}},{key:"updated",value:function(t){if((0,v.Z)(e,"updated",this,3)([t]),this._config&&this.hass&&this._hoursToShow&&this._entityIds.length&&(t.has("_config")||t.has("hass"))){var n=t.get("_config");!t.has("_config")||(null==n?void 0:n.entities)===this._config.entities&&(null==n?void 0:n.hours_to_show)===this._config.hours_to_show||(this._unsubscribeHistory(),this._subscribeHistory())}}},{key:"render",value:function(){var t,e,n,i;if(!this.hass||!this._config)return m.Ld;var c=new Date;c.setHours(c.getHours()-this._hoursToShow);var d="/history?".concat((0,O.ou)({entity_id:this._entityIds.join(","),start_date:c.toISOString()})),h=null!==(t=null===(e=this._config.grid_options)||void 0===e?void 0:e.columns)&&void 0!==t?t:12,f="number"==typeof h&&h<=12,l="number"==typeof(null===(n=this._config.grid_options)||void 0===n?void 0:n.rows);return(0,m.dy)(r||(r=(0,u.Z)([" <ha-card> ",' <div class="content ','"> '," </div> </ha-card> "])),this._config.title?(0,m.dy)(s||(s=(0,u.Z)([' <h1 class="card-header"> ',' <a href="','"><ha-icon-next></ha-icon-next></a> </h1> '])),this._config.title,d):m.Ld,(0,b.$)({"has-header":!!this._config.title,"has-rows":!(null===(i=this._config.grid_options)||void 0===i||!i.rows),"has-height":l}),this._error?(0,m.dy)(o||(o=(0,u.Z)([' <ha-alert alert-type="error"> ',": "," </ha-alert> "])),this.hass.localize("ui.components.history_charts.error"),this._error.message||this._error.code):(0,m.dy)(a||(a=(0,u.Z)([' <state-history-charts .hass="','" .isLoadingData="','" .historyData="','" .names="','" up-to-now .hoursToShow="','" .showNames="','" .logarithmicScale="','" .minYAxis="','" .maxYAxis="','" .fitYData="','" .height="','" .narrow="','" .expandLegend="','"></state-history-charts> '])),this.hass,!this._history,this._history,this._names,this._hoursToShow,void 0===this._config.show_names||this._config.show_names,this._config.logarithmic_scale||!1,this._config.min_y_axis,this._config.max_y_axis,this._config.fit_y_data||!1,l?"100%":void 0,f,this._config.expand_legend))}}],[{key:"getConfigElement",value:(i=(0,h.Z)((0,d.Z)().m(function t(){return(0,d.Z)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Promise.all([n.e("73614"),n.e("15601"),n.e("15634"),n.e("26452"),n.e("16376"),n.e("2769"),n.e("19596"),n.e("44162")]).then(n.bind(n,23374));case 1:return t.a(2,document.createElement("hui-history-graph-card-editor"))}},t)})),function(){return i.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{type:"history-graph",entities:["sun.sun"]}}}]);var i,c,g}(m.oi);j.styles=(0,m.iv)(c||(c=(0,u.Z)(["ha-card{display:flex;flex-direction:column;height:100%}.card-header{justify-content:space-between;display:flex;padding-bottom:0}.card-header ha-icon-next{--mdc-icon-button-size:24px;line-height:24px;color:var(--primary-text-color)}.content{padding:0 16px 8px;flex:1;overflow:hidden}.has-header{padding-top:0}state-history-charts{--timeline-top-margin:16px}.has-height state-history-charts{height:100%}.has-rows{--chart-max-height:100%}"]))),(0,g.__decorate)([(0,p.Cb)({attribute:!1})],j.prototype,"hass",void 0),(0,g.__decorate)([(0,p.SB)()],j.prototype,"_history",void 0),(0,g.__decorate)([(0,p.SB)()],j.prototype,"_statisticsHistory",void 0),(0,g.__decorate)([(0,p.SB)()],j.prototype,"_config",void 0),(0,g.__decorate)([(0,p.SB)()],j.prototype,"_error",void 0),j=(0,g.__decorate)([(0,p.Mo)("hui-history-graph-card")],j),i()}catch($){i($)}})},4957:function(t){var e=Math.log,n=Math.LOG10E;t.exports=Math.log10||function(t){return e(t)*n}},8942:function(t,e,n){var i=n(30456).isFinite;t.exports=Number.isFinite||function(t){return"number"==typeof t&&i(t)}},27427:function(t,e,n){n(77341)({target:"Math",stat:!0},{log10:n(4957)})},60515:function(t,e,n){n(77341)({target:"Number",stat:!0},{isFinite:n(8942)})},77451:function(t,e,n){var i=n(77341),r=n(30456),s=n(42749),o=n(61360),a=TypeError,c=Object.defineProperty,u=r.self!==r;try{if(o){var d=Object.getOwnPropertyDescriptor(r,"self");!u&&d&&d.get&&d.enumerable||s(r,"self",{get:function(){return r},set:function(t){if(this!==r)throw new a("Illegal invocation");c(r,"self",{value:t,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else i({global:!0,simple:!0,forced:u},{self:r})}catch(h){}},29426:function(t,e,n){n.d(e,{_:function(){return r}});var i=n(1097);function r(t,e){return+(0,i.Q)(t)-+(0,i.Q)(e)}},19627:function(t,e,n){n.d(e,{X:function(){return o}});var i=n(40246),r=n(87191),s=n(29426);function o(t,e,n){var o=(0,s._)(t,e)/r.yJ;return(0,i.u)(null==n?void 0:n.roundingMethod)(o)}}}]);
//# sourceMappingURL=10181.ed39e6b6a66df460.js.map
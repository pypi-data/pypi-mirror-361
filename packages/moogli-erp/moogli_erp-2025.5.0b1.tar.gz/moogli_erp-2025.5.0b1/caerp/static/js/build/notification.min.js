(()=>{"use strict";var t,n,e,o={7511:(t,n,e)=>{var o=e(750),i=e(641),r=e(953),a=e(33),c=e(3115),l=e(810),u=e(296),s=e(467),f=e(4756),p=e.n(f),d=e(9596);function v(t,n){return{markRead:(o=(0,s.A)(p().mark(function t(n){var e;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,d.A.notifications.markRead(n);case 1:this.collection=this.collection.filter(function(t){return t.id!==n.id}),this.collectionMetaData.total_entries-=1,t.next=3;break;case 2:throw t.prev=2,e=t.catch(0),new Error(e);case 3:case"end":return t.stop()}},t,this,[[0,2]])})),function(t){return o.apply(this,arguments)}),postPone:(e=(0,s.A)(p().mark(function t(n){var e;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,d.A.notifications.postPone(n);case 1:this.collection=this.collection.filter(function(t){return t.id!==n.id}),this.collectionMetaData.total_entries-=1,t.next=3;break;case 2:throw t.prev=2,e=t.catch(0),new Error(e);case 3:case"end":return t.stop()}},t,this,[[0,2]])})),function(t){return e.apply(this,arguments)}),handleError:function(t){var n=this;return(0,s.A)(p().mark(function e(){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.loading=!1,n.error=t,e.abrupt("return",t);case 1:case"end":return e.stop()}},e)}))()},loadChannel:function(){var t=arguments,e=this;return(0,s.A)(p().mark(function o(){var i,r,a,c;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=t.length>0&&void 0!==t[0]?t[0]:5,console.log("Calling loadChannel"),e.loading=!0,o.prev=1,o.next=2,d.A.notifications.loadCollection({fields:["title","body"],related:[],pageOptions:{items_per_page:i,page:0},filters:{channel:n}});case 2:r=o.sent,a=(0,u.A)(r,2),e.collectionMetaData=a[0],e.collection=a[1],e.loading=!1,e.error="",o.next=4;break;case 3:throw o.prev=3,c=o.catch(1),new Error(c);case 4:case"end":return o.stop()}},o,null,[[1,3]])}))()}};var e,o}var m=function(t,n){return(0,l.nY)(t,{state:function(){return{loading:!0,error:!1,collection:[],collectionMetaData:{total_entries:0}}},actions:v(0,n),getters:{notificationCount:function(t){return t.collectionMetaData.total_entries}}})},k=m("notification-message","message"),h=m("notification-header_message","header_message"),b=m("notification-alert","alert"),_=e(7546),g=e(5979),y=["innerHTML"],C=["innerHTML"];const M={__name:"Notification",props:{notification:Object},emits:["mark_read","postpone"],setup:function(t,n){var e=n.emit,o=t,c=e,l={success:"check",valid:"check-circle",error:"exclamation-triangle",invalid:"times-circle",caution:"exclamation-triangle",neutral:"info-circle",calendar:"calendar-alt"}[o.notification.status_type]||"info-circle",u={success:"success",valid:"success",error:"invalid",caution:"caution",neutral:"neutral",calendar:"neutral"}[o.notification.status_type]||"neutral",s=function(){c("postpone",o.notification)},f=function(){c("mark_read",o.notification)};return function(n,e){return(0,i.uX)(),(0,i.CE)("li",{"aria-hidden":"false",class:(0,a.C4)((0,r.R1)(u))},[(0,i.bF)(g.A,{name:(0,r.R1)(l),alt:""},null,8,["name"]),(0,i.Lk)("div",null,[(0,i.Lk)("h4",{class:"text",innerHTML:t.notification.title},null,8,y),(0,i.Lk)("div",{class:"text",innerHTML:t.notification.body},null,8,C)]),(0,i.Lk)("button",{class:"icon unstyled close",title:"Fermer cette notification","aria-label":"Fermer cette notification",onClick:f},[(0,i.bF)(_.A,{name:"times"})]),(0,i.Lk)("button",{class:"icon unstyled repeat",title:"Répéter cette notification dans 7 jours","aria-label":"Répéter cette notification dans 7 jours",onClick:s},[(0,i.bF)(_.A,{name:"clock"})])],2)}}};var w={class:"notifications"},L={key:0,class:"text_more"};const A={__name:"NotificationList",props:{notifications:Array,notificationCount:Number},emits:["showAll","mark_read","postpone"],setup:function(t,n){var e=n.emit,o=t,c=e,l=Math.max(o.notificationCount-5,0),u="... et ".concat(l," autres notifications"),s=function(){return c("showAll"),!1};return function(n,e){return(0,i.uX)(),(0,i.CE)("ul",w,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.notifications.slice(0,(0,r.R1)(5)),function(t){return(0,i.uX)(),(0,i.Wv)(M,{key:t.id,notification:t,onMark_read:function(t){return n.$emit("mark_read",t)},onPostpone:function(t){return n.$emit("postpone",t)}},null,8,["notification","onMark_read","onPostpone"])}),128)),(0,r.R1)(l)?((0,i.uX)(),(0,i.CE)("li",L,[(0,i.Lk)("div",null,[(0,i.Lk)("small",null,(0,a.v_)(u)),e[0]||(e[0]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("a",{href:"javascript:void(0);",onClick:s},"Voir toutes les notifications")])])):(0,i.Q3)("v-if",!0)])}}};var R=e(5796),P={class:"notifications"};const x={__name:"NotificationModal",emits:["close","mark_read","postpone"],setup:function(t,n){return(0,s.A)(p().mark(function t(){var e,o,s,f,d,v,m,h,b,_,g,y;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.emit,v=s,m=k(),(h=(0,l.bP)(m)).collectionMetaData,b=h.collection,_=(0,r.KR)(null),(0,c.X2F)(_,function(t){v("close")}),g=function(t){v("mark_read",t)},y=function(t){v("postpone",t)},e=(0,i.E)(function(){return m.loadChannel(1e3)}),o=(0,u.A)(e,2),f=o[0],d=o[1],t.next=1,f;case 1:return d(),t.abrupt("return",function(t,n){return(0,i.uX)(),(0,i.Wv)(R.A,{onClose:n[1]||(n[1]=function(n){return t.$emit("close")}),ref_key:"modalTarget",ref:_},{header:(0,i.k6)(function(){return[(0,i.eW)((0,a.v_)((0,r.R1)(b).length)+" Notifications",1)]}),body:(0,i.k6)(function(){return[(0,i.Lk)("ul",P,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,r.R1)(b),function(t){return(0,i.uX)(),(0,i.Wv)(M,{key:t.id,notification:t,onMark_read:function(){return g(t)},onPostpone:function(){return y(t)}},null,8,["notification","onMark_read","onPostpone"])}),128))])]}),footer:(0,i.k6)(function(){return[(0,i.Lk)("button",{type:"button",onClick:n[0]||(n[0]=function(n){return t.$emit("close")}),title:"Fermer cette fenêtre","aria-label":"Fermer cette fenêtre"}," Fermer ")]}),_:1},512)});case 2:case"end":return t.stop()}},t)}))()}};var O={class:"notification_counter"},j=["title","aria-label","disabled"],F={key:0,class:"bubble"};const E={__name:"NotificationListComponent",setup:function(t){var n=k(),e=(0,l.bP)(n),o=(e.collectionMetaData,e.collection),u=n.loadChannel,s=n.markRead,f=n.postPone,p=(0,i.EW)(function(){return o.value?"Afficher ".concat(o.value.length," notifications"):"Aucune notification"}),d=(0,r.KR)(!1),v=(0,r.KR)(!1);function m(){d.value=!d.value}function h(){console.log("Showing the popup with all notifications"),v.value=!0,d.value=!1}function b(){v.value=!1,d.value=!1}var g=(0,r.KR)(null);(0,c.X2F)(g,function(t){d&&(v.value||(d.value=!1))});var y=function(t){s(t)},C=function(t){f(t)};return u(5),function(t,e){return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",O,[((0,i.uX)(),(0,i.CE)("button",{class:"icon unstyled",title:(0,r.R1)(p),"aria-label":(0,r.R1)(p),onClick:m,disabled:!(0,r.R1)(n).notificationCount,key:(0,r.R1)(n).notificationCount},[(0,i.bF)(_.A,{name:"bell"}),(0,r.R1)(n).notificationCount>0?((0,i.uX)(),(0,i.CE)("span",F,(0,a.v_)((0,r.R1)(n).notificationCount),1)):(0,i.Q3)("v-if",!0)],8,j))]),d.value?((0,i.uX)(),(0,i.Wv)(A,{key:0,notifications:(0,r.R1)(o),notificationCount:(0,r.R1)(n).notificationCount,onShowAll:h,onMark_read:y,onPostpone:C,ref_key:"dropDownTarget",ref:g},null,8,["notifications","notificationCount"])):(0,i.Q3)("v-if",!0),v.value?((0,i.uX)(),(0,i.Wv)(x,{key:1,ref:"alertTarget",onClose:b,onMark_read:y,onPostpone:C},null,512)):(0,i.Q3)("v-if",!0)],64)}}},X={__name:"MessageApp",setup:function(t){return function(t,n){return(0,i.uX)(),(0,i.Wv)(i.tY,null,{fallback:(0,i.k6)(function(){return n[0]||(n[0]=[(0,i.eW)(" Chargement... ")])}),default:(0,i.k6)(function(){return[(0,i.bF)(E)]}),_:1})}}};var T=["innerHTML"],W=["innerHTML"];const D={__name:"NotificationModal",props:{notification:Object},emits:["postpone","mark_read"],setup:function(t,n){return n.emit,function(n,e){return(0,i.uX)(),(0,i.Wv)(R.A,{onClose:e[2]||(e[2]=function(e){return n.$emit("mark_read",t.notification)})},{header:(0,i.k6)(function(){return[(0,i.Lk)("span",{innerHTML:t.notification.title},null,8,T)]}),body:(0,i.k6)(function(){return[(0,i.Lk)("span",{innerHTML:t.notification.body},null,8,W)]}),footer:(0,i.k6)(function(){return[(0,i.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=function(e){return n.$emit("mark_read",t.notification)}),title:"Fermer cette fenêtre","aria-label":"Fermer cette fenêtre"}," Fermer "),(0,i.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:e[1]||(e[1]=function(e){return n.$emit("postpone",t.notification)}),title:"Me le rappeler plus tard","aria-label":"Me le rappeler plus tard"}," Plus tard ")]}),_:1})}}},S={__name:"AlertApp",setup:function(t){var n=b(),e=(0,l.bP)(n),o=e.collectionMetaData,a=e.collection,c=function(t){n.markRead(t).then(function(){return n.loadChannel(1)})},u=function(t){n.postPone(t).then(function(){return n.loadChannel(1)})};return n.loadChannel(1),function(t,n){return(0,r.R1)(o).total_entries?((0,i.uX)(),(0,i.Wv)(D,{key:0,notification:(0,r.R1)(a)[0],onMark_read:c,onPostpone:u},null,8,["notification"])):(0,i.Q3)("v-if",!0)}}};var N={class:"notification"},$={class:"alert alert-warning align_center"};const H={__name:"Notification",props:{notification:Object},emits:["mark_read"],setup:function(t,n){n.emit;var e=t,o=e.notification.title+"<br />"+e.notification.body;return function(n,e){return(0,i.uX)(),(0,i.CE)("div",N,[(0,i.Lk)("div",$,[(0,i.bF)(g.A,{name:"exclamation-triangle",alt:"Attention : "}),(0,i.Lk)("div",null,[(0,i.Lk)("strong",{innerHTML:o})]),(0,i.Lk)("button",{type:"button",class:"icon only unstyled close",title:"Masquer ce message","aria-label":"Masquer ce message",onClick:e[0]||(e[0]=function(e){return n.$emit("mark_read",t.notification)})},[(0,i.bF)(_.A,{name:"times"})])])])}}},K={__name:"HeaderMessageApp",setup:function(t){var n=h(),e=(0,l.bP)(n),o=e.collectionMetaData,a=e.collection,c=function(t){n.markRead(t).then(function(){return n.loadChannel(1)})};n.loadChannel(1);var u=(0,i.EW)(function(){return a.value[0]});return function(t,n){return(0,r.R1)(o).total_entries&&!t.loading?((0,i.uX)(),(0,i.Wv)(H,{key:0,notification:u.value,onMark_read:c},null,8,["notification"])):(0,i.Q3)("v-if",!0)}}};(0,o.Yk)(X,"vue-notification-message-app"),(0,o.Yk)(S,"vue-notification-alert-app"),(0,o.Yk)(K,"vue-notification-header_message-app")}},i={};function r(t){var n=i[t];if(void 0!==n)return n.exports;var e=i[t]={id:t,loaded:!1,exports:{}};return o[t].call(e.exports,e,e.exports,r),e.loaded=!0,e.exports}r.m=o,t=[],r.O=(n,e,o,i)=>{if(!e){var a=1/0;for(s=0;s<t.length;s++){for(var[e,o,i]=t[s],c=!0,l=0;l<e.length;l++)(!1&i||a>=i)&&Object.keys(r.O).every(t=>r.O[t](e[l]))?e.splice(l--,1):(c=!1,i<a&&(a=i));if(c){t.splice(s--,1);var u=o();void 0!==u&&(n=u)}}return n}i=i||0;for(var s=t.length;s>0&&t[s-1][2]>i;s--)t[s]=t[s-1];t[s]=[e,o,i]},r.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return r.d(n,{a:n}),n},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(t,o){if(1&o&&(t=this(t)),8&o)return t;if("object"==typeof t&&t){if(4&o&&t.__esModule)return t;if(16&o&&"function"==typeof t.then)return t}var i=Object.create(null);r.r(i);var a={};n=n||[null,e({}),e([]),e(e)];for(var c=2&o&&t;"object"==typeof c&&!~n.indexOf(c);c=e(c))Object.getOwnPropertyNames(c).forEach(n=>a[n]=()=>t[n]);return a.default=()=>t,r.d(i,a),i},r.d=(t,n)=>{for(var e in n)r.o(n,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},r.e=()=>Promise.resolve(),r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),r.j=602,(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var n=r.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var e=n.getElementsByTagName("script");if(e.length)for(var o=e.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=e[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{var t={602:0};r.O.j=n=>0===t[n];var n=(n,e)=>{var o,i,[a,c,l]=e,u=0;if(a.some(n=>0!==t[n])){for(o in c)r.o(c,o)&&(r.m[o]=c[o]);if(l)var s=l(r)}for(n&&n(e);u<a.length;u++)i=a[u],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(s)},e=self.webpackChunkenDI=self.webpackChunkenDI||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))})(),r.nc=void 0;var a=r.O(void 0,[534],()=>r(7511));a=r.O(a)})();
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6050],{91747:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/datastore-connection/new",function(){return n(7936)}])},19904:function(e,t,n){"use strict";n.d(t,{Tg:function(){return a}});var i=n(24246),l=n(16134),r=n(31793);let a=e=>(0,l.C)(r.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:n}=e;return a(t)?(0,i.jsx)(i.Fragment,{children:n}):null}},96718:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var i=n(24246),l=n(86920);let r=e=>{let{...t}=e,n="multiple"===t.mode;return(0,i.jsx)(l.WPr,{defaultActiveFirstOption:!1,maxTagCount:"responsive",allowClear:!0,dropdownStyle:n?void 0:{width:"auto",minWidth:"200px"},className:"w-auto","data-testid":"filter-select",...t})}},44553:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var i=n(24246),l=n(86920),r=n(27378),a=n(45277),s=n(16125),o=n(812),c=n(46628),d=n(20682),u=n(54427),p=n(52253),x=n(78780);let{reducer:h}=(0,u.oM)({name:"connectorTemplate",initialState:{},reducers:{}}),{useRegisterConnectorTemplateMutation:f}=x.u.injectEndpoints({endpoints:e=>({registerConnectorTemplate:e.mutation({query:e=>{let t=new FormData;return t.append("file",e),{url:"".concat(p.o4,"/register"),method:"POST",body:t}},invalidatesTags:()=>["Connection Type"]})})});var m=e=>{let{isOpen:t,onClose:n,testId:u="connector-template-modal"}=e,p=(0,s.I0)(),[x,h]=(0,r.useState)(null),m=(0,l.pmc)(),{getRootProps:y,getInputProps:j,isDragActive:g}=(0,a.uI)({onDrop:e=>{var t;if("zip"!==(null===(t=e[0].name.split(".").pop())||void 0===t?void 0:t.toLowerCase())){m((0,c.Vo)("Only zip files are allowed."));return}h(e[0])}}),[v,{isLoading:C}]=f(),{refetch:b}=(0,d.$I)({search:""},{skip:!1}),w=async()=>{if(x)try{var e;await v(x).unwrap(),m((0,c.t5)("Integration template uploaded successfully."));let{data:t}=await b();p((0,d.fP)(null!==(e=null==t?void 0:t.items)&&void 0!==e?e:[])),n()}catch(e){m((0,c.Vo)((0,o.e$)(e)))}finally{h(null)}};return(0,i.jsxs)(l.u_l,{isOpen:t,onClose:n,size:"2xl",children:[(0,i.jsx)(l.ZAr,{}),(0,i.jsxs)(l.hzk,{textAlign:"left",p:2,"data-testid":u,children:[(0,i.jsx)(l.xBx,{children:"Upload integration template"}),(0,i.jsxs)(l.fef,{children:[(0,i.jsx)(l.xvT,{fontSize:"sm",mb:4,children:"Drag and drop your integration template zip file here, or click to browse your files."}),(0,i.jsxs)(l.xuv,{...y(),bg:g?"gray.100":"gray.50",border:"2px dashed",borderColor:g?"gray.300":"gray.200",borderRadius:"md",cursor:"pointer",minHeight:"150px",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",children:[(0,i.jsx)("input",{...j()}),x?(0,i.jsx)(l.xvT,{children:x.name}):g?(0,i.jsx)(l.xvT,{children:"Drop the file here..."}):(0,i.jsx)(l.xvT,{children:"Click or drag and drop your file here."})]}),(0,i.jsx)(l.xvT,{fontSize:"sm",mt:4,children:"An integration template zip file must include a SaaS config and dataset, but may also contain an icon (.svg) as an optional file."})]}),(0,i.jsxs)(l.mzw,{className:"flex w-full justify-end gap-2",children:[(0,i.jsx)(l.wpx,{onClick:n,"data-testid":"cancel-btn",disabled:C,children:"Cancel"}),(0,i.jsx)(l.wpx,{type:"primary",htmlType:"submit",disabled:!x||C,onClick:w,"data-testid":"submit-btn",children:"Submit"})]})]})]})}},7936:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return R}});var i=n(24246),l=n(96356),r=n(41337),a=n(86920),s=n(86677),o=n(27378),c=n(16125),d=n(16134),u=n(77830),p=n(58754),x=n(16394),h=n(19904),f=n(44553),m=n(68309),y=n(96718),j=n(26788),g=()=>{let e=(0,c.I0)(),t=(0,o.useRef)(!1);(0,o.useEffect)(()=>(t.current=!0,()=>{e((0,l.zq)(j.gA)),t.current=!1}),[e]);let n=(0,o.useRef)([...j.yI].map(e=>{let[t,n]=e;return{value:null==n?void 0:n.value,label:t}}));return(0,i.jsx)(y.z,{allowClear:!1,options:n.current,onChange:t=>{e((0,l.zq)(t||j.gA))},defaultValue:"","data-testid":"connection-type-filter"})},v=n(79894),C=n.n(v),b=e=>{let{items:t}=e;return(0,i.jsx)(a.MIq,{columns:4,spacingX:"16px",spacingY:"16px",children:t.map(e=>(0,i.jsx)(C(),{href:{pathname:window.location.pathname,query:{step:2,connectorType:JSON.stringify(e)}},children:(0,i.jsx)(a.xuv,{boxShadow:"base",borderRadius:"5px",maxWidth:"331px",overflow:"hidden",_hover:{boxShadow:"lg",cursor:"pointer"},"data-testid":"".concat(e.identifier,"-item"),children:(0,i.jsxs)(a.kCb,{alignItems:"center",justifyContent:"start",pl:"24px",pr:"24px",color:"gray.700",fontSize:"14px",fontStyle:"normal",fontWeight:"600",lineHeight:"20px",h:"80px",children:[(0,i.jsx)(r.Z,{data:e}),(0,i.jsx)(a.xvT,{ml:"12px",children:e.human_readable})]})})},e.identifier))})},w=()=>{let e=(0,c.I0)(),t=(0,o.useRef)(!1),{step:n}=(0,d.C)(l.ZZ),r=(0,d.C)(l.pw),{data:s,isFetching:u,isLoading:p,isSuccess:y}=(0,l.$I)(r),[j,v]=(0,o.useState)(!1),C=(0,o.useCallback)(t=>{(0===t.target.value.length||t.target.value.length>1)&&e((0,l.qP)(t.target.value))},[e]),w=(0,o.useMemo)(()=>(0,x.Ds)(C,250),[C]),T=(0,o.useMemo)(()=>(null==s?void 0:s.items)&&[...s.items].sort((e,t)=>e.human_readable>t.human_readable?1:-1),[s]);return(0,o.useEffect)(()=>(t.current=!0,()=>{e((0,l.qP)("")),t.current=!1}),[e]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.kCb,{minWidth:"fit-content",children:(0,i.jsx)(a.xuv,{color:"gray.700",fontSize:"14px",maxHeight:"80px",maxWidth:"474px",mb:"24px",children:n.description})}),(0,i.jsxs)(a.kCb,{alignItems:"center",gap:"4",mb:"24px",minWidth:"fit-content",children:[(0,i.jsx)(g,{}),(0,i.jsxs)(a.BZy,{size:"sm",children:[(0,i.jsx)(a.Z8_,{pointerEvents:"none",children:(0,i.jsx)(a.PTu,{color:"gray.300",h:"17px",w:"17px"})}),(0,i.jsx)(a.IIB,{autoComplete:"off",autoFocus:!0,borderRadius:"md",name:"search",onChange:w,placeholder:"Search integrations",size:"sm",type:"search"})]}),(0,i.jsx)(h.ZP,{scopes:[m.Sh.CONNECTOR_TEMPLATE_REGISTER],children:(0,i.jsx)(a.wpx,{onClick:()=>{v(!0)},type:"primary",htmlType:"submit","data-testid":"upload-btn",children:"Upload connector"})})]}),(0,i.jsx)(f.Z,{isOpen:j,onClose:()=>v(!1)}),(u||p)&&(0,i.jsx)(a.M5Y,{children:(0,i.jsx)(a.$jN,{})}),y&&T?(0,i.jsx)(b,{items:T}):null]})},T=n(7617),S=n(11274),I=n(38212),k=n(50881),N=()=>{let e=(0,c.I0)(),t=(0,o.useRef)(!1),[n,r]=(0,o.useState)(!1),{connection:s,connectionOption:u}=(0,d.C)(l.ZZ),p=j.IM.find(e=>e.type===(null==u?void 0:u.type)),[x,h]=(0,o.useState)(null==p?void 0:p.options[0]),f=()=>{r(!0)},y=(0,o.useMemo)(()=>()=>{let e=[];return(null==p?void 0:p.options)&&p.options.forEach(t=>{let n;switch(t){case j.H5.CONNECTOR_PARAMETERS:n={label:t,content:(0,i.jsx)(S.s,{onConnectionCreated:f})};break;case j.H5.DATASET_CONFIGURATION:n=(null==s?void 0:s.key)?{label:t,content:(0,i.jsx)(I.Z,{})}:void 0;break;case j.H5.DSR_CUSTOMIZATION:n=(null==s?void 0:s.key)?{label:t,content:(0,i.jsx)(k.Z,{})}:void 0}n&&e.push(n)}),e},[null==s?void 0:s.key,null==p?void 0:p.options]),g=(0,o.useCallback)(t=>{switch(t){case j.H5.DATASET_CONFIGURATION:case j.H5.DSR_CUSTOMIZATION:e((0,l.nj)(j.Ss[3]));break;case j.H5.CONNECTOR_PARAMETERS:default:e((0,l.nj)(j.Ss[2]))}h(t)},[e]);return(0,o.useEffect)(()=>(t.current=!0,()=>{t.current=!1,e((0,l.mc)())}),[e]),(0,o.useEffect)(()=>{(null==s?void 0:s.key)&&(g((null==u?void 0:u.type)!==m.Zi.MANUAL?j.H5.DATASET_CONFIGURATION:j.H5.DSR_CUSTOMIZATION),n&&r(!1))},[n,null==s?void 0:s.key,null==u?void 0:u.type,null==p?void 0:p.options,g]),(0,i.jsx)(a.gCW,{alignItems:"stretch",gap:"18px",children:(0,i.jsx)(T.Z,{data:y(),flexGrow:1,index:null==p?void 0:p.options.findIndex(e=>e===x),isLazy:!0})})};let _=(e,t)=>{let n="".concat(window.location.origin+t,"&key=").concat(e);window.location.href.toLowerCase()!==n.toLowerCase()&&window.history.replaceState(null,"",n)},{Title:A}=a.AntTypography;var E=()=>{let e=(0,c.I0)(),t=(0,s.useRouter)(),{connectorType:n,step:x}=t.query,{connection:h,connectionOption:f,step:m}=(0,d.C)(l.ZZ);(0,o.useEffect)(()=>{if(n&&e((0,l.yA)(JSON.parse(n))),t.query.step){let t=j.Ss.find(e=>e.stepId===Number(x));e((0,l.nj)(t||j.Ss[1]))}return!t.query.id&&(null==h?void 0:h.key)&&_(h.key,m.href),()=>{}},[null==h?void 0:h.key,n,x,e,t.query.id,t.query.step,m.href]);let y=(0,o.useCallback)(e=>{let t="";switch(e.stepId){case 2:case 3:t=e.label.replace("{identifier}",f.human_readable);break;default:t=e.label}return t},[f]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.Z,{heading:"Connections",breadcrumbItems:[{title:"Unlinked connections",href:u.JR},{title:"New connection"}],children:(0,i.jsx)(A,{level:3,style:{marginBottom:0},className:"mt-4",children:f?(0,i.jsxs)(a.vyj,{children:[(0,i.jsx)(r.Z,{data:f}),y(m)]}):y(m)})}),(()=>{switch(m.stepId){case 1:default:return(0,i.jsx)(w,{});case 2:case 3:return(0,i.jsx)(N,{})}})()]})},O=n(1226),R=()=>(0,i.jsx)(O.Z,{children:(0,i.jsx)(E,{})})}},function(e){e.O(0,[2858,699,6527,5277,1807,5574,9767,2888,9774,179],function(){return e(e.s=91747)}),_N_E=e.O()}]);
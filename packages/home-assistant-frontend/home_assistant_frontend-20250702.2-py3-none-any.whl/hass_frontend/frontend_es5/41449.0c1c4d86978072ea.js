"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["41449"],{68135:function(e,n,a){a.a(e,async function(e,t){try{a.d(n,{G:function(){return c}});var o=a(62229),r=a(28105),i=a(43890),l=e([o,i]);[o,i]=l.then?(await l)():l;var s=(0,r.Z)(function(e){return new Intl.RelativeTimeFormat(e.language,{numeric:"auto"})}),c=function(e,n,a){var t=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=(0,i.W)(e,a,n);return t?s(n).format(o.value,o.unit):Intl.NumberFormat(n.language,{style:"unit",unit:o.unit,unitDisplay:"long"}).format(Math.abs(o.value))};t()}catch(u){t(u)}})},43890:function(e,n,a){a.a(e,async function(e,t){try{a.d(n,{W:function(){return g}});a(87799);var o=a(7722),r=a(66233),i=a(58104),l=a(34302),s=e([l]);l=(s.then?(await s)():s)[0];var c=1e3,u=60,d=60*u;function g(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),a=arguments.length>2?arguments[2]:void 0,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=Object.assign(Object.assign({},h),t||{}),p=(+e-+n)/c;if(Math.abs(p)<s.second)return{value:Math.round(p),unit:"second"};var g=p/u;if(Math.abs(g)<s.minute)return{value:Math.round(g),unit:"minute"};var f=p/d;if(Math.abs(f)<s.hour)return{value:Math.round(f),unit:"hour"};var _=new Date(e),v=new Date(n);_.setHours(0,0,0,0),v.setHours(0,0,0,0);var y=(0,o.j)(_,v);if(0===y)return{value:Math.round(f),unit:"hour"};if(Math.abs(y)<s.day)return{value:y,unit:"day"};var m=(0,l.Bt)(a),w=(0,r.z)(_,{weekStartsOn:m}),b=(0,r.z)(v,{weekStartsOn:m}),k=(0,i.p)(w,b);if(0===k)return{value:y,unit:"day"};if(Math.abs(k)<s.week)return{value:k,unit:"week"};var P=_.getFullYear()-v.getFullYear(),z=12*P+_.getMonth()-v.getMonth();return 0===z?{value:k,unit:"week"}:Math.abs(z)<s.month||0===P?{value:z,unit:"month"}:{value:Math.round(P),unit:"year"}}var h={second:45,minute:45,hour:22,day:5,week:4,month:11};t()}catch(p){t(p)}})},40645:function(e,n,a){a.d(n,{P:function(){return t}});var t=function(e,n){var a,t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=0,i=function(){for(var i=arguments.length,l=new Array(i),s=0;s<i;s++)l[s]=arguments[s];var c=Date.now();r||!1!==t||(r=c);var u=n-(c-r);u<=0||u>n?(a&&(clearTimeout(a),a=void 0),r=c,e.apply(void 0,l)):a||!1===o||(a=window.setTimeout(function(){r=!1===t?0:Date.now(),a=void 0,e.apply(void 0,l)},u))};return i.cancel=function(){clearTimeout(a),a=void 0,r=0},i}},11799:function(e,n,a){a.d(n,{F:function(){return o}});a(26847),a(87799),a(54480),a(1455),a(48694),a(27530);var t=a(39884),o=function(e,n){return new Promise(function(o){var r=n.closeDialog,i=n.logInHereAction;(0,t.B)(e,"show-dialog",{dialogTag:"dialog-cloud-already-connected",dialogImport:function(){return Promise.all([a.e("75696"),a.e("76782"),a.e("10207")]).then(a.bind(a,44447))},dialogParams:Object.assign(Object.assign({},n),{},{closeDialog:function(){null==r||r(),o(!1)},logInHereAction:function(){null==i||i(),o(!0)}})})})}},25874:function(e,n,a){a.a(e,async function(e,n){try{var t,o,r,i,l=a(54982),s=a(29694),c=a(75778),u=a(54521),d=a(4490),h=a(67063),p=a(20129),g=a(85297),f=(a(40777),a(12212),a(87799),a(24533),a(64510),a(73742)),_=a(59048),v=a(7616),y=a(39884),m=a(78206),w=(a(12942),a(31138),a(72953),a(56161),a(37492),a(95814)),b=a(31307),k=a(60164),P=a(9565),z=a(11799),Z=a(52668),F=e([m,k]);[m,k]=F.then?(await F)():F;var C=function(e){function n(){var e;(0,u.Z)(this,n);for(var a=arguments.length,t=new Array(a),o=0;o<a;o++)t[o]=arguments[o];return(e=(0,p.Z)(this,n,[].concat(t))).checkConnection=!1,e.translationKeyPanel="config.cloud",e.cardLess=!1,e._inProgress=!1,e._handleCloudLoginError=function(){var n=(0,c.Z)((0,s.Z)().m(function n(a,t,o,r){var i,l,c,u;return(0,s.Z)().w(function(n){for(;;)switch(n.n){case 0:if("mfarequired"!==(i=a&&a.body&&a.body.code)){n.n=2;break}return n.n=1,(0,k.showPromptDialog)((0,h.Z)(e),{title:e.localize("ui.panel.".concat(e.translationKeyPanel,".login.totp_code_prompt_title")),inputLabel:e.localize("ui.panel.".concat(e.translationKeyPanel,".login.totp_code")),inputType:"text",defaultValue:"",confirmText:e.localize("ui.panel.".concat(e.translationKeyPanel,".login.submit")),dismissText:e.localize("ui.panel.".concat(e.translationKeyPanel,".login.cancel"))});case 1:if(null===(l=n.v)||""===l){n.n=2;break}return e._login(t,o,r,l),n.a(2,"continue");case 2:if("alreadyconnectederror"!==i){n.n=4;break}return n.n=3,(0,z.F)((0,h.Z)(e),{details:JSON.parse(a.body.message)});case 3:return(c=n.v)&&e._login(t,o,!1),n.a(2,c?"continue":"cancel");case 4:if("PasswordChangeRequired"!==i){n.n=5;break}return(0,k.showAlertDialog)((0,h.Z)(e),{title:e.localize("ui.panel.".concat(e.translationKeyPanel,".login.alert_password_change_required"))}),n.a(2,"password-change");case 5:if("usernotfound"!==i||t===t.toLowerCase()){n.n=6;break}return e._login(t.toLowerCase(),o,r),n.a(2,void 0);case 6:u=i,n.n="UserNotConfirmed"===u?7:"mfarequired"===u?8:"mfaexpiredornotstarted"===u?9:"invalidtotpcode"===u?10:11;break;case 7:return n.a(2,e.localize("ui.panel.".concat(e.translationKeyPanel,".login.alert_email_confirm_necessary")));case 8:return n.a(2,e.localize("ui.panel.".concat(e.translationKeyPanel,".login.alert_mfa_code_required")));case 9:return n.a(2,e.localize("ui.panel.".concat(e.translationKeyPanel,".login.alert_mfa_expired_or_not_started")));case 10:return n.a(2,e.localize("ui.panel.".concat(e.translationKeyPanel,".login.alert_totp_code_invalid")));case 11:return n.a(2,a&&a.body&&a.body.message?a.body.message:"Unknown error");case 12:return n.a(2)}},n)}));return function(e,a,t,o){return n.apply(this,arguments)}}(),e._login=function(){var n=(0,c.Z)((0,s.Z)().m(function n(a,t,o,r){var i,l,c;return(0,s.Z)().w(function(n){for(;;)switch(n.n){case 0:if(t||r){n.n=1;break}throw new Error("Password or code required");case 1:if(n.p=1,!e.hass){n.n=5;break}return n.n=2,(0,b._Y)(Object.assign(Object.assign({hass:e.hass,email:a},r?{code:r}:{password:t}),{},{check_connection:o}));case 2:if(!(i=n.v).cloud_pipeline){n.n=4;break}return n.n=3,(0,k.showConfirmationDialog)((0,h.Z)(e),{title:e.hass.localize("ui.panel.config.cloud.login.cloud_pipeline_title"),text:e.hass.localize("ui.panel.config.cloud.login.cloud_pipeline_text"),confirmText:e.hass.localize("ui.common.yes"),dismissText:e.hass.localize("ui.common.no")});case 3:if(!n.v){n.n=4;break}(0,P.GV)(e.hass,i.cloud_pipeline);case 4:n.n=6;break;case 5:return n.n=6,(0,Z.ao)(Object.assign({email:a},r?{code:r}:{password:t}));case 6:e.email="",(0,y.B)((0,h.Z)(e),"ha-refresh-cloud-status"),n.n=11;break;case 7:return n.p=7,c=n.v,n.n=8,e._handleCloudLoginError(c,a,t,o);case 8:if("cancel"!==(l=n.v)){n.n=9;break}return e._inProgress=!1,e.email="",e._passwordField.value="",n.a(2);case 9:if("password-change"!==l){n.n=10;break}return e._handleForgotPassword(),n.a(2);case 10:"continue"!==l&&(e._inProgress=!1,e._error=l);case 11:return n.a(2)}},n,null,[[1,7]])}));return function(e,a,t,o){return n.apply(this,arguments)}}(),e}return(0,g.Z)(n,e),(0,d.Z)(n,[{key:"render",value:function(){return this.cardLess?this._renderLoginForm():(0,_.dy)(t||(t=(0,l.Z)([' <ha-card outlined .header="','"> '," </ha-card> "])),this.localize("ui.panel.".concat(this.translationKeyPanel,".login.sign_in")),this._renderLoginForm())}},{key:"_renderLoginForm",value:function(){var e;return(0,_.dy)(o||(o=(0,l.Z)([' <div class="card-content login-form"> ',' <ha-textfield .label="','" id="email" name="username" type="email" autocomplete="username" required .value="','" @keydown="','" .disabled="','" .validationMessage="','"></ha-textfield> <ha-password-field id="password" name="password" .label="','" autocomplete="current-password" required minlength="8" @keydown="','" .disabled="','" .validationMessage="','"></ha-password-field> </div> <div class="card-actions"> <ha-button .disabled="','" @click="','"> ',' </ha-button> <ha-progress-button unelevated @click="','" .progress="','">',"</ha-progress-button> </div> "])),this._error?(0,_.dy)(r||(r=(0,l.Z)(['<ha-alert alert-type="error">',"</ha-alert>"])),this._error):_.Ld,this.localize("ui.panel.".concat(this.translationKeyPanel,".login.email")),null!==(e=this.email)&&void 0!==e?e:"",this._keyDown,this._inProgress,this.localize("ui.panel.".concat(this.translationKeyPanel,".login.email_error_msg")),this.localize("ui.panel.".concat(this.translationKeyPanel,".login.password")),this._keyDown,this._inProgress,this.localize("ui.panel.".concat(this.translationKeyPanel,".login.password_error_msg")),this._inProgress,this._handleForgotPassword,this.localize("ui.panel.".concat(this.translationKeyPanel,".login.forgot_password")),this._handleLogin,this._inProgress,this.localize("ui.panel.".concat(this.translationKeyPanel,".login.sign_in")))}},{key:"_keyDown",value:function(e){"Enter"===e.key&&this._handleLogin()}},{key:"_handleLogin",value:(a=(0,c.Z)((0,s.Z)().m(function e(){return(0,s.Z)().w(function(e){for(;;)switch(e.n){case 0:if(this._inProgress){e.n=3;break}if(this.emailField.reportValidity()){e.n=1;break}return this.emailField.focus(),e.a(2);case 1:if(this._passwordField.reportValidity()){e.n=2;break}return this._passwordField.focus(),e.a(2);case 2:this._inProgress=!0,this._login(this.emailField.value,this._passwordField.value,this.checkConnection);case 3:return e.a(2)}},e,this)})),function(){return a.apply(this,arguments)})},{key:"_handleForgotPassword",value:function(){(0,y.B)(this,"cloud-forgot-password")}}],[{key:"styles",get:function(){return[w.Qx,(0,_.iv)(i||(i=(0,l.Z)(["ha-card{overflow:hidden}ha-card .card-header{margin-bottom:-8px}.card-actions{display:flex;justify-content:space-between;align-items:center}.login-form{display:flex;flex-direction:column}"])))]}}]);var a}(_.oi);(0,f.__decorate)([(0,v.Cb)({attribute:!1})],C.prototype,"hass",void 0),(0,f.__decorate)([(0,v.Cb)({type:Boolean,attribute:"check-connection"})],C.prototype,"checkConnection",void 0),(0,f.__decorate)([(0,v.Cb)()],C.prototype,"email",void 0),(0,f.__decorate)([(0,v.Cb)({attribute:!1})],C.prototype,"localize",void 0),(0,f.__decorate)([(0,v.Cb)({attribute:"translation-key-panel"})],C.prototype,"translationKeyPanel",void 0),(0,f.__decorate)([(0,v.Cb)({type:Boolean,attribute:"card-less"})],C.prototype,"cardLess",void 0),(0,f.__decorate)([(0,v.IO)("#email",!0)],C.prototype,"emailField",void 0),(0,f.__decorate)([(0,v.IO)("#password",!0)],C.prototype,"_passwordField",void 0),(0,f.__decorate)([(0,v.SB)()],C.prototype,"_error",void 0),(0,f.__decorate)([(0,v.SB)()],C.prototype,"_inProgress",void 0),C=(0,f.__decorate)([(0,v.Mo)("cloud-login")],C),n()}catch(K){n(K)}})}}]);
//# sourceMappingURL=41449.0c1c4d86978072ea.js.map
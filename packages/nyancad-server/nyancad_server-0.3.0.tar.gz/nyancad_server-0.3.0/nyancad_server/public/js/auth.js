import { $APP, shadow$provide, $jscomp } from "./common.js";
var uI=function(a,b){return fetch(a,$APP.zl(new $APP.l(null,4,[rI,"POST",sI,new $APP.l(null,1,["Content-Type","application/json"],null),tI,"include",$APP.Tu,$APP.m(b)?JSON.stringify($APP.zl(b)):null],null)))},BI=function(){var a=$APP.u(vI),b=$APP.u(wI),c=$APP.Rm(1);$APP.wm(function(){var d=function(){function f(g){var h=g[1];if(h===7){h=g[2];var n=h instanceof $APP.nj;g[7]=h;g[8]=n;g[1]=$APP.m(n)?8:9;return $APP.Z}if(h===20)return g[1]=$APP.m(g[2])?21:22,$APP.Z;if(h===27)return g[1]=$APP.m(g[2])?
28:29,$APP.Z;if(h===1)return g[2]=null,g[1]=2,$APP.Z;if(h===24)return h=g[2],n=h instanceof $APP.nj,g[9]=h,g[10]=n,g[1]=$APP.m(n)?25:26,$APP.Z;if(h===4){g[4]=$APP.Uc(g[4]);h=g[2];n=$APP.tf(xI,!1);var p=g[5];if($APP.m(p))throw p;g[11]=n;g[2]=h;g[1]=3;return $APP.Z}if(h===15)return h=g[12],h=h.json(),h=$APP.Tm(h),$APP.Om(g,24,h);if(h===21)throw h=g[13],h;if(h===13)return h=g[2],n=h.ok,g[12]=h,g[1]=$APP.m(n)?14:15,$APP.Z;if(h===22)return h=g[13],g[2]=h,g[1]=23,$APP.Z;if(h===29)return h=g[9],g[2]=h,g[1]=
30,$APP.Z;if(h===6){g[4]=$APP.Uc(g[4]);h=g[2];g[5]=h;if(h instanceof Error)g[1]=5,g[5]=null;else throw h;return $APP.Z}if(h===28)throw h=g[9],h;if(h===25)return h=g[9],h=$APP.lj.g($APP.oj(h)),h=$APP.I.h(h,$APP.mj),g[2]=h,g[1]=27,$APP.Z;if(h===17)return h=g[2],n=h instanceof $APP.nj,g[13]=h,g[14]=n,g[1]=$APP.m(n)?18:19,$APP.Z;if(h===3)return $APP.Pm(g,g[2]);if(h===12)return h=g[7],g[2]=h,g[1]=13,$APP.Z;if(h===2)return g[4]=$APP.De(4,g[4]),g[4]=$APP.De(6,g[4]),h=$APP.tf(xI,!0),n=$APP.tf(yI,null),p=
$APP.oh([zI,AI],[a,b]),p=uI("/auth/login",p),p=$APP.Tm(p),g[15]=h,g[16]=n,$APP.Om(g,7,p);if(h===23)return n=g[2],h=console.log("Login successful:",n),p=localStorage.setItem("username",n.name),n=window.location.replace("/"),g[17]=h,g[18]=p,g[2]=n,g[1]=16,$APP.Z;if(h===19)return h=g[14],g[2]=h,g[1]=20,$APP.Z;if(h===11)throw h=g[7],h;return h===9?(h=g[8],g[2]=h,g[1]=10,$APP.Z):h===5?(n=console.error("Login error:",g[2]),h=$APP.tf(yI,"Network error. Please try again."),g[19]=n,g[2]=h,g[1]=4,$APP.Z):h===
14?(h=g[12],h=h.json(),h=$APP.Tm(h),$APP.Om(g,17,h)):h===26?(h=g[10],g[2]=h,g[1]=27,$APP.Z):h===16?(h=g[2],g[4]=$APP.Uc(g[4]),g[2]=h,g[1]=4,$APP.Z):h===30?(h=$APP.tf(yI,g[2].error),g[2]=h,g[1]=16,$APP.Z):h===10?(g[1]=$APP.m(g[2])?11:12,$APP.Z):h===18?(h=g[13],h=$APP.lj.g($APP.oj(h)),h=$APP.I.h(h,$APP.mj),g[2]=h,g[1]=20,$APP.Z):h===8?(h=g[7],h=$APP.lj.g($APP.oj(h)),h=$APP.I.h(h,$APP.mj),g[2]=h,g[1]=10,$APP.Z):null}return function(){function g(p){for(;;){a:{try{for(;;){var q=f(p);if(!$APP.Q(q,$APP.Z)){var t=
q;break a}}}catch(w){t=w;p[2]=t;if($APP.D(p[4]))p[1]=$APP.E(p[4]);else throw t;t=$APP.Z;break a}t=void 0}if(!$APP.Q(t,$APP.Z))return t}}function h(){var p=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];p[0]=n;p[1]=1;return p}var n=null;n=function(p){switch(arguments.length){case 0:return h.call(this);case 1:return g.call(this,p)}throw Error("Invalid arity: "+arguments.length);};n.m=h;n.g=g;return n}()}(),e=function(){var f=d();f[6]=c;return f}();
return $APP.Nm(e)});return c},CI=function(){var a=$APP.u(vI),b=$APP.u(wI),c=$APP.Rm(1);$APP.wm(function(){var d=function(){function f(g){var h=g[1];if(h===7){h=g[2];var n=h instanceof $APP.nj;g[7]=h;g[8]=n;g[1]=$APP.m(n)?8:9;return $APP.Z}if(h===20)return g[1]=$APP.m(g[2])?21:22,$APP.Z;if(h===27)return g[1]=$APP.m(g[2])?28:29,$APP.Z;if(h===1)return g[2]=null,g[1]=2,$APP.Z;if(h===24)return h=g[2],n=h instanceof $APP.nj,g[9]=h,g[10]=n,g[1]=$APP.m(n)?25:26,$APP.Z;if(h===4){g[4]=$APP.Uc(g[4]);h=g[2];
n=$APP.tf(xI,!1);var p=g[5];if($APP.m(p))throw p;g[11]=n;g[2]=h;g[1]=3;return $APP.Z}if(h===15)return h=g[12],h=h.json(),h=$APP.Tm(h),$APP.Om(g,24,h);if(h===21)throw h=g[13],h;if(h===13)return h=g[2],n=h.ok,g[12]=h,g[1]=$APP.m(n)?14:15,$APP.Z;if(h===22)return h=g[13],g[2]=h,g[1]=23,$APP.Z;if(h===29)return h=g[9],g[2]=h,g[1]=30,$APP.Z;if(h===6){g[4]=$APP.Uc(g[4]);h=g[2];g[5]=h;if(h instanceof Error)g[1]=5,g[5]=null;else throw h;return $APP.Z}if(h===28)throw h=g[9],h;if(h===25)return h=g[9],h=$APP.lj.g($APP.oj(h)),
h=$APP.I.h(h,$APP.mj),g[2]=h,g[1]=27,$APP.Z;if(h===17)return h=g[2],n=h instanceof $APP.nj,g[13]=h,g[14]=n,g[1]=$APP.m(n)?18:19,$APP.Z;if(h===3)return $APP.Pm(g,g[2]);if(h===12)return h=g[7],g[2]=h,g[1]=13,$APP.Z;if(h===2)return g[4]=$APP.De(4,g[4]),g[4]=$APP.De(6,g[4]),h=$APP.tf(xI,!0),n=$APP.tf(yI,null),p=$APP.oh([zI,AI],[a,b]),p=uI("/auth/register",p),p=$APP.Tm(p),g[15]=h,g[16]=n,$APP.Om(g,7,p);if(h===23)return n=g[2],h=console.log("Registration successful:",n),p=localStorage.setItem("username",
n.name),n=window.location.replace("/"),g[17]=h,g[18]=p,g[2]=n,g[1]=16,$APP.Z;if(h===19)return h=g[14],g[2]=h,g[1]=20,$APP.Z;if(h===11)throw h=g[7],h;return h===9?(h=g[8],g[2]=h,g[1]=10,$APP.Z):h===5?(n=console.error("Registration error:",g[2]),h=$APP.tf(yI,"Network error. Please try again."),g[19]=n,g[2]=h,g[1]=4,$APP.Z):h===14?(h=g[12],h=h.json(),h=$APP.Tm(h),$APP.Om(g,17,h)):h===26?(h=g[10],g[2]=h,g[1]=27,$APP.Z):h===16?(h=g[2],g[4]=$APP.Uc(g[4]),g[2]=h,g[1]=4,$APP.Z):h===30?(h=$APP.tf(yI,g[2].error),
g[2]=h,g[1]=16,$APP.Z):h===10?(g[1]=$APP.m(g[2])?11:12,$APP.Z):h===18?(h=g[13],h=$APP.lj.g($APP.oj(h)),h=$APP.I.h(h,$APP.mj),g[2]=h,g[1]=20,$APP.Z):h===8?(h=g[7],h=$APP.lj.g($APP.oj(h)),h=$APP.I.h(h,$APP.mj),g[2]=h,g[1]=10,$APP.Z):null}return function(){function g(p){for(;;){a:{try{for(;;){var q=f(p);if(!$APP.Q(q,$APP.Z)){var t=q;break a}}}catch(w){t=w;p[2]=t;if($APP.D(p[4]))p[1]=$APP.E(p[4]);else throw t;t=$APP.Z;break a}t=void 0}if(!$APP.Q(t,$APP.Z))return t}}function h(){var p=[null,null,null,
null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];p[0]=n;p[1]=1;return p}var n=null;n=function(p){switch(arguments.length){case 0:return h.call(this);case 1:return g.call(this,p)}throw Error("Invalid arity: "+arguments.length);};n.m=h;n.g=g;return n}()}(),e=function(){var f=d();f[6]=c;return f}();return $APP.Nm(e)});return c},DI=function(){var a=$APP.Rm(1);$APP.wm(function(){var b=function(){function d(e){var f=e[1];if(f===7)return f=e[7],f=$APP.lj.g($APP.oj(f)),
f=$APP.I.h(f,$APP.mj),e[2]=f,e[1]=9,$APP.Z;if(f===1)return e[2]=null,e[1]=2,$APP.Z;if(f===4)return f=console.error("Logout error:",e[2]),e[2]=f,e[1]=3,$APP.Z;if(f===6){f=e[2];var g=f instanceof $APP.nj;e[7]=f;e[8]=g;e[1]=$APP.m(g)?7:8;return $APP.Z}if(f===3)return $APP.Pm(e,e[2]);if(f===12){g=e[2];var h=localStorage.removeItem("username");f=window.location.reload();e[4]=$APP.Uc(e[4]);e[9]=g;e[10]=h;e[2]=f;e[1]=3;return $APP.Z}if(f===2)return e[4]=$APP.De(5,e[4]),f=uI("/auth/logout",$APP.Mg),f=$APP.Tm(f),
$APP.Om(e,6,f);if(f===11)return f=e[7],e[2]=f,e[1]=12,$APP.Z;if(f===9)return e[1]=$APP.m(e[2])?10:11,$APP.Z;if(f===5){e[4]=$APP.Uc(e[4]);f=e[2];e[5]=f;if(f instanceof Error)e[1]=4,e[5]=null;else throw f;return $APP.Z}if(f===10)throw f=e[7],f;return f===8?(f=e[8],e[2]=f,e[1]=9,$APP.Z):null}return function(){function e(h){for(;;){a:{try{for(;;){var n=d(h);if(!$APP.Q(n,$APP.Z)){var p=n;break a}}}catch(q){p=q;h[2]=p;if($APP.D(h[4]))h[1]=$APP.E(h[4]);else throw p;p=$APP.Z;break a}p=void 0}if(!$APP.Q(p,
$APP.Z))return p}}function f(){var h=[null,null,null,null,null,null,null,null,null,null,null];h[0]=g;h[1]=1;return h}var g=null;g=function(h){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,h)}throw Error("Invalid arity: "+arguments.length);};g.m=f;g.g=e;return g}()}(),c=function(){var d=b();d[6]=a;return d}();return $APP.Nm(c)});return a},FI=function(a,b,c,d){return new $APP.T(null,3,5,$APP.V,[EI,new $APP.T(null,2,5,$APP.V,[$APP.Vw,a],null),new $APP.T(null,2,5,$APP.V,
[$APP.rx,new $APP.l(null,4,[$APP.uz,b,$APP.uw,$APP.u(c),$APP.bz,d,$APP.hw,function(e){return $APP.tf(c,e.target.value)}],null)],null)],null)},RI=function(){return new $APP.T(null,2,5,$APP.V,[GI,new $APP.T(null,5,5,$APP.V,[HI,new $APP.T(null,2,5,$APP.V,[$APP.Ox,$APP.I.h($APP.u(II),JI)?"Login":"Register"],null),$APP.m($APP.u(yI))?new $APP.T(null,2,5,$APP.V,[KI,$APP.u(yI)],null):null,new $APP.T(null,7,5,$APP.V,[$APP.gy,new $APP.l(null,1,[$APP.Uy,function(a){a.preventDefault();a=$APP.Hd($APP.u(vI))?"Username is required":
$APP.Hd($APP.u(wI))?"Password is required":$APP.I.h($APP.u(II),LI)&&$APP.bf($APP.u(wI),$APP.u(MI))?"Passwords do not match":$APP.I.h($APP.u(II),LI)&&$APP.H($APP.u(wI))<6?"Password must be at least 6 characters":null;return $APP.m(a)?$APP.tf(yI,a):$APP.I.h($APP.u(II),JI)?BI():CI()}],null),new $APP.T(null,5,5,$APP.V,[FI,"Username","text",vI,"Enter your username"],null),new $APP.T(null,5,5,$APP.V,[FI,"Password","password",wI,"Enter your password"],null),$APP.I.h($APP.u(II),LI)?new $APP.T(null,5,5,$APP.V,
[FI,"Confirm Password","password",MI,"Confirm your password"],null):null,new $APP.T(null,3,5,$APP.V,[NI,new $APP.l(null,2,[$APP.uz,"submit",$APP.cx,$APP.u(xI)],null),$APP.m($APP.u(xI))?"Please wait...":$APP.I.h($APP.u(II),JI)?"Login":"Register"],null),new $APP.T(null,2,5,$APP.V,[OI,$APP.I.h($APP.u(II),JI)?new $APP.T(null,3,5,$APP.V,[$APP.Ay,"Don't have an account? ",new $APP.T(null,3,5,$APP.V,[$APP.Ly,new $APP.l(null,2,[$APP.xz,"#",$APP.iy,function(a){a.preventDefault();$APP.tf(II,LI);return $APP.tf(yI,
null)}],null),"Register here"],null)],null):new $APP.T(null,3,5,$APP.V,[$APP.Ay,"Already have an account? ",new $APP.T(null,3,5,$APP.V,[$APP.Ly,new $APP.l(null,2,[$APP.xz,"#",$APP.iy,function(a){a.preventDefault();$APP.tf(II,JI);return $APP.tf(yI,null)}],null),"Login here"],null)],null)],null)],null),new $APP.T(null,3,5,$APP.V,[PI,new $APP.T(null,2,5,$APP.V,[$APP.Ay,"Or continue without an account:"],null),new $APP.T(null,3,5,$APP.V,[QI,new $APP.l(null,1,[$APP.xz,"/"],null),"Work Locally"],null)],
null)],null)],null)},ZI=function(){return new $APP.T(null,2,5,$APP.V,[SI,new $APP.T(null,4,5,$APP.V,[TI,new $APP.T(null,2,5,$APP.V,[$APP.Ox,"Account"],null),new $APP.T(null,3,5,$APP.V,[UI,new $APP.T(null,3,5,$APP.V,[$APP.Ay,"Logged in as: ",new $APP.T(null,2,5,$APP.V,[VI,localStorage.getItem("username")],null)],null),new $APP.T(null,3,5,$APP.V,[$APP.Ay,"Sync URL: ",new $APP.T(null,2,5,$APP.V,[WI,$APP.Mu()],null)],null)],null),new $APP.T(null,3,5,$APP.V,[XI,new $APP.T(null,3,5,$APP.V,[QI,new $APP.l(null,
1,[$APP.xz,"/"],null),"Back to Editor"],null),new $APP.T(null,3,5,$APP.V,[YI,new $APP.l(null,1,[$APP.iy,DI],null),"Logout"],null)],null)],null)],null)},$I=function(){return localStorage.getItem("username")!=null?new $APP.T(null,1,5,$APP.V,[ZI],null):new $APP.T(null,1,5,$APP.V,[RI],null)},aJ=function(){window.name="auth";return $APP.Zl(new $APP.T(null,1,5,$APP.V,[$I],null),document.getElementById("mosaic_auth"))},rI=new $APP.P(null,"method","method",55703592),NI=new $APP.P(null,"button.primary","button.primary",
-486456892),YI=new $APP.P(null,"button.danger","button.danger",567836529),EI=new $APP.P(null,"div.form-group","div.form-group",-1721134770),SI=new $APP.P(null,"div.account-container","div.account-container",2057554452),JI=new $APP.P(null,"login","login",55217519),TI=new $APP.P(null,"div.account-card","div.account-card",1175069527),QI=new $APP.P(null,"a.button.secondary","a.button.secondary",-1863018976),zI=new $APP.P(null,"username","username",1605666410),sI=new $APP.P(null,"headers","headers",-835030129),
VI=new $APP.P(null,"strong","strong",269529E3),GI=new $APP.P(null,"div.auth-container","div.auth-container",-319032841),KI=new $APP.P(null,"div.error-message","div.error-message",926006572),tI=new $APP.P(null,"credentials","credentials",1373178854),PI=new $APP.P(null,"div.local-option","div.local-option",811824439),HI=new $APP.P(null,"div.auth-card","div.auth-card",-1909068711),AI=new $APP.P(null,"password","password",417022471),XI=new $APP.P(null,"div.account-actions","div.account-actions",-1458280921),
WI=new $APP.P(null,"code","code",1586293142),OI=new $APP.P(null,"div.auth-toggle","div.auth-toggle",-1951668853),LI=new $APP.P(null,"register","register",1968522516),UI=new $APP.P(null,"div.user-info","div.user-info",-1795367347);var II=$APP.Tl(JI),vI=$APP.Tl(""),wI=$APP.Tl(""),MI=$APP.Tl(""),xI=$APP.Tl(!1),yI=$APP.Tl(null);$APP.la("nyancad.mosaic.auth.init",aJ);aJ();
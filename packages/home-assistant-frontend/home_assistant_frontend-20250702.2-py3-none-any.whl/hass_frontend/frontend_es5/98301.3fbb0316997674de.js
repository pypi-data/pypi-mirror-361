"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["98301"],{10388:function(t,e,n){n.a(t,async function(t,i){try{n.d(e,{c:function(){return v},computeStateDisplay:function(){return _}});n(39710),n(87799),n(56389);var r=n(16230),o=n(38763),a=n(93836),s=n(40142),c=n(74266),u=n(45691),l=n(28598),h=n(27417),d=n(44272),f=t([a,l,s,u,c]);[a,l,s,u,c]=f.then?(await f)():f;const _=(t,e,n,i,r,o,a)=>{const s=null==o?void 0:o[e.entity_id];return v(t,n,i,r,s,e.entity_id,e.attributes,void 0!==a?a:e.state)},v=(t,e,n,i,f,_,v,p)=>{if(p===r.lz||p===r.nZ)return t(`state.default.${p}`);const y=(0,d.M)(_),m="counter"===y||"number"===y||"input_number"===y;if((0,l.sJ)(v,"sensor"===y?n:[])||m){if("duration"===v.device_class&&v.unit_of_measurement&&a.a_.includes(v.unit_of_measurement))try{return(0,a.LU)(e,p,v.unit_of_measurement,null==f?void 0:f.display_precision)}catch(b){}if("monetary"===v.device_class)try{return(0,l.uf)(p,e,Object.assign({style:"currency",currency:v.unit_of_measurement,minimumFractionDigits:2},(0,l.l4)({state:p,attributes:v},f)))}catch(b){}const n=(0,l.uf)(p,e,(0,l.l4)({state:p,attributes:v},f)),i=(null==f?void 0:f.translation_key)&&t(`component.${f.platform}.entity.${y}.${f.translation_key}.unit_of_measurement`)||v.unit_of_measurement;return i?`${n}${(0,h.L)(i,e)}${i}`:n}if(["date","input_datetime","time"].includes(y))try{const t=p.split(" ");if(2===t.length)return(0,c.o0)(new Date(t.join("T")),Object.assign(Object.assign({},e),{},{time_zone:o.c_.local}),i);if(1===t.length){if(p.includes("-"))return(0,s.p6)(new Date(`${p}T00:00`),Object.assign(Object.assign({},e),{},{time_zone:o.c_.local}),i);if(p.includes(":")){const t=new Date;return(0,u.mr)(new Date(`${t.toISOString().split("T")[0]}T${p}`),Object.assign(Object.assign({},e),{},{time_zone:o.c_.local}),i)}}return p}catch(g){return p}if(["button","conversation","event","image","input_button","notify","scene","stt","tag","tts","wake_word","datetime"].includes(y)||"sensor"===y&&"timestamp"===v.device_class)try{return(0,c.o0)(new Date(p),e,i)}catch(b){return p}return(null==f?void 0:f.translation_key)&&t(`component.${f.platform}.entity.${y}.${f.translation_key}.state.${p}`)||v.device_class&&t(`component.${y}.entity_component.${v.device_class}.state.${p}`)||t(`component.${y}.entity_component._.state.${p}`)||p};i()}catch(_){i(_)}})},9224:function(t,e,n){n.d(e,{H:function(){return i}});var i=5},13814:function(t,e,n){n.d(e,{g:function(){return c}});var i=n(42385),r=(n(25518),n(24819),n(2394),n(44438),n(81738),n(94814),n(22960),n(6989),n(93190),n(96821),n(99233),n(54480),n(15519),n(56303),n(67398),n(9224)),o=function(t){return t.reduce(function(t,e){return t+parseFloat(e.state)},0)/t.length},a=function(t){return parseFloat(t[t.length-1].state)||0},s=function(t,e,n,s,c){t.forEach(function(t){t.state=Number(t.state)}),t=t.filter(function(t){return!Number.isNaN(t.state)});var u=void 0!==(null==c?void 0:c.min)?c.min:Math.min.apply(Math,(0,i.Z)(t.map(function(t){return t.state}))),l=void 0!==(null==c?void 0:c.max)?c.max:Math.max.apply(Math,(0,i.Z)(t.map(function(t){return t.state}))),h=(new Date).getTime(),d=function(t,n,i){var r=h-new Date(n.last_changed).getTime(),o=Math.abs(r/36e5-e);return i?(o=60*(o-Math.floor(o)),o=Number((10*Math.round(o/10)).toString()[0])):o=Math.floor(o),t[o]||(t[o]=[]),t[o].push(n),t};if(t=t.reduce(function(t,e){return d(t,e,!1)},[]),s>1&&(t=t.map(function(t){return t.reduce(function(t,e){return d(t,e,!0)},[])})),t.length)return function(t,e,n,i,s,c){var u=[],l=(c-s)/80;l=0!==l?l:80;var h=n/(e-(1===i?1:0));h=isFinite(h)?h:n;var d=t.filter(Boolean)[0];i>1&&(d=d.filter(Boolean)[0]);for(var f=[o(d),a(d)],_=function(t){return 80+r.H/2-(t-s)/l},v=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(i>1&&t)return t.forEach(function(t,n){return v(t,e,n,i-1)});var r=h*(e+n/6);t&&(f=[o(t),a(t)]);var s=_(t?f[0]:f[1]);return u.push([r,s])},p=0;p<t.length;p+=1)v(t[p],p,0,i);return u.push([n,_(f[1])]),u}(t,e,n,s,u,l)},c=function(t,e,n,i,r){if(t){var o=t.map(function(t){return{state:Number(t.s),last_changed:1e3*t.lu}});return s(o,e,n,i,r)}}},88809:function(t,e,n){var i,r,o,a,s=n(54982),c=n(54521),u=n(4490),l=n(20129),h=n(85297),d=n(73742),f=n(59048),_=n(7616),v=n(9224),p=n(75706),y=(n(12212),n(25518),n(81738),n(94814),n(54480),function(t,e,n,i){return[(t-n)/2+n,(e-i)/2+i]}),m=function(t){function e(){return(0,c.Z)(this,e),(0,l.Z)(this,e,arguments)}return(0,h.Z)(e,t),(0,u.Z)(e,[{key:"render",value:function(){return(0,f.dy)(i||(i=(0,s.Z)([" "," "])),this._path?(0,f.YP)(r||(r=(0,s.Z)(['<svg width="100%" height="100%" viewBox="0 0 500 100"> <g> <mask id="fill"> <path class="fill" fill="white" d="',' L 500, 100 L 0, 100 z"/> </mask> <rect height="100%" width="100%" id="fill-rect" fill="var(--accent-color)" mask="url(#fill)"></rect> <mask id="line"> <path fill="none" stroke="var(--accent-color)" stroke-width="','" stroke-linecap="round" stroke-linejoin="round" d="','"></path> </mask> <rect height="100%" width="100%" id="rect" fill="var(--accent-color)" mask="url(#line)"></rect> </g> </svg>'])),this._path,v.H,this._path):(0,f.YP)(o||(o=(0,s.Z)(['<svg width="100%" height="100%" viewBox="0 0 500 100"></svg>']))))}},{key:"willUpdate",value:function(t){this.coordinates&&t.has("coordinates")&&(this._path=function(t){if(!t.length)return"";var e,n,i="",r=t.filter(Boolean)[0];i+="M ".concat(r[0],",").concat(r[1]);var o,a=(0,p.Z)(t);try{for(a.s();!(o=a.n()).done;)e=o.value,n=y(r[0],r[1],e[0],e[1]),i+=" ".concat(n[0],",").concat(n[1]),i+=" Q".concat(e[0],",").concat(e[1]),r=e}catch(s){a.e(s)}finally{a.f()}return i+" ".concat(e[0],",").concat(e[1])}(this.coordinates))}}])}(f.oi);m.styles=(0,f.iv)(a||(a=(0,s.Z)([":host{display:flex;width:100%}.fill{opacity:.1}"]))),(0,d.__decorate)([(0,_.Cb)()],m.prototype,"coordinates",void 0),(0,d.__decorate)([(0,_.SB)()],m.prototype,"_path",void 0),m=(0,d.__decorate)([(0,_.Mo)("hui-graph-base")],m)},8833:function(t,e,n){n.a(t,async function(t,i){try{n.r(e),n.d(e,{HuiGraphHeaderFooter:function(){return H}});var r,o,a,s,c,u=n(29694),l=n(75778),h=n(42385),d=n(54982),f=n(54521),_=n(4490),v=n(20129),p=n(53389),y=n(85297),m=(n(40777),n(39710),n(26847),n(96821),n(87799),n(54480),n(1455),n(48694),n(27530),n(73742)),b=n(59048),g=n(7616),w=n(37528),k=n(44272),Z=n(6514),$=n(89166),C=n(45063),M=n(13814),j=(n(88809),t([Z,$]));[Z,$]=j.then?(await j)():j;var x=["counter","input_number","number","sensor"],H=function(t){function e(){return(0,f.Z)(this,e),(0,v.Z)(this,e,arguments)}return(0,y.Z)(e,t),(0,_.Z)(e,[{key:"getCardSize",value:function(){return 3}},{key:"setConfig",value:function(t){if(null==t||!t.entity||!x.includes((0,k.M)(t.entity)))throw new Error("Specify an entity from within the sensor domain");var e=Object.assign({detail:1,hours_to_show:24},t);e.hours_to_show=Number(e.hours_to_show),e.detail=1===e.detail||2===e.detail?e.detail:1,this._config=e}},{key:"render",value:function(){return this._config&&this.hass?this._error?(0,b.dy)(r||(r=(0,d.Z)(['<div class="errors">',"</div>"])),this._error):this._coordinates?this._coordinates.length?(0,b.dy)(s||(s=(0,d.Z)([' <hui-graph-base .coordinates="','"></hui-graph-base> '])),this._coordinates):(0,b.dy)(a||(a=(0,d.Z)([' <div class="container"> <div class="info">No state history found.</div> </div> ']))):(0,b.dy)(o||(o=(0,d.Z)([' <div class="container"> <ha-spinner size="small"></ha-spinner> </div> ']))):b.Ld}},{key:"connectedCallback",value:function(){(0,p.Z)(e,"connectedCallback",this,3)([]),this.hasUpdated&&this._config&&this._subscribeHistory()}},{key:"disconnectedCallback",value:function(){(0,p.Z)(e,"disconnectedCallback",this,3)([]),this._unsubscribeHistory()}},{key:"_subscribeHistory",value:function(){var t=this;(0,w.p)(this.hass,"history")&&!this._subscribed&&this._config&&(this._subscribed=(0,$.xS)(this.hass,function(e){t._subscribed&&t._config&&(t._coordinates=(0,M.g)(e[t._config.entity],t._config.hours_to_show,500,t._config.detail,t._config.limits)||[])},this._config.hours_to_show,[this._config.entity]).catch(function(e){t._subscribed=void 0,t._error=e}),this._setRedrawTimer())}},{key:"_redrawGraph",value:function(){this._coordinates&&(this._coordinates=(0,h.Z)(this._coordinates))}},{key:"_setRedrawTimer",value:function(){var t=this;clearInterval(this._interval),this._interval=window.setInterval(function(){return t._redrawGraph()},this._config.hours_to_show>24?36e5:6e4)}},{key:"_unsubscribeHistory",value:function(){clearInterval(this._interval),this._subscribed&&(this._subscribed.then(function(t){return null==t?void 0:t()}),this._subscribed=void 0)}},{key:"updated",value:function(t){if(this._config&&this.hass&&t.has("_config")){var e=t.get("_config");e&&this._subscribed&&e.entity===this._config.entity||(this._unsubscribeHistory(),this._subscribeHistory())}}}],[{key:"getConfigElement",value:(i=(0,l.Z)((0,u.Z)().m(function t(){return(0,u.Z)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Promise.all([n.e("73614"),n.e("15601"),n.e("15634"),n.e("26452"),n.e("16376"),n.e("2769"),n.e("19596"),n.e("88930")]).then(n.bind(n,65697));case 1:return t.a(2,document.createElement("hui-graph-footer-editor"))}},t)})),function(){return i.apply(this,arguments)})},{key:"getStubConfig",value:function(t,e,n){return{type:"graph",entity:(0,C.j)(t,1,e,n,x,function(t){return!isNaN(Number(t.state))&&!!t.attributes.unit_of_measurement})[0]||""}}}]);var i}(b.oi);H.styles=(0,b.iv)(c||(c=(0,d.Z)(["ha-spinner{position:absolute;top:calc(50% - 14px)}.container{display:flex;justify-content:center;position:relative;padding-bottom:20%}.info{position:absolute;top:calc(50% - 16px);color:var(--secondary-text-color)}"]))),(0,m.__decorate)([(0,g.Cb)({attribute:!1})],H.prototype,"hass",void 0),(0,m.__decorate)([(0,g.Cb)()],H.prototype,"type",void 0),(0,m.__decorate)([(0,g.SB)()],H.prototype,"_config",void 0),(0,m.__decorate)([(0,g.SB)()],H.prototype,"_coordinates",void 0),H=(0,m.__decorate)([(0,g.Mo)("hui-graph-header-footer")],H),i()}catch(N){i(N)}})}}]);
//# sourceMappingURL=98301.3fbb0316997674de.js.map